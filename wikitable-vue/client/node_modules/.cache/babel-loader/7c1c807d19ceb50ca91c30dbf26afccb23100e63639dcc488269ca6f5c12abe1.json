{"ast":null,"code":"import { ref, computed, onMounted, watch } from \"vue\";\nimport * as d3 from \"d3\";\nimport debounce from \"lodash/debounce\";\nconst remainderColor = \"#f0f0f0\";\nexport default {\n  __name: 'PieChart',\n  props: {\n    data: {\n      type: Array,\n      default: () => [],\n      validator: value => value.every(item => \"name\" in item && \"value\" in item)\n    },\n    showRemainder: {\n      type: Boolean,\n      default: true\n    }\n  },\n  emits: [\"itemClick\"],\n  setup(__props, _ref) {\n    let {\n      expose: __expose,\n      emit: __emit\n    } = _ref;\n    __expose();\n    const props = __props;\n    const emit = __emit;\n    const chartContainer = ref(null);\n    const colors = [\"#3498db\", \"#e74c3c\", \"#2ecc71\", \"#f39c12\", \"#9b59b6\"];\n    const filteredData = computed(() => {\n      return props.data.filter(item => {\n        const name = String(item.name || \"\");\n        const value = String(item.value || \"\");\n        return !isYearEntry(name) && !isYearEntry(value);\n      });\n    });\n    const isYearEntry = value => {\n      if (typeof value !== \"string\") return false;\n      const trimmedValue = value.trim();\n      return /^(\\()?\\d{4}(\\))?\\s*:?/.test(trimmedValue) || /^\\(?FY\\s*\\d{4}\\)?\\s*:?/i.test(trimmedValue) || /^(\\()?\\d{4}\\s*[-–]\\s*\\d{2,4}(\\))?\\s*:?/.test(trimmedValue) || /^(Year|Yr|Annual)\\s*\\d{4}/i.test(trimmedValue);\n    };\n    const hasValidData = computed(() => filteredData.value.length > 0);\n    const processedData = computed(() => {\n      if (!hasValidData.value) return [];\n      if (filteredData.value.length === 1 && props.showRemainder) {\n        const mainValue = Math.min(100, Math.max(0, Number(filteredData.value[0].value) || 0));\n        return [{\n          ...filteredData.value[0],\n          value: mainValue,\n          isMain: true,\n          index: 0\n        }, {\n          name: \"剩余\",\n          value: Math.max(0, 100 - mainValue),\n          isRemainder: true,\n          index: 1\n        }];\n      }\n      return filteredData.value.map((item, index) => ({\n        ...item,\n        value: Math.min(100, Math.max(0, Number(item.value) || 0)),\n        index\n      }));\n    });\n    let svg, arc, pie, tooltip;\n    const initChart = () => {\n      if (!chartContainer.value || !hasValidData.value) return;\n      d3.select(chartContainer.value).selectAll(\"*\").remove();\n      const container = d3.select(chartContainer.value);\n      const width = chartContainer.value.clientWidth;\n      const height = chartContainer.value.clientHeight;\n      const radius = Math.min(width, height) / 2 * 0.7;\n      const legendWidth = 120;\n      svg = container.append(\"svg\").attr(\"width\", \"100%\").attr(\"height\", \"100%\").attr(\"viewBox\", `0 0 ${width} ${height}`);\n      const pieGroup = svg.append(\"g\").attr(\"transform\", `translate(${width / 2 - legendWidth / 2},${height / 2})`);\n      const legendGroup = svg.append(\"g\").attr(\"class\", \"legend\").attr(\"transform\", `translate(${width - legendWidth - 10}, 20)`);\n      pie = d3.pie().value(d => d.value).sort(null);\n      arc = d3.arc().innerRadius(0).outerRadius(radius).cornerRadius(4);\n      tooltip = container.append(\"div\").attr(\"class\", \"chart-tooltip\").style(\"opacity\", 0);\n      drawChart(pieGroup, legendGroup);\n    };\n    const drawChart = (pieGroup, legendGroup) => {\n      const arcs = pieGroup.selectAll(\".arc\").data(pie(processedData.value)).enter().append(\"g\").attr(\"class\", \"arc\");\n      arcs.append(\"path\").attr(\"fill\", d => d.data.isRemainder ? remainderColor : colors[d.data.index % colors.length]).style(\"opacity\", d => d.data.isRemainder ? 0.6 : 0.85).style(\"stroke\", \"#fff\").style(\"stroke-width\", 1).transition().duration(800).attrTween(\"d\", function (d) {\n        const i = d3.interpolate(d.startAngle, d.endAngle);\n        return function (t) {\n          d.endAngle = i(t);\n          return arc(d);\n        };\n      });\n      arcs.selectAll(\"path\").on(\"mouseover\", function (event, d) {\n        if (d.data.isRemainder) return;\n        d3.select(this).transition().duration(200).style(\"opacity\", 1);\n        tooltip.transition().duration(200).style(\"opacity\", 1);\n        tooltip.html(`<div class=\"tooltip-title\">${d.data.name}</div>\n           <div>数值: ${d.data.value.toFixed(1)}%</div>`).style(\"left\", event.pageX + 10 + \"px\").style(\"top\", event.pageY - 28 + \"px\");\n      }).on(\"mouseout\", function () {\n        d3.select(this).transition().duration(200).style(\"opacity\", 0.85);\n        tooltip.transition().duration(200).style(\"opacity\", 0);\n      }).on(\"click\", (event, d) => {\n        if (!d.data.isRemainder) emit(\"itemClick\", d.data);\n      });\n      if (filteredData.value.length === 1) {\n        pieGroup.append(\"text\").attr(\"text-anchor\", \"middle\").attr(\"dy\", \".35em\").text(`${filteredData.value[0].value.toFixed(1)}%`).style(\"font-size\", \"18px\").style(\"font-weight\", \"bold\").style(\"fill\", \"#333\");\n      }\n      const legendItems = legendGroup.selectAll(\".legend-item\").data(processedData.value.filter(d => !d.isRemainder)).enter().append(\"g\").attr(\"class\", \"legend-item\").attr(\"transform\", (d, i) => `translate(0, ${i * 40})`).style(\"cursor\", \"pointer\").on(\"click\", (event, d) => emit(\"itemClick\", d));\n      legendItems.append(\"rect\").attr(\"width\", 12).attr(\"height\", 12).attr(\"rx\", 2).attr(\"ry\", 2).attr(\"fill\", (d, i) => colors[i % colors.length]).style(\"opacity\", 0.8);\n      legendItems.append(\"text\").attr(\"x\", 18).attr(\"dy\", \"0.9em\").text(d => d.name).style(\"font-size\", \"13px\").style(\"fill\", \"#333\");\n      legendItems.append(\"text\").attr(\"x\", 18).attr(\"dy\", \"2.2em\").text(d => `${d.value}%`).style(\"font-size\", \"12px\").style(\"fill\", \"#888\");\n    };\n    onMounted(() => {\n      initChart();\n      window.addEventListener(\"resize\", debouncedInit);\n    });\n    const debouncedInit = debounce(initChart, 300);\n    watch(() => [props.data, props.showRemainder], debouncedInit, {\n      deep: true\n    });\n    const __returned__ = {\n      props,\n      emit,\n      chartContainer,\n      colors,\n      remainderColor,\n      filteredData,\n      isYearEntry,\n      hasValidData,\n      processedData,\n      get svg() {\n        return svg;\n      },\n      set svg(v) {\n        svg = v;\n      },\n      get arc() {\n        return arc;\n      },\n      set arc(v) {\n        arc = v;\n      },\n      get pie() {\n        return pie;\n      },\n      set pie(v) {\n        pie = v;\n      },\n      get tooltip() {\n        return tooltip;\n      },\n      set tooltip(v) {\n        tooltip = v;\n      },\n      initChart,\n      drawChart,\n      debouncedInit,\n      ref,\n      computed,\n      onMounted,\n      watch,\n      get d3() {\n        return d3;\n      },\n      get debounce() {\n        return debounce;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","watch","d3","debounce","remainderColor","props","__props","emit","__emit","chartContainer","colors","filteredData","data","filter","item","name","String","value","isYearEntry","trimmedValue","trim","test","hasValidData","length","processedData","showRemainder","mainValue","Math","min","max","Number","isMain","index","isRemainder","map","svg","arc","pie","tooltip","initChart","select","selectAll","remove","container","width","clientWidth","height","clientHeight","radius","legendWidth","append","attr","pieGroup","legendGroup","d","sort","innerRadius","outerRadius","cornerRadius","style","drawChart","arcs","enter","transition","duration","attrTween","i","interpolate","startAngle","endAngle","t","on","event","html","toFixed","pageX","pageY","text","legendItems","window","addEventListener","debouncedInit","deep"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/compoents_base/charts/PieChart.vue"],"sourcesContent":["<template>\r\n\t<div ref=\"chartContainer\" class=\"pie-chart-container\">\r\n\t\t<div v-if=\"!hasValidData\" class=\"no-data\">-</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, computed, onMounted, watch } from \"vue\";\r\n\timport * as d3 from \"d3\";\r\n\timport debounce from \"lodash/debounce\";\r\n\r\n\tconst props = defineProps({\r\n\t\tdata: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => [],\r\n\t\t\tvalidator: value => value.every(item => \"name\" in item && \"value\" in item)\r\n\t\t},\r\n\t\tshowRemainder: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t}\r\n\t});\r\n\r\n\tconst emit = defineEmits([\"itemClick\"]);\r\n\r\n\tconst chartContainer = ref(null);\r\n\tconst colors = [\"#3498db\", \"#e74c3c\", \"#2ecc71\", \"#f39c12\", \"#9b59b6\"];\r\n\tconst remainderColor = \"#f0f0f0\";\r\n\r\n\tconst filteredData = computed(() => {\r\n\t\treturn props.data.filter(item => {\r\n\t\t\tconst name = String(item.name || \"\");\r\n\t\t\tconst value = String(item.value || \"\");\r\n\t\t\treturn !isYearEntry(name) && !isYearEntry(value);\r\n\t\t});\r\n\t});\r\n\r\n\tconst isYearEntry = value => {\r\n\t\tif (typeof value !== \"string\") return false;\r\n\t\tconst trimmedValue = value.trim();\r\n\t\treturn (\r\n\t\t\t/^(\\()?\\d{4}(\\))?\\s*:?/.test(trimmedValue) ||\r\n\t\t\t/^\\(?FY\\s*\\d{4}\\)?\\s*:?/i.test(trimmedValue) ||\r\n\t\t\t/^(\\()?\\d{4}\\s*[-–]\\s*\\d{2,4}(\\))?\\s*:?/.test(trimmedValue) ||\r\n\t\t\t/^(Year|Yr|Annual)\\s*\\d{4}/i.test(trimmedValue)\r\n\t\t);\r\n\t};\r\n\r\n\tconst hasValidData = computed(() => filteredData.value.length > 0);\r\n\r\n\tconst processedData = computed(() => {\r\n\t\tif (!hasValidData.value) return [];\r\n\t\tif (filteredData.value.length === 1 && props.showRemainder) {\r\n\t\t\tconst mainValue = Math.min(\r\n\t\t\t\t100,\r\n\t\t\t\tMath.max(0, Number(filteredData.value[0].value) || 0)\r\n\t\t\t);\r\n\t\t\treturn [\r\n\t\t\t\t{ ...filteredData.value[0], value: mainValue, isMain: true, index: 0 },\r\n\t\t\t\t{\r\n\t\t\t\t\tname: \"剩余\",\r\n\t\t\t\t\tvalue: Math.max(0, 100 - mainValue),\r\n\t\t\t\t\tisRemainder: true,\r\n\t\t\t\t\tindex: 1\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\t\treturn filteredData.value.map((item, index) => ({\r\n\t\t\t...item,\r\n\t\t\tvalue: Math.min(100, Math.max(0, Number(item.value) || 0)),\r\n\t\t\tindex\r\n\t\t}));\r\n\t});\r\n\r\n\tlet svg, arc, pie, tooltip;\r\n\r\n\tconst initChart = () => {\r\n\t\tif (!chartContainer.value || !hasValidData.value) return;\r\n\r\n\t\td3.select(chartContainer.value).selectAll(\"*\").remove();\r\n\r\n\t\tconst container = d3.select(chartContainer.value);\r\n\t\tconst width = chartContainer.value.clientWidth;\r\n\t\tconst height = chartContainer.value.clientHeight;\r\n\t\tconst radius = (Math.min(width, height) / 2) * 0.7;\r\n\t\tconst legendWidth = 120;\r\n\r\n\t\tsvg = container\r\n\t\t\t.append(\"svg\")\r\n\t\t\t.attr(\"width\", \"100%\")\r\n\t\t\t.attr(\"height\", \"100%\")\r\n\t\t\t.attr(\"viewBox\", `0 0 ${width} ${height}`);\r\n\r\n\t\tconst pieGroup = svg\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\r\n\t\t\t\t\"transform\",\r\n\t\t\t\t`translate(${width / 2 - legendWidth / 2},${height / 2})`\r\n\t\t\t);\r\n\r\n\t\tconst legendGroup = svg\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\"class\", \"legend\")\r\n\t\t\t.attr(\"transform\", `translate(${width - legendWidth - 10}, 20)`);\r\n\r\n\t\tpie = d3\r\n\t\t\t.pie()\r\n\t\t\t.value(d => d.value)\r\n\t\t\t.sort(null);\r\n\t\tarc = d3.arc().innerRadius(0).outerRadius(radius).cornerRadius(4);\r\n\r\n\t\ttooltip = container\r\n\t\t\t.append(\"div\")\r\n\t\t\t.attr(\"class\", \"chart-tooltip\")\r\n\t\t\t.style(\"opacity\", 0);\r\n\r\n\t\tdrawChart(pieGroup, legendGroup);\r\n\t};\r\n\r\n\tconst drawChart = (pieGroup, legendGroup) => {\r\n\t\tconst arcs = pieGroup\r\n\t\t\t.selectAll(\".arc\")\r\n\t\t\t.data(pie(processedData.value))\r\n\t\t\t.enter()\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\"class\", \"arc\");\r\n\r\n\t\tarcs\r\n\t\t\t.append(\"path\")\r\n\t\t\t.attr(\"fill\", d =>\r\n\t\t\t\td.data.isRemainder\r\n\t\t\t\t\t? remainderColor\r\n\t\t\t\t\t: colors[d.data.index % colors.length]\r\n\t\t\t)\r\n\t\t\t.style(\"opacity\", d => (d.data.isRemainder ? 0.6 : 0.85))\r\n\t\t\t.style(\"stroke\", \"#fff\")\r\n\t\t\t.style(\"stroke-width\", 1)\r\n\t\t\t.transition()\r\n\t\t\t.duration(800)\r\n\t\t\t.attrTween(\"d\", function (d) {\r\n\t\t\t\tconst i = d3.interpolate(d.startAngle, d.endAngle);\r\n\t\t\t\treturn function (t) {\r\n\t\t\t\t\td.endAngle = i(t);\r\n\t\t\t\t\treturn arc(d);\r\n\t\t\t\t};\r\n\t\t\t});\r\n\r\n\t\tarcs\r\n\t\t\t.selectAll(\"path\")\r\n\t\t\t.on(\"mouseover\", function (event, d) {\r\n\t\t\t\tif (d.data.isRemainder) return;\r\n\t\t\t\td3.select(this).transition().duration(200).style(\"opacity\", 1);\r\n\t\t\t\ttooltip.transition().duration(200).style(\"opacity\", 1);\r\n\t\t\t\ttooltip\r\n\t\t\t\t\t.html(\r\n\t\t\t\t\t\t`<div class=\"tooltip-title\">${d.data.name}</div>\r\n           <div>数值: ${d.data.value.toFixed(1)}%</div>`\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.style(\"left\", event.pageX + 10 + \"px\")\r\n\t\t\t\t\t.style(\"top\", event.pageY - 28 + \"px\");\r\n\t\t\t})\r\n\t\t\t.on(\"mouseout\", function () {\r\n\t\t\t\td3.select(this).transition().duration(200).style(\"opacity\", 0.85);\r\n\t\t\t\ttooltip.transition().duration(200).style(\"opacity\", 0);\r\n\t\t\t})\r\n\t\t\t.on(\"click\", (event, d) => {\r\n\t\t\t\tif (!d.data.isRemainder) emit(\"itemClick\", d.data);\r\n\t\t\t});\r\n\r\n\t\tif (filteredData.value.length === 1) {\r\n\t\t\tpieGroup\r\n\t\t\t\t.append(\"text\")\r\n\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t.attr(\"dy\", \".35em\")\r\n\t\t\t\t.text(`${filteredData.value[0].value.toFixed(1)}%`)\r\n\t\t\t\t.style(\"font-size\", \"18px\")\r\n\t\t\t\t.style(\"font-weight\", \"bold\")\r\n\t\t\t\t.style(\"fill\", \"#333\");\r\n\t\t}\r\n\r\n\t\tconst legendItems = legendGroup\r\n\t\t\t.selectAll(\".legend-item\")\r\n\t\t\t.data(processedData.value.filter(d => !d.isRemainder))\r\n\t\t\t.enter()\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\"class\", \"legend-item\")\r\n\t\t\t.attr(\"transform\", (d, i) => `translate(0, ${i * 40})`)\r\n\t\t\t.style(\"cursor\", \"pointer\")\r\n\t\t\t.on(\"click\", (event, d) => emit(\"itemClick\", d));\r\n\r\n\t\tlegendItems\r\n\t\t\t.append(\"rect\")\r\n\t\t\t.attr(\"width\", 12)\r\n\t\t\t.attr(\"height\", 12)\r\n\t\t\t.attr(\"rx\", 2)\r\n\t\t\t.attr(\"ry\", 2)\r\n\t\t\t.attr(\"fill\", (d, i) => colors[i % colors.length])\r\n\t\t\t.style(\"opacity\", 0.8);\r\n\r\n\t\tlegendItems\r\n\t\t\t.append(\"text\")\r\n\t\t\t.attr(\"x\", 18)\r\n\t\t\t.attr(\"dy\", \"0.9em\")\r\n\t\t\t.text(d => d.name)\r\n\t\t\t.style(\"font-size\", \"13px\")\r\n\t\t\t.style(\"fill\", \"#333\");\r\n\r\n\t\tlegendItems\r\n\t\t\t.append(\"text\")\r\n\t\t\t.attr(\"x\", 18)\r\n\t\t\t.attr(\"dy\", \"2.2em\")\r\n\t\t\t.text(d => `${d.value}%`)\r\n\t\t\t.style(\"font-size\", \"12px\")\r\n\t\t\t.style(\"fill\", \"#888\");\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tinitChart();\r\n\t\twindow.addEventListener(\"resize\", debouncedInit);\r\n\t});\r\n\r\n\tconst debouncedInit = debounce(initChart, 300);\r\n\r\n\twatch(() => [props.data, props.showRemainder], debouncedInit, { deep: true });\r\n</script>\r\n\r\n<style scoped>\r\n\t.pie-chart-container {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-height: 150px;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.no-data {\r\n\t\tposition: absolute;\r\n\t\ttop: 50%;\r\n\t\tleft: 50%;\r\n\t\ttransform: translate(-50%, -50%);\r\n\t\tcolor: #999;\r\n\t\tfont-size: 16px;\r\n\t}\r\n\r\n\t.chart-tooltip {\r\n\t\tposition: absolute;\r\n\t\tpadding: 10px 12px;\r\n\t\tbackground: rgba(0, 0, 0, 0.85);\r\n\t\tcolor: #fff;\r\n\t\tborder-radius: 6px;\r\n\t\tfont-size: 13px;\r\n\t\tpointer-events: none;\r\n\t\tz-index: 10;\r\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\r\n\t\ttransition: opacity 0.2s, transform 0.2s;\r\n\t\tbackdrop-filter: blur(4px);\r\n\t}\r\n\r\n\t.tooltip-title {\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 4px;\r\n\t}\r\n\r\n\t:deep(.legend-item text) {\r\n\t\tfont-family: Arial, sans-serif;\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}