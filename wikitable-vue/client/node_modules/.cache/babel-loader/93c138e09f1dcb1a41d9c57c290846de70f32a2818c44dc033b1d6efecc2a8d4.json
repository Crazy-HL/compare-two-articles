{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  id: \"app\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"h1\", null, \"网页内容高亮工具\", -1 /* HOISTED */);\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"urlInput\"\n}, \"输入网页网址：\", -1 /* HOISTED */);\nconst _hoisted_4 = [\"innerHTML\"];\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"提取的文本：\", -1 /* HOISTED */);\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", null, [_hoisted_3, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.url = $event),\n    placeholder: \"例如：http://example.com\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.url]]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = function () {\n      return $options.loadPage && $options.loadPage(...arguments);\n    })\n  }, \"加载页面\")]), _createElementVNode(\"div\", {\n    id: \"pageContent\",\n    innerHTML: $data.content,\n    onMouseup: _cache[2] || (_cache[2] = function () {\n      return $options.handleSelection && $options.handleSelection(...arguments);\n    })\n  }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_4), _createElementVNode(\"div\", null, [_createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = function () {\n      return $options.saveHighlights && $options.saveHighlights(...arguments);\n    })\n  }, \"保存高亮\"), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = function () {\n      return $options.loadHighlights && $options.loadHighlights(...arguments);\n    })\n  }, \"加载高亮\")]), _createElementVNode(\"div\", null, [_hoisted_5, _createElementVNode(\"pre\", null, _toDisplayString($data.extractedText), 1 /* TEXT */)])]);\n}","map":{"version":3,"names":["id","_createElementVNode","for","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_cache","$event","$data","url","placeholder","onClick","$options","loadPage","arguments","innerHTML","content","onMouseup","handleSelection","_hoisted_4","saveHighlights","loadHighlights","_hoisted_5","_toDisplayString","extractedText"],"sources":["D:\\vue_frame\\vue_frame\\wikitable-vue\\client\\src\\components\\test.vue"],"sourcesContent":["<template>\r\n\t<div id=\"app\">\r\n\t\t<h1>网页内容高亮工具</h1>\r\n\r\n\t\t<div>\r\n\t\t\t<label for=\"urlInput\">输入网页网址：</label>\r\n\t\t\t<input v-model=\"url\" placeholder=\"例如：http://example.com\" />\r\n\t\t\t<button @click=\"loadPage\">加载页面</button>\r\n\t\t</div>\r\n\r\n\t\t<div id=\"pageContent\" v-html=\"content\" @mouseup=\"handleSelection\"></div>\r\n\r\n\t\t<div>\r\n\t\t\t<button @click=\"saveHighlights\">保存高亮</button>\r\n\t\t\t<button @click=\"loadHighlights\">加载高亮</button>\r\n\t\t</div>\r\n\r\n\t\t<div>\r\n\t\t\t<h2>提取的文本：</h2>\r\n\t\t\t<pre>{{ extractedText }}</pre>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport axios from \"axios\";\r\n\r\n\texport default {\r\n\t\tname: \"App\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\turl: \"\",\r\n\t\t\t\tcontent: \"\",\r\n\t\t\t\thighlights: [],\r\n\t\t\t\textractedText: \"\"\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 加载网页内容\r\n\t\t\tasync loadPage() {\r\n\t\t\t\tif (!this.url) {\r\n\t\t\t\t\talert(\"请输入网址\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await axios.get(\r\n\t\t\t\t\t\t`http://localhost:5000/fetch?url=${encodeURIComponent(this.url)}`\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.content = response.data.content;\r\n\r\n\t\t\t\t\t// 等待 Vue 渲染完成后再添加事件监听\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tconst pageContent = document.getElementById(\"pageContent\");\r\n\t\t\t\t\t\tpageContent.addEventListener(\"mouseup\", this.handleSelection);\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error(\"加载内容失败:\", error);\r\n\t\t\t\t\talert(\"加载内容失败\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 处理文本选中事件\r\n\t\t\thandleSelection() {\r\n\t\t\t\tconst selection = window.getSelection();\r\n\t\t\t\tconst selectedText = selection.toString().trim();\r\n\r\n\t\t\t\tif (selectedText) {\r\n\t\t\t\t\t// 高亮选中的文本\r\n\t\t\t\t\tconst range = selection.getRangeAt(0);\r\n\t\t\t\t\tthis.highlightText(range);\r\n\r\n\t\t\t\t\t// 提取选中的文本\r\n\t\t\t\t\tthis.extractedText = selectedText;\r\n\r\n\t\t\t\t\t// 序列化选区信息\r\n\t\t\t\t\tconst serializedRange = this.serializeRange(range);\r\n\t\t\t\t\tthis.highlights.push(serializedRange);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 高亮选中的文本\r\n\t\t\thighlightText(range) {\r\n\t\t\t\tconst span = document.createElement(\"span\");\r\n\t\t\t\tspan.className = \"highlight\";\r\n\t\t\t\trange.surroundContents(span);\r\n\t\t\t},\r\n\r\n\t\t\t// 序列化选区信息\r\n\t\t\tserializeRange(range) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tstartContainer: range.startContainer.parentElement.outerHTML,\r\n\t\t\t\t\tstartOffset: range.startOffset,\r\n\t\t\t\t\tendContainer: range.endContainer.parentElement.outerHTML,\r\n\t\t\t\t\tendOffset: range.endOffset,\r\n\t\t\t\t\ttext: range.toString()\r\n\t\t\t\t};\r\n\t\t\t},\r\n\r\n\t\t\t// 反序列化选区信息\r\n\t\t\tdeserializeRange(serialized) {\r\n\t\t\t\tconst pageContent = document.getElementById(\"pageContent\");\r\n\t\t\t\tconst walker = document.createTreeWalker(\r\n\t\t\t\t\tpageContent,\r\n\t\t\t\t\tNodeFilter.SHOW_TEXT\r\n\t\t\t\t);\r\n\r\n\t\t\t\tlet startNode, endNode;\r\n\t\t\t\twhile (walker.nextNode()) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\twalker.currentNode.parentElement.outerHTML ===\r\n\t\t\t\t\t\tserialized.startContainer\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tstartNode = walker.currentNode;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\twalker.currentNode.parentElement.outerHTML ===\r\n\t\t\t\t\t\tserialized.endContainer\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tendNode = walker.currentNode;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (startNode && endNode) {\r\n\t\t\t\t\tconst range = document.createRange();\r\n\t\t\t\t\trange.setStart(startNode, serialized.startOffset);\r\n\t\t\t\t\trange.setEnd(endNode, serialized.endOffset);\r\n\t\t\t\t\treturn range;\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t},\r\n\r\n\t\t\t// 保存高亮信息\r\n\t\t\tsaveHighlights() {\r\n\t\t\t\tlocalStorage.setItem(\"highlights\", JSON.stringify(this.highlights));\r\n\t\t\t\talert(\"高亮已保存！\");\r\n\t\t\t},\r\n\r\n\t\t\t// 加载高亮信息\r\n\t\t\tloadHighlights() {\r\n\t\t\t\tconst savedHighlights = JSON.parse(\r\n\t\t\t\t\tlocalStorage.getItem(\"highlights\") || \"[]\"\r\n\t\t\t\t);\r\n\t\t\t\tsavedHighlights.forEach(serialized => {\r\n\t\t\t\t\tconst range = this.deserializeRange(serialized);\r\n\t\t\t\t\tif (range) {\r\n\t\t\t\t\t\tthis.highlightText(range);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\talert(\"高亮已加载！\");\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style>\r\n\t#app {\r\n\t\ttext-align: center;\r\n\t\tmargin-top: 20px;\r\n\t}\r\n\r\n\tinput {\r\n\t\tpadding: 10px;\r\n\t\tfont-size: 16px;\r\n\t\tmargin-right: 10px;\r\n\t}\r\n\r\n\tbutton {\r\n\t\tpadding: 10px;\r\n\t\tfont-size: 16px;\r\n\t\tbackground-color: #4caf50;\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\tbutton:hover {\r\n\t\tbackground-color: #45a049;\r\n\t}\r\n\r\n\t.highlight {\r\n\t\tbackground-color: #ff9;\r\n\t}\r\n</style>\r\n"],"mappings":";;EACMA,EAAE,EAAC;AAAK;gCACZC,mBAAA,CAAiB,YAAb,UAAQ;gCAGXA,mBAAA,CAAqC;EAA9BC,GAAG,EAAC;AAAU,GAAC,SAAO;mBALhC;gCAkBGD,mBAAA,CAAe,YAAX,QAAM;;uBAjBZE,mBAAA,CAoBM,OApBNC,UAoBM,GAnBLC,UAAiB,EAEjBJ,mBAAA,CAIM,cAHLK,UAAqC,E,gBACrCL,mBAAA,CAA2D;IAN9D,uBAAAM,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAMmBC,KAAA,CAAAC,GAAG,GAAAF,MAAA;IAAEG,WAAW,EAAC;iDAAjBF,KAAA,CAAAC,GAAG,E,GACnBT,mBAAA,CAAuC;IAA9BW,OAAK,EAAAL,MAAA,QAAAA,MAAA;MAAA,OAAEM,QAAA,CAAAC,QAAA,IAAAD,QAAA,CAAAC,QAAA,IAAAC,SAAA,CAAQ;IAAA;KAAE,MAAI,E,GAG/Bd,mBAAA,CAAwE;IAAnED,EAAE,EAAC,aAAa;IAACgB,SAAgB,EAARP,KAAA,CAAAQ,OAAO;IAAGC,SAAO,EAAAX,MAAA,QAAAA,MAAA;MAAA,OAAEM,QAAA,CAAAM,eAAA,IAAAN,QAAA,CAAAM,eAAA,IAAAJ,SAAA,CAAe;IAAA;2CAVlEK,UAAA,GAYEnB,mBAAA,CAGM,cAFLA,mBAAA,CAA6C;IAApCW,OAAK,EAAAL,MAAA,QAAAA,MAAA;MAAA,OAAEM,QAAA,CAAAQ,cAAA,IAAAR,QAAA,CAAAQ,cAAA,IAAAN,SAAA,CAAc;IAAA;KAAE,MAAI,GACpCd,mBAAA,CAA6C;IAApCW,OAAK,EAAAL,MAAA,QAAAA,MAAA;MAAA,OAAEM,QAAA,CAAAS,cAAA,IAAAT,QAAA,CAAAS,cAAA,IAAAP,SAAA,CAAc;IAAA;KAAE,MAAI,E,GAGrCd,mBAAA,CAGM,cAFLsB,UAAe,EACftB,mBAAA,CAA8B,aAAAuB,gBAAA,CAAtBf,KAAA,CAAAgB,aAAa,iB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}