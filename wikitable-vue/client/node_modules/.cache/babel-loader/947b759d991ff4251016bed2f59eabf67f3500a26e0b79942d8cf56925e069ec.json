{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { computed, ref, onMounted, watch, nextTick } from \"vue\";\nimport * as d3 from \"d3\";\nexport default {\n  props: {\n    field: {\n      type: [Object, Array, String, Number],\n      default: null\n    },\n    type: {\n      type: String,\n      default: \"\"\n    },\n    visualization: {\n      type: String,\n      default: \"\"\n    },\n    fieldKey: {\n      type: String,\n      default: \"\"\n    },\n    range: {\n      type: Object,\n      default: () => ({\n        min: 0,\n        max: 1\n      })\n    }\n  },\n  emits: [\"chartClick\"],\n  setup(props, _ref) {\n    let {\n      emit\n    } = _ref;\n    const hoveredIndex = ref(null);\n    const activeIndex = ref(null);\n    const isTextHovered = ref(false);\n    const pieContainer = ref(null);\n    const barContainer = ref(null);\n    const lineContainer = ref(null);\n    const colors = [\"#3498db\", \"#e74c3c\", \"#2ecc71\", \"#f39c12\", \"#9b59b6\"];\n    const remainderColor = \"#f0f0f0\";\n    onMounted(() => {\n      watch(() => [props.field, props.visualization, props.range], () => {\n        nextTick(() => {\n          if (props.visualization === \"pie-chart\" && hasData.value && isValidPieData.value) {\n            renderPieChart();\n          } else if (props.visualization === \"bar-chart\" && hasData.value) {\n            renderBarChart();\n          } else if (props.visualization === \"line-chart\" && hasData.value) {\n            renderLineChart();\n          }\n        });\n      }, {\n        immediate: true,\n        deep: true\n      });\n    });\n    const renderPieChart = () => {\n      if (!pieContainer.value) return;\n      d3.select(pieContainer.value).selectAll(\"*\").remove();\n      const container = d3.select(pieContainer.value);\n      const containerWidth = pieContainer.value.clientWidth;\n      const containerHeight = pieContainer.value.clientHeight;\n      const size = Math.min(containerWidth, containerHeight);\n      const radius = size / 2;\n      const svg = container.append(\"svg\").attr(\"width\", \"100%\").attr(\"height\", \"100%\").attr(\"viewBox\", `0 0 ${size} ${size}`).append(\"g\").attr(\"transform\", `translate(${radius},${radius})`);\n      const processedData = pieData.value.length === 1 ? [{\n        ...pieData.value[0],\n        color: colors[0],\n        isMainValue: true\n      }, {\n        value: Math.max(0, 100 - pieData.value[0].value),\n        name: \"剩余\",\n        color: remainderColor,\n        isRemainder: true,\n        index: 1\n      }] : pieData.value.map((d, i) => ({\n        ...d,\n        color: colors[i % colors.length],\n        isMainValue: true\n      }));\n      const pie = d3.pie().value(d => d.value).sort(null);\n      const arc = d3.arc().innerRadius(0).outerRadius(radius * 0.9).cornerRadius(2);\n      const arcs = svg.selectAll(\".arc\").data(pie(processedData)).enter().append(\"g\").attr(\"class\", \"arc\");\n      arcs.append(\"path\").attr(\"d\", arc).attr(\"fill\", d => d.data.color).style(\"opacity\", d => d.data.isRemainder ? 0.6 : 0.8).style(\"stroke\", \"#fff\").style(\"stroke-width\", 1).on(\"mouseover\", function (event, d) {\n        if (d.data.isRemainder) return;\n        hoveredIndex.value = d.data.index;\n        d3.select(this).transition().duration(200).style(\"opacity\", 1).attr(\"transform\", \"scale(1.05)\");\n        tooltip.style(\"visibility\", \"visible\").html(`${d.data.name}: ${d.data.value.toFixed(1)}${props.type === \"percentage\" ? \"%\" : \"\"}`);\n      }).on(\"mouseout\", function (event, d) {\n        if (d.data.isRemainder) return;\n        hoveredIndex.value = null;\n        d3.select(this).transition().duration(200).style(\"opacity\", d.data.isRemainder ? 0.6 : 0.8).attr(\"transform\", \"scale(1)\");\n        tooltip.style(\"visibility\", \"hidden\");\n      }).on(\"click\", function (event, d) {\n        if (d.data.isRemainder) return;\n        activeIndex.value = d.data.index;\n        emit(\"chartClick\", {\n          type: \"pie\",\n          index: d.data.index,\n          data: d.data,\n          value: d.data.value\n        });\n      });\n      if (pieData.value.length === 1) {\n        svg.append(\"text\").attr(\"text-anchor\", \"middle\").attr(\"dy\", \".3em\").text(`${pieData.value[0].value.toFixed(1)}${props.type === \"percentage\" ? \"%\" : \"\"}`).style(\"font-size\", \"14px\").style(\"fill\", \"#333\");\n      }\n      const tooltip = container.append(\"div\").attr(\"class\", \"d3-tooltip\").style(\"position\", \"absolute\").style(\"visibility\", \"hidden\").style(\"background\", \"rgba(0,0,0,0.8)\").style(\"color\", \"white\").style(\"padding\", \"6px 12px\").style(\"border-radius\", \"4px\").style(\"font-size\", \"12px\");\n    };\n    const renderBarChart = () => {\n      if (!barContainer.value) return;\n      d3.select(barContainer.value).selectAll(\"*\").remove();\n      const container = d3.select(barContainer.value);\n      const width = barContainer.value.clientWidth;\n      const height = barContainer.value.clientHeight;\n      const margin = {\n        top: 10,\n        right: 10,\n        bottom: 10,\n        left: 10\n      };\n      const svg = container.append(\"svg\").attr(\"width\", \"100%\").attr(\"height\", \"100%\").attr(\"viewBox\", `0 0 ${width} ${height}`);\n\n      // 处理原始数据，保留原始值和转换后的数值\n      const processedData = [];\n      if (Array.isArray(props.field)) {\n        props.field.forEach((item, index) => {\n          let rawValue, numValue;\n          if (typeof item === \"object\") {\n            rawValue = item.raw || item.value || item;\n            numValue = parseFloat(item.value || item.raw || 0);\n          } else {\n            rawValue = item;\n            numValue = parseFloat(item) || 0;\n          }\n\n          // 特殊字段处理\n          if (props.fieldKey === \"GDP\") {\n            numValue = numValue / 1000000000000; // 转换为万亿美元\n          } else if (props.fieldKey === \"Population\") {\n            numValue = numValue / 100000000; // 转换为亿人\n          }\n          processedData.push({\n            raw: rawValue,\n            value: numValue,\n            index: index\n          });\n        });\n      } else {\n        let rawValue, numValue;\n        if (typeof props.field === \"object\") {\n          rawValue = props.field.raw || props.field.value || props.field;\n          numValue = parseFloat(props.field.value || props.field.raw || 0);\n        } else {\n          rawValue = props.field;\n          numValue = parseFloat(props.field) || 0;\n        }\n\n        // 特殊字段处理\n        if (props.fieldKey === \"GDP\") {\n          numValue = numValue / 1000000000000;\n        } else if (props.fieldKey === \"Population\") {\n          numValue = numValue / 100000000;\n        }\n        processedData.push({\n          raw: rawValue,\n          value: numValue,\n          index: 0\n        });\n      }\n\n      // 使用传入的统一范围或自动计算\n      const maxValue = props.range?.max || d3.max(processedData, d => d.value) || 1;\n      const minValue = props.range?.min || 0;\n      const y = d3.scaleLinear().domain([minValue, maxValue]).nice().range([height - margin.bottom, margin.top]);\n      const x = d3.scaleBand().domain(d3.range(processedData.length)).range([margin.left, width - margin.right]).padding(0.2);\n      svg.selectAll(\".bar\").data(processedData).enter().append(\"rect\").attr(\"class\", \"bar\").attr(\"x\", (d, i) => x(i)).attr(\"y\", d => y(d.value)).attr(\"width\", x.bandwidth()).attr(\"height\", d => y(0) - y(d.value)).attr(\"fill\", (d, i) => colors[i % colors.length]).style(\"opacity\", 0.8).on(\"mouseover\", function (event, d) {\n        hoveredIndex.value = d.index;\n        d3.select(this).transition().duration(200).style(\"opacity\", 1).attr(\"y\", d => y(d.value) - 5).attr(\"height\", d => y(0) - y(d.value) + 5);\n\n        // 显示原始值(raw)而不是处理后的数值(value)\n        tooltip.style(\"visibility\", \"visible\").html(`${formatTooltipText(d.raw, props.fieldKey)}`);\n      }).on(\"mouseout\", function () {\n        hoveredIndex.value = null;\n        d3.select(this).transition().duration(200).style(\"opacity\", 0.8).attr(\"y\", d => y(d.value)).attr(\"height\", d => y(0) - y(d.value));\n        tooltip.style(\"visibility\", \"hidden\");\n      }).on(\"click\", function (event, d) {\n        activeIndex.value = d.index;\n        emit(\"chartClick\", {\n          type: \"bar\",\n          index: d.index,\n          data: d,\n          value: d.value\n        });\n      });\n      const tooltip = container.append(\"div\").attr(\"class\", \"d3-tooltip\").style(\"position\", \"absolute\").style(\"visibility\", \"hidden\").style(\"background\", \"rgba(0,0,0,0.8)\").style(\"color\", \"white\").style(\"padding\", \"6px 12px\").style(\"border-radius\", \"4px\").style(\"font-size\", \"12px\");\n    };\n\n    // 新增工具提示文本格式化函数\n    const formatTooltipText = (value, fieldKey) => {\n      if (value === null || value === undefined) return \"-\";\n\n      // 如果是对象，尝试获取raw或value\n      if (typeof value === \"object\") {\n        value = value.raw || value.value || value;\n      }\n\n      // 特殊字段处理\n      if (fieldKey === \"GDP\") {\n        const num = parseFloat(value.toString().replace(/[^0-9.-]/g, \"\")) / 1000000000000;\n        return isNaN(num) ? value : num.toFixed(2) + \"T\";\n      } else if (fieldKey === \"Population\") {\n        const num = parseFloat(value.toString().replace(/[^0-9.-]/g, \"\")) / 100000000;\n        return isNaN(num) ? value : num.toFixed(2) + \"亿\";\n      } else if (props.type === \"percentage\") {\n        const percentMatch = value.toString().match(/(\\d+\\.?\\d*)%/);\n        return percentMatch ? percentMatch[0] : value;\n      }\n      return value;\n    };\n    const renderLineChart = () => {\n      if (!lineContainer.value) return;\n      d3.select(lineContainer.value).selectAll(\"*\").remove();\n      const container = d3.select(lineContainer.value);\n      const width = lineContainer.value.clientWidth;\n      const height = lineContainer.value.clientHeight;\n      const margin = {\n        top: 10,\n        right: 10,\n        bottom: 10,\n        left: 10\n      };\n      const svg = container.append(\"svg\").attr(\"width\", \"100%\").attr(\"height\", \"100%\").attr(\"viewBox\", `0 0 ${width} ${height}`);\n      const x = d3.scaleLinear().domain([0, lineData.value.length - 1]).range([margin.left, width - margin.right]);\n      const y = d3.scaleLinear().domain([d3.min(lineData.value, d => d.y), d3.max(lineData.value, d => d.y)]).nice().range([height - margin.bottom, margin.top]);\n      const line = d3.line().x((d, i) => x(i)).y(d => y(d.y)).curve(d3.curveMonotoneX);\n      svg.append(\"path\").datum(lineData.value).attr(\"fill\", \"none\").attr(\"stroke\", \"#3498db\").attr(\"stroke-width\", 2).attr(\"d\", line);\n      svg.selectAll(\".dot\").data(lineData.value).enter().append(\"circle\").attr(\"class\", \"dot\").attr(\"cx\", (d, i) => x(i)).attr(\"cy\", d => y(d.y)).attr(\"r\", 3).attr(\"fill\", \"#3498db\").on(\"mouseover\", function (event, d) {\n        hoveredIndex.value = d.index;\n        d3.select(this).transition().duration(200).attr(\"r\", 5).attr(\"stroke\", \"white\").attr(\"stroke-width\", 1);\n        tooltip.style(\"visibility\", \"visible\").html(`${d.raw || formatNumber(d.y, props.fieldKey)}`);\n      }).on(\"mouseout\", function () {\n        hoveredIndex.value = null;\n        d3.select(this).transition().duration(200).attr(\"r\", 3).attr(\"stroke\", \"none\");\n        tooltip.style(\"visibility\", \"hidden\");\n      }).on(\"click\", function (event, d) {\n        activeIndex.value = d.index;\n        emit(\"chartClick\", {\n          type: \"line\",\n          index: d.index,\n          data: d,\n          value: d.y\n        });\n      });\n      const tooltip = container.append(\"div\").attr(\"class\", \"d3-tooltip\").style(\"position\", \"absolute\").style(\"visibility\", \"hidden\").style(\"background\", \"rgba(0,0,0,0.8)\").style(\"color\", \"white\").style(\"padding\", \"6px 12px\").style(\"border-radius\", \"4px\").style(\"font-size\", \"12px\");\n    };\n    const handleTextHover = () => {\n      isTextHovered.value = true;\n    };\n    const resetHover = () => {\n      hoveredIndex.value = null;\n      isTextHovered.value = false;\n    };\n    const handleTextClick = () => {\n      emit(\"chartClick\", {\n        type: \"text\",\n        data: props.field,\n        value: props.field\n      });\n    };\n    const formatNumber = (value, fieldKey) => {\n      const num = Number(value);\n      if (isNaN(num)) return \"0\";\n      if (props.type === \"percentage\") {\n        return num.toFixed(1) + \"%\";\n      }\n      if (fieldKey === \"GDP\") {\n        return num.toFixed(2) + \"T\";\n      }\n      if (fieldKey === \"Population\") {\n        return num.toFixed(2) + \"亿\";\n      }\n      return num.toFixed(2);\n    };\n    const formatSimpleText = value => {\n      if (!value) return \"-\";\n      if (Array.isArray(value)) {\n        const items = value.map(item => item.raw || item.value || item);\n        return items.length > 2 ? items.slice(0, 2).join(\"; \") + \"...\" : items.join(\"; \");\n      }\n      if (typeof value === \"object\") {\n        return value.raw || value.value || \"-\";\n      }\n      return value.toString().length > 50 ? value.toString().substring(0, 50) + \"...\" : value.toString();\n    };\n    const isYearEntry = value => {\n      if (typeof value !== \"string\") return false;\n      const trimmedValue = value.trim();\n      return /^(\\()?\\d{4}(\\))?\\s*:?/.test(trimmedValue) || /^\\(?FY\\s*\\d{4}\\)?\\s*:?/i.test(trimmedValue) || /^(\\()?\\d{4}\\s*[-–]\\s*\\d{2,4}(\\))?\\s*:?/.test(trimmedValue) || /^(Year|Yr|Annual)\\s*\\d{4}/i.test(trimmedValue);\n    };\n    const safeToNumber = (value, fieldKey) => {\n      if (value === null || value === undefined) return 0;\n      if (typeof value === \"number\") return value;\n      if (typeof value === \"string\") {\n        const percentMatch = value.match(/(\\d+\\.?\\d*)%/);\n        if (percentMatch) return parseFloat(percentMatch[1]);\n        const numStr = value.toString().replace(/[^0-9.-]/g, \"\");\n        const num = parseFloat(numStr);\n        return isNaN(num) ? 0 : num;\n      }\n      return 0;\n    };\n    const isValidPieData = computed(() => {\n      if (!pieData.value.length) return false;\n      return pieData.value.every(item => !isYearEntry(item.name) && !isYearEntry(item.value));\n    });\n    const pieData = computed(() => {\n      if (!props.field) return [];\n      const processItem = (item, index) => {\n        const rawValue = item?.value || item?.raw || item;\n        if (isYearEntry(rawValue)) return null;\n        const value = safeToNumber(rawValue, props.fieldKey);\n        if (value === null) return null;\n        let name = typeof item === \"object\" ? (item.raw || \"\").replace(/:\\s*\\d+\\.?\\d*%?/g, \"\") : \"项目\";\n        if (isYearEntry(name)) return null;\n        return {\n          value: Math.min(100, Math.max(0, value)),\n          name: name.trim() || \"项目\",\n          index: index\n        };\n      };\n      if (Array.isArray(props.field)) {\n        return props.field.map((item, index) => processItem(item, index)).filter(item => item !== null && !isYearEntry(item.name));\n      }\n      if (typeof props.field === \"object\") {\n        const result = processItem(props.field, 0);\n        return result ? [result] : [];\n      }\n      if (isYearEntry(props.field)) return [];\n      const numValue = safeToNumber(props.field, props.fieldKey);\n      return numValue !== null && !isYearEntry(props.field) ? [{\n        value: Math.min(100, Math.max(0, numValue)),\n        name: \"数值\",\n        index: 0\n      }] : [];\n    });\n    const simpleBarData = computed(() => {\n      if (!props.field) return [];\n      let values = [];\n      if (Array.isArray(props.field)) {\n        values = props.field.filter(item => {\n          const value = item?.value || item?.raw;\n          return value !== undefined && value !== null && !isYearEntry(value);\n        }).map(item => safeToNumber(item.value || item.raw, props.fieldKey));\n      } else if (typeof props.field === \"object\") {\n        values = [safeToNumber(props.field.value || props.field.raw, props.fieldKey)].filter(v => v !== null);\n      } else {\n        values = [safeToNumber(props.field, props.fieldKey)].filter(v => v !== null);\n      }\n      if (values.length === 0) return [];\n      return values.map((v, index) => ({\n        value: v,\n        height: v,\n        color: colors[index % colors.length],\n        index: index\n      }));\n    });\n    const lineData = computed(() => {\n      if (!props.field) return [];\n      if (Array.isArray(props.field)) {\n        return props.field.filter(item => {\n          const value = item?.value || item?.raw;\n          return value !== undefined && value !== null && !isYearEntry(value);\n        }).map((item, index) => {\n          const value = safeToNumber(item.value || item.raw, props.fieldKey);\n          return {\n            x: index,\n            y: value,\n            raw: item.raw || item.value,\n            index: index\n          };\n        });\n      }\n      if (typeof props.field === \"object\") {\n        const value = safeToNumber(props.field.value || props.field.raw, props.fieldKey);\n        return value !== null ? [{\n          x: 0,\n          y: value,\n          raw: props.field.raw || props.field.value,\n          index: 0\n        }] : [];\n      }\n      const value = safeToNumber(props.field, props.fieldKey);\n      return value !== null ? [{\n        x: 0,\n        y: value,\n        raw: props.field,\n        index: 0\n      }] : [];\n    });\n    const hasData = computed(() => {\n      if (!props.field) return false;\n      if (Array.isArray(props.field)) return props.field.length > 0;\n      if (typeof props.field === \"object\") return Object.keys(props.field).length > 0;\n      return String(props.field).trim().length > 0;\n    });\n    return {\n      hoveredIndex,\n      activeIndex,\n      isTextHovered,\n      pieContainer,\n      barContainer,\n      lineContainer,\n      handleTextHover,\n      resetHover,\n      handleTextClick,\n      formatSimpleText,\n      hasData,\n      isValidPieData,\n      pieData,\n      simpleBarData,\n      lineData,\n      formatNumber\n    };\n  }\n};","map":{"version":3,"names":["computed","ref","onMounted","watch","nextTick","d3","props","field","type","Object","Array","String","Number","default","visualization","fieldKey","range","min","max","emits","setup","_ref","emit","hoveredIndex","activeIndex","isTextHovered","pieContainer","barContainer","lineContainer","colors","remainderColor","hasData","value","isValidPieData","renderPieChart","renderBarChart","renderLineChart","immediate","deep","select","selectAll","remove","container","containerWidth","clientWidth","containerHeight","clientHeight","size","Math","radius","svg","append","attr","processedData","pieData","length","color","isMainValue","name","isRemainder","index","map","d","i","pie","sort","arc","innerRadius","outerRadius","cornerRadius","arcs","data","enter","style","on","event","transition","duration","tooltip","html","toFixed","text","width","height","margin","top","right","bottom","left","isArray","forEach","item","rawValue","numValue","raw","parseFloat","push","maxValue","minValue","y","scaleLinear","domain","nice","x","scaleBand","padding","bandwidth","formatTooltipText","undefined","num","toString","replace","isNaN","percentMatch","match","lineData","line","curve","curveMonotoneX","datum","formatNumber","handleTextHover","resetHover","handleTextClick","formatSimpleText","items","slice","join","substring","isYearEntry","trimmedValue","trim","test","safeToNumber","numStr","every","processItem","filter","result","simpleBarData","values","v","keys"],"sources":["D:\\vue_frame\\vue_frame\\wikitable-vue\\client\\src\\components\\compoents_base\\SimpleChart.vue"],"sourcesContent":["<template>\r\n\t<div class=\"simple-chart\">\r\n\t\t<template v-if=\"visualization === 'text-only'\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"simple-text\"\r\n\t\t\t\t@click=\"handleTextClick\"\r\n\t\t\t\t@mouseenter=\"handleTextHover\"\r\n\t\t\t\t@mouseleave=\"resetHover\">\r\n\t\t\t\t{{ formatSimpleText(field) }}\r\n\t\t\t</div>\r\n\t\t\t<div v-if=\"isTextHovered\" class=\"text-tooltip\">点击查看详情</div>\r\n\t\t</template>\r\n\r\n\t\t<template v-else-if=\"visualization === 'pie-chart'\">\r\n\t\t\t<div\r\n\t\t\t\tv-if=\"hasData && isValidPieData\"\r\n\t\t\t\tclass=\"d3-chart-container\"\r\n\t\t\t\tref=\"pieContainer\"></div>\r\n\t\t\t<div v-else class=\"no-data\">-</div>\r\n\t\t</template>\r\n\r\n\t\t<template v-else-if=\"visualization === 'bar-chart'\">\r\n\t\t\t<div v-if=\"hasData\" class=\"d3-chart-container\" ref=\"barContainer\"></div>\r\n\t\t\t<div v-else class=\"no-data\">-</div>\r\n\t\t</template>\r\n\r\n\t\t<template v-else-if=\"visualization === 'line-chart'\">\r\n\t\t\t<div v-if=\"hasData\" class=\"d3-chart-container\" ref=\"lineContainer\"></div>\r\n\t\t\t<div v-else class=\"no-data\">-</div>\r\n\t\t</template>\r\n\r\n\t\t<template v-else>\r\n\t\t\t<div\r\n\t\t\t\tclass=\"simple-text\"\r\n\t\t\t\t@click=\"handleTextClick\"\r\n\t\t\t\t@mouseenter=\"handleTextHover\"\r\n\t\t\t\t@mouseleave=\"resetHover\">\r\n\t\t\t\t{{ formatSimpleText(field) }}\r\n\t\t\t</div>\r\n\t\t\t<div v-if=\"isTextHovered\" class=\"text-tooltip\">点击查看详情</div>\r\n\t\t</template>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport { computed, ref, onMounted, watch, nextTick } from \"vue\";\r\n\timport * as d3 from \"d3\";\r\n\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\tfield: {\r\n\t\t\t\ttype: [Object, Array, String, Number],\r\n\t\t\t\tdefault: null\r\n\t\t\t},\r\n\t\t\ttype: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"\"\r\n\t\t\t},\r\n\t\t\tvisualization: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"\"\r\n\t\t\t},\r\n\t\t\tfieldKey: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"\"\r\n\t\t\t},\r\n\t\t\trange: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: () => ({ min: 0, max: 1 })\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\temits: [\"chartClick\"],\r\n\r\n\t\tsetup(props, { emit }) {\r\n\t\t\tconst hoveredIndex = ref(null);\r\n\t\t\tconst activeIndex = ref(null);\r\n\t\t\tconst isTextHovered = ref(false);\r\n\r\n\t\t\tconst pieContainer = ref(null);\r\n\t\t\tconst barContainer = ref(null);\r\n\t\t\tconst lineContainer = ref(null);\r\n\r\n\t\t\tconst colors = [\"#3498db\", \"#e74c3c\", \"#2ecc71\", \"#f39c12\", \"#9b59b6\"];\r\n\t\t\tconst remainderColor = \"#f0f0f0\";\r\n\r\n\t\t\tonMounted(() => {\r\n\t\t\t\twatch(\r\n\t\t\t\t\t() => [props.field, props.visualization, props.range],\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tnextTick(() => {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tprops.visualization === \"pie-chart\" &&\r\n\t\t\t\t\t\t\t\thasData.value &&\r\n\t\t\t\t\t\t\t\tisValidPieData.value\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\trenderPieChart();\r\n\t\t\t\t\t\t\t} else if (props.visualization === \"bar-chart\" && hasData.value) {\r\n\t\t\t\t\t\t\t\trenderBarChart();\r\n\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\tprops.visualization === \"line-chart\" &&\r\n\t\t\t\t\t\t\t\thasData.value\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\trenderLineChart();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ immediate: true, deep: true }\r\n\t\t\t\t);\r\n\t\t\t});\r\n\r\n\t\t\tconst renderPieChart = () => {\r\n\t\t\t\tif (!pieContainer.value) return;\r\n\r\n\t\t\t\td3.select(pieContainer.value).selectAll(\"*\").remove();\r\n\r\n\t\t\t\tconst container = d3.select(pieContainer.value);\r\n\t\t\t\tconst containerWidth = pieContainer.value.clientWidth;\r\n\t\t\t\tconst containerHeight = pieContainer.value.clientHeight;\r\n\t\t\t\tconst size = Math.min(containerWidth, containerHeight);\r\n\t\t\t\tconst radius = size / 2;\r\n\r\n\t\t\t\tconst svg = container\r\n\t\t\t\t\t.append(\"svg\")\r\n\t\t\t\t\t.attr(\"width\", \"100%\")\r\n\t\t\t\t\t.attr(\"height\", \"100%\")\r\n\t\t\t\t\t.attr(\"viewBox\", `0 0 ${size} ${size}`)\r\n\t\t\t\t\t.append(\"g\")\r\n\t\t\t\t\t.attr(\"transform\", `translate(${radius},${radius})`);\r\n\r\n\t\t\t\tconst processedData =\r\n\t\t\t\t\tpieData.value.length === 1\r\n\t\t\t\t\t\t? [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t...pieData.value[0],\r\n\t\t\t\t\t\t\t\t\tcolor: colors[0],\r\n\t\t\t\t\t\t\t\t\tisMainValue: true\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvalue: Math.max(0, 100 - pieData.value[0].value),\r\n\t\t\t\t\t\t\t\t\tname: \"剩余\",\r\n\t\t\t\t\t\t\t\t\tcolor: remainderColor,\r\n\t\t\t\t\t\t\t\t\tisRemainder: true,\r\n\t\t\t\t\t\t\t\t\tindex: 1\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t  ]\r\n\t\t\t\t\t\t: pieData.value.map((d, i) => ({\r\n\t\t\t\t\t\t\t\t...d,\r\n\t\t\t\t\t\t\t\tcolor: colors[i % colors.length],\r\n\t\t\t\t\t\t\t\tisMainValue: true\r\n\t\t\t\t\t\t  }));\r\n\r\n\t\t\t\tconst pie = d3\r\n\t\t\t\t\t.pie()\r\n\t\t\t\t\t.value(d => d.value)\r\n\t\t\t\t\t.sort(null);\r\n\r\n\t\t\t\tconst arc = d3\r\n\t\t\t\t\t.arc()\r\n\t\t\t\t\t.innerRadius(0)\r\n\t\t\t\t\t.outerRadius(radius * 0.9)\r\n\t\t\t\t\t.cornerRadius(2);\r\n\r\n\t\t\t\tconst arcs = svg\r\n\t\t\t\t\t.selectAll(\".arc\")\r\n\t\t\t\t\t.data(pie(processedData))\r\n\t\t\t\t\t.enter()\r\n\t\t\t\t\t.append(\"g\")\r\n\t\t\t\t\t.attr(\"class\", \"arc\");\r\n\r\n\t\t\t\tarcs\r\n\t\t\t\t\t.append(\"path\")\r\n\t\t\t\t\t.attr(\"d\", arc)\r\n\t\t\t\t\t.attr(\"fill\", d => d.data.color)\r\n\t\t\t\t\t.style(\"opacity\", d => (d.data.isRemainder ? 0.6 : 0.8))\r\n\t\t\t\t\t.style(\"stroke\", \"#fff\")\r\n\t\t\t\t\t.style(\"stroke-width\", 1)\r\n\t\t\t\t\t.on(\"mouseover\", function (event, d) {\r\n\t\t\t\t\t\tif (d.data.isRemainder) return;\r\n\r\n\t\t\t\t\t\thoveredIndex.value = d.data.index;\r\n\t\t\t\t\t\td3.select(this)\r\n\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t.duration(200)\r\n\t\t\t\t\t\t\t.style(\"opacity\", 1)\r\n\t\t\t\t\t\t\t.attr(\"transform\", \"scale(1.05)\");\r\n\r\n\t\t\t\t\t\ttooltip\r\n\t\t\t\t\t\t\t.style(\"visibility\", \"visible\")\r\n\t\t\t\t\t\t\t.html(\r\n\t\t\t\t\t\t\t\t`${d.data.name}: ${d.data.value.toFixed(1)}${\r\n\t\t\t\t\t\t\t\t\tprops.type === \"percentage\" ? \"%\" : \"\"\r\n\t\t\t\t\t\t\t\t}`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on(\"mouseout\", function (event, d) {\r\n\t\t\t\t\t\tif (d.data.isRemainder) return;\r\n\r\n\t\t\t\t\t\thoveredIndex.value = null;\r\n\t\t\t\t\t\td3.select(this)\r\n\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t.duration(200)\r\n\t\t\t\t\t\t\t.style(\"opacity\", d.data.isRemainder ? 0.6 : 0.8)\r\n\t\t\t\t\t\t\t.attr(\"transform\", \"scale(1)\");\r\n\r\n\t\t\t\t\t\ttooltip.style(\"visibility\", \"hidden\");\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on(\"click\", function (event, d) {\r\n\t\t\t\t\t\tif (d.data.isRemainder) return;\r\n\r\n\t\t\t\t\t\tactiveIndex.value = d.data.index;\r\n\t\t\t\t\t\temit(\"chartClick\", {\r\n\t\t\t\t\t\t\ttype: \"pie\",\r\n\t\t\t\t\t\t\tindex: d.data.index,\r\n\t\t\t\t\t\t\tdata: d.data,\r\n\t\t\t\t\t\t\tvalue: d.data.value\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tif (pieData.value.length === 1) {\r\n\t\t\t\t\tsvg\r\n\t\t\t\t\t\t.append(\"text\")\r\n\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t\t\t.attr(\"dy\", \".3em\")\r\n\t\t\t\t\t\t.text(\r\n\t\t\t\t\t\t\t`${pieData.value[0].value.toFixed(1)}${\r\n\t\t\t\t\t\t\t\tprops.type === \"percentage\" ? \"%\" : \"\"\r\n\t\t\t\t\t\t\t}`\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.style(\"font-size\", \"14px\")\r\n\t\t\t\t\t\t.style(\"fill\", \"#333\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst tooltip = container\r\n\t\t\t\t\t.append(\"div\")\r\n\t\t\t\t\t.attr(\"class\", \"d3-tooltip\")\r\n\t\t\t\t\t.style(\"position\", \"absolute\")\r\n\t\t\t\t\t.style(\"visibility\", \"hidden\")\r\n\t\t\t\t\t.style(\"background\", \"rgba(0,0,0,0.8)\")\r\n\t\t\t\t\t.style(\"color\", \"white\")\r\n\t\t\t\t\t.style(\"padding\", \"6px 12px\")\r\n\t\t\t\t\t.style(\"border-radius\", \"4px\")\r\n\t\t\t\t\t.style(\"font-size\", \"12px\");\r\n\t\t\t};\r\n\r\n\t\t\tconst renderBarChart = () => {\r\n\t\t\t\tif (!barContainer.value) return;\r\n\r\n\t\t\t\td3.select(barContainer.value).selectAll(\"*\").remove();\r\n\r\n\t\t\t\tconst container = d3.select(barContainer.value);\r\n\t\t\t\tconst width = barContainer.value.clientWidth;\r\n\t\t\t\tconst height = barContainer.value.clientHeight;\r\n\t\t\t\tconst margin = { top: 10, right: 10, bottom: 10, left: 10 };\r\n\r\n\t\t\t\tconst svg = container\r\n\t\t\t\t\t.append(\"svg\")\r\n\t\t\t\t\t.attr(\"width\", \"100%\")\r\n\t\t\t\t\t.attr(\"height\", \"100%\")\r\n\t\t\t\t\t.attr(\"viewBox\", `0 0 ${width} ${height}`);\r\n\r\n\t\t\t\t// 处理原始数据，保留原始值和转换后的数值\r\n\t\t\t\tconst processedData = [];\r\n\t\t\t\tif (Array.isArray(props.field)) {\r\n\t\t\t\t\tprops.field.forEach((item, index) => {\r\n\t\t\t\t\t\tlet rawValue, numValue;\r\n\r\n\t\t\t\t\t\tif (typeof item === \"object\") {\r\n\t\t\t\t\t\t\trawValue = item.raw || item.value || item;\r\n\t\t\t\t\t\t\tnumValue = parseFloat(item.value || item.raw || 0);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\trawValue = item;\r\n\t\t\t\t\t\t\tnumValue = parseFloat(item) || 0;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 特殊字段处理\r\n\t\t\t\t\t\tif (props.fieldKey === \"GDP\") {\r\n\t\t\t\t\t\t\tnumValue = numValue / 1000000000000; // 转换为万亿美元\r\n\t\t\t\t\t\t} else if (props.fieldKey === \"Population\") {\r\n\t\t\t\t\t\t\tnumValue = numValue / 100000000; // 转换为亿人\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tprocessedData.push({\r\n\t\t\t\t\t\t\traw: rawValue,\r\n\t\t\t\t\t\t\tvalue: numValue,\r\n\t\t\t\t\t\t\tindex: index\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet rawValue, numValue;\r\n\r\n\t\t\t\t\tif (typeof props.field === \"object\") {\r\n\t\t\t\t\t\trawValue = props.field.raw || props.field.value || props.field;\r\n\t\t\t\t\t\tnumValue = parseFloat(props.field.value || props.field.raw || 0);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trawValue = props.field;\r\n\t\t\t\t\t\tnumValue = parseFloat(props.field) || 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 特殊字段处理\r\n\t\t\t\t\tif (props.fieldKey === \"GDP\") {\r\n\t\t\t\t\t\tnumValue = numValue / 1000000000000;\r\n\t\t\t\t\t} else if (props.fieldKey === \"Population\") {\r\n\t\t\t\t\t\tnumValue = numValue / 100000000;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tprocessedData.push({\r\n\t\t\t\t\t\traw: rawValue,\r\n\t\t\t\t\t\tvalue: numValue,\r\n\t\t\t\t\t\tindex: 0\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 使用传入的统一范围或自动计算\r\n\t\t\t\tconst maxValue =\r\n\t\t\t\t\tprops.range?.max || d3.max(processedData, d => d.value) || 1;\r\n\t\t\t\tconst minValue = props.range?.min || 0;\r\n\r\n\t\t\t\tconst y = d3\r\n\t\t\t\t\t.scaleLinear()\r\n\t\t\t\t\t.domain([minValue, maxValue])\r\n\t\t\t\t\t.nice()\r\n\t\t\t\t\t.range([height - margin.bottom, margin.top]);\r\n\r\n\t\t\t\tconst x = d3\r\n\t\t\t\t\t.scaleBand()\r\n\t\t\t\t\t.domain(d3.range(processedData.length))\r\n\t\t\t\t\t.range([margin.left, width - margin.right])\r\n\t\t\t\t\t.padding(0.2);\r\n\r\n\t\t\t\tsvg\r\n\t\t\t\t\t.selectAll(\".bar\")\r\n\t\t\t\t\t.data(processedData)\r\n\t\t\t\t\t.enter()\r\n\t\t\t\t\t.append(\"rect\")\r\n\t\t\t\t\t.attr(\"class\", \"bar\")\r\n\t\t\t\t\t.attr(\"x\", (d, i) => x(i))\r\n\t\t\t\t\t.attr(\"y\", d => y(d.value))\r\n\t\t\t\t\t.attr(\"width\", x.bandwidth())\r\n\t\t\t\t\t.attr(\"height\", d => y(0) - y(d.value))\r\n\t\t\t\t\t.attr(\"fill\", (d, i) => colors[i % colors.length])\r\n\t\t\t\t\t.style(\"opacity\", 0.8)\r\n\t\t\t\t\t.on(\"mouseover\", function (event, d) {\r\n\t\t\t\t\t\thoveredIndex.value = d.index;\r\n\t\t\t\t\t\td3.select(this)\r\n\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t.duration(200)\r\n\t\t\t\t\t\t\t.style(\"opacity\", 1)\r\n\t\t\t\t\t\t\t.attr(\"y\", d => y(d.value) - 5)\r\n\t\t\t\t\t\t\t.attr(\"height\", d => y(0) - y(d.value) + 5);\r\n\r\n\t\t\t\t\t\t// 显示原始值(raw)而不是处理后的数值(value)\r\n\t\t\t\t\t\ttooltip\r\n\t\t\t\t\t\t\t.style(\"visibility\", \"visible\")\r\n\t\t\t\t\t\t\t.html(`${formatTooltipText(d.raw, props.fieldKey)}`);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on(\"mouseout\", function () {\r\n\t\t\t\t\t\thoveredIndex.value = null;\r\n\t\t\t\t\t\td3.select(this)\r\n\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t.duration(200)\r\n\t\t\t\t\t\t\t.style(\"opacity\", 0.8)\r\n\t\t\t\t\t\t\t.attr(\"y\", d => y(d.value))\r\n\t\t\t\t\t\t\t.attr(\"height\", d => y(0) - y(d.value));\r\n\r\n\t\t\t\t\t\ttooltip.style(\"visibility\", \"hidden\");\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on(\"click\", function (event, d) {\r\n\t\t\t\t\t\tactiveIndex.value = d.index;\r\n\t\t\t\t\t\temit(\"chartClick\", {\r\n\t\t\t\t\t\t\ttype: \"bar\",\r\n\t\t\t\t\t\t\tindex: d.index,\r\n\t\t\t\t\t\t\tdata: d,\r\n\t\t\t\t\t\t\tvalue: d.value\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tconst tooltip = container\r\n\t\t\t\t\t.append(\"div\")\r\n\t\t\t\t\t.attr(\"class\", \"d3-tooltip\")\r\n\t\t\t\t\t.style(\"position\", \"absolute\")\r\n\t\t\t\t\t.style(\"visibility\", \"hidden\")\r\n\t\t\t\t\t.style(\"background\", \"rgba(0,0,0,0.8)\")\r\n\t\t\t\t\t.style(\"color\", \"white\")\r\n\t\t\t\t\t.style(\"padding\", \"6px 12px\")\r\n\t\t\t\t\t.style(\"border-radius\", \"4px\")\r\n\t\t\t\t\t.style(\"font-size\", \"12px\");\r\n\t\t\t};\r\n\r\n\t\t\t// 新增工具提示文本格式化函数\r\n\t\t\tconst formatTooltipText = (value, fieldKey) => {\r\n\t\t\t\tif (value === null || value === undefined) return \"-\";\r\n\r\n\t\t\t\t// 如果是对象，尝试获取raw或value\r\n\t\t\t\tif (typeof value === \"object\") {\r\n\t\t\t\t\tvalue = value.raw || value.value || value;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 特殊字段处理\r\n\t\t\t\tif (fieldKey === \"GDP\") {\r\n\t\t\t\t\tconst num =\r\n\t\t\t\t\t\tparseFloat(value.toString().replace(/[^0-9.-]/g, \"\")) /\r\n\t\t\t\t\t\t1000000000000;\r\n\t\t\t\t\treturn isNaN(num) ? value : num.toFixed(2) + \"T\";\r\n\t\t\t\t} else if (fieldKey === \"Population\") {\r\n\t\t\t\t\tconst num =\r\n\t\t\t\t\t\tparseFloat(value.toString().replace(/[^0-9.-]/g, \"\")) / 100000000;\r\n\t\t\t\t\treturn isNaN(num) ? value : num.toFixed(2) + \"亿\";\r\n\t\t\t\t} else if (props.type === \"percentage\") {\r\n\t\t\t\t\tconst percentMatch = value.toString().match(/(\\d+\\.?\\d*)%/);\r\n\t\t\t\t\treturn percentMatch ? percentMatch[0] : value;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn value;\r\n\t\t\t};\r\n\r\n\t\t\tconst renderLineChart = () => {\r\n\t\t\t\tif (!lineContainer.value) return;\r\n\r\n\t\t\t\td3.select(lineContainer.value).selectAll(\"*\").remove();\r\n\r\n\t\t\t\tconst container = d3.select(lineContainer.value);\r\n\t\t\t\tconst width = lineContainer.value.clientWidth;\r\n\t\t\t\tconst height = lineContainer.value.clientHeight;\r\n\t\t\t\tconst margin = { top: 10, right: 10, bottom: 10, left: 10 };\r\n\r\n\t\t\t\tconst svg = container\r\n\t\t\t\t\t.append(\"svg\")\r\n\t\t\t\t\t.attr(\"width\", \"100%\")\r\n\t\t\t\t\t.attr(\"height\", \"100%\")\r\n\t\t\t\t\t.attr(\"viewBox\", `0 0 ${width} ${height}`);\r\n\r\n\t\t\t\tconst x = d3\r\n\t\t\t\t\t.scaleLinear()\r\n\t\t\t\t\t.domain([0, lineData.value.length - 1])\r\n\t\t\t\t\t.range([margin.left, width - margin.right]);\r\n\r\n\t\t\t\tconst y = d3\r\n\t\t\t\t\t.scaleLinear()\r\n\t\t\t\t\t.domain([\r\n\t\t\t\t\t\td3.min(lineData.value, d => d.y),\r\n\t\t\t\t\t\td3.max(lineData.value, d => d.y)\r\n\t\t\t\t\t])\r\n\t\t\t\t\t.nice()\r\n\t\t\t\t\t.range([height - margin.bottom, margin.top]);\r\n\r\n\t\t\t\tconst line = d3\r\n\t\t\t\t\t.line()\r\n\t\t\t\t\t.x((d, i) => x(i))\r\n\t\t\t\t\t.y(d => y(d.y))\r\n\t\t\t\t\t.curve(d3.curveMonotoneX);\r\n\r\n\t\t\t\tsvg\r\n\t\t\t\t\t.append(\"path\")\r\n\t\t\t\t\t.datum(lineData.value)\r\n\t\t\t\t\t.attr(\"fill\", \"none\")\r\n\t\t\t\t\t.attr(\"stroke\", \"#3498db\")\r\n\t\t\t\t\t.attr(\"stroke-width\", 2)\r\n\t\t\t\t\t.attr(\"d\", line);\r\n\r\n\t\t\t\tsvg\r\n\t\t\t\t\t.selectAll(\".dot\")\r\n\t\t\t\t\t.data(lineData.value)\r\n\t\t\t\t\t.enter()\r\n\t\t\t\t\t.append(\"circle\")\r\n\t\t\t\t\t.attr(\"class\", \"dot\")\r\n\t\t\t\t\t.attr(\"cx\", (d, i) => x(i))\r\n\t\t\t\t\t.attr(\"cy\", d => y(d.y))\r\n\t\t\t\t\t.attr(\"r\", 3)\r\n\t\t\t\t\t.attr(\"fill\", \"#3498db\")\r\n\t\t\t\t\t.on(\"mouseover\", function (event, d) {\r\n\t\t\t\t\t\thoveredIndex.value = d.index;\r\n\t\t\t\t\t\td3.select(this)\r\n\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t.duration(200)\r\n\t\t\t\t\t\t\t.attr(\"r\", 5)\r\n\t\t\t\t\t\t\t.attr(\"stroke\", \"white\")\r\n\t\t\t\t\t\t\t.attr(\"stroke-width\", 1);\r\n\r\n\t\t\t\t\t\ttooltip\r\n\t\t\t\t\t\t\t.style(\"visibility\", \"visible\")\r\n\t\t\t\t\t\t\t.html(`${d.raw || formatNumber(d.y, props.fieldKey)}`);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on(\"mouseout\", function () {\r\n\t\t\t\t\t\thoveredIndex.value = null;\r\n\t\t\t\t\t\td3.select(this)\r\n\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t.duration(200)\r\n\t\t\t\t\t\t\t.attr(\"r\", 3)\r\n\t\t\t\t\t\t\t.attr(\"stroke\", \"none\");\r\n\r\n\t\t\t\t\t\ttooltip.style(\"visibility\", \"hidden\");\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on(\"click\", function (event, d) {\r\n\t\t\t\t\t\tactiveIndex.value = d.index;\r\n\t\t\t\t\t\temit(\"chartClick\", {\r\n\t\t\t\t\t\t\ttype: \"line\",\r\n\t\t\t\t\t\t\tindex: d.index,\r\n\t\t\t\t\t\t\tdata: d,\r\n\t\t\t\t\t\t\tvalue: d.y\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tconst tooltip = container\r\n\t\t\t\t\t.append(\"div\")\r\n\t\t\t\t\t.attr(\"class\", \"d3-tooltip\")\r\n\t\t\t\t\t.style(\"position\", \"absolute\")\r\n\t\t\t\t\t.style(\"visibility\", \"hidden\")\r\n\t\t\t\t\t.style(\"background\", \"rgba(0,0,0,0.8)\")\r\n\t\t\t\t\t.style(\"color\", \"white\")\r\n\t\t\t\t\t.style(\"padding\", \"6px 12px\")\r\n\t\t\t\t\t.style(\"border-radius\", \"4px\")\r\n\t\t\t\t\t.style(\"font-size\", \"12px\");\r\n\t\t\t};\r\n\r\n\t\t\tconst handleTextHover = () => {\r\n\t\t\t\tisTextHovered.value = true;\r\n\t\t\t};\r\n\r\n\t\t\tconst resetHover = () => {\r\n\t\t\t\thoveredIndex.value = null;\r\n\t\t\t\tisTextHovered.value = false;\r\n\t\t\t};\r\n\r\n\t\t\tconst handleTextClick = () => {\r\n\t\t\t\temit(\"chartClick\", {\r\n\t\t\t\t\ttype: \"text\",\r\n\t\t\t\t\tdata: props.field,\r\n\t\t\t\t\tvalue: props.field\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tconst formatNumber = (value, fieldKey) => {\r\n\t\t\t\tconst num = Number(value);\r\n\t\t\t\tif (isNaN(num)) return \"0\";\r\n\r\n\t\t\t\tif (props.type === \"percentage\") {\r\n\t\t\t\t\treturn num.toFixed(1) + \"%\";\r\n\t\t\t\t}\r\n\t\t\t\tif (fieldKey === \"GDP\") {\r\n\t\t\t\t\treturn num.toFixed(2) + \"T\";\r\n\t\t\t\t}\r\n\t\t\t\tif (fieldKey === \"Population\") {\r\n\t\t\t\t\treturn num.toFixed(2) + \"亿\";\r\n\t\t\t\t}\r\n\t\t\t\treturn num.toFixed(2);\r\n\t\t\t};\r\n\r\n\t\t\tconst formatSimpleText = value => {\r\n\t\t\t\tif (!value) return \"-\";\r\n\t\t\t\tif (Array.isArray(value)) {\r\n\t\t\t\t\tconst items = value.map(item => item.raw || item.value || item);\r\n\t\t\t\t\treturn items.length > 2\r\n\t\t\t\t\t\t? items.slice(0, 2).join(\"; \") + \"...\"\r\n\t\t\t\t\t\t: items.join(\"; \");\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof value === \"object\") {\r\n\t\t\t\t\treturn value.raw || value.value || \"-\";\r\n\t\t\t\t}\r\n\t\t\t\treturn value.toString().length > 50\r\n\t\t\t\t\t? value.toString().substring(0, 50) + \"...\"\r\n\t\t\t\t\t: value.toString();\r\n\t\t\t};\r\n\r\n\t\t\tconst isYearEntry = value => {\r\n\t\t\t\tif (typeof value !== \"string\") return false;\r\n\t\t\t\tconst trimmedValue = value.trim();\r\n\t\t\t\treturn (\r\n\t\t\t\t\t/^(\\()?\\d{4}(\\))?\\s*:?/.test(trimmedValue) ||\r\n\t\t\t\t\t/^\\(?FY\\s*\\d{4}\\)?\\s*:?/i.test(trimmedValue) ||\r\n\t\t\t\t\t/^(\\()?\\d{4}\\s*[-–]\\s*\\d{2,4}(\\))?\\s*:?/.test(trimmedValue) ||\r\n\t\t\t\t\t/^(Year|Yr|Annual)\\s*\\d{4}/i.test(trimmedValue)\r\n\t\t\t\t);\r\n\t\t\t};\r\n\r\n\t\t\tconst safeToNumber = (value, fieldKey) => {\r\n\t\t\t\tif (value === null || value === undefined) return 0;\r\n\t\t\t\tif (typeof value === \"number\") return value;\r\n\t\t\t\tif (typeof value === \"string\") {\r\n\t\t\t\t\tconst percentMatch = value.match(/(\\d+\\.?\\d*)%/);\r\n\t\t\t\t\tif (percentMatch) return parseFloat(percentMatch[1]);\r\n\t\t\t\t\tconst numStr = value.toString().replace(/[^0-9.-]/g, \"\");\r\n\t\t\t\t\tconst num = parseFloat(numStr);\r\n\t\t\t\t\treturn isNaN(num) ? 0 : num;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t};\r\n\r\n\t\t\tconst isValidPieData = computed(() => {\r\n\t\t\t\tif (!pieData.value.length) return false;\r\n\t\t\t\treturn pieData.value.every(\r\n\t\t\t\t\titem => !isYearEntry(item.name) && !isYearEntry(item.value)\r\n\t\t\t\t);\r\n\t\t\t});\r\n\r\n\t\t\tconst pieData = computed(() => {\r\n\t\t\t\tif (!props.field) return [];\r\n\r\n\t\t\t\tconst processItem = (item, index) => {\r\n\t\t\t\t\tconst rawValue = item?.value || item?.raw || item;\r\n\t\t\t\t\tif (isYearEntry(rawValue)) return null;\r\n\r\n\t\t\t\t\tconst value = safeToNumber(rawValue, props.fieldKey);\r\n\t\t\t\t\tif (value === null) return null;\r\n\r\n\t\t\t\t\tlet name =\r\n\t\t\t\t\t\ttypeof item === \"object\"\r\n\t\t\t\t\t\t\t? (item.raw || \"\").replace(/:\\s*\\d+\\.?\\d*%?/g, \"\")\r\n\t\t\t\t\t\t\t: \"项目\";\r\n\r\n\t\t\t\t\tif (isYearEntry(name)) return null;\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tvalue: Math.min(100, Math.max(0, value)),\r\n\t\t\t\t\t\tname: name.trim() || \"项目\",\r\n\t\t\t\t\t\tindex: index\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (Array.isArray(props.field)) {\r\n\t\t\t\t\treturn props.field\r\n\t\t\t\t\t\t.map((item, index) => processItem(item, index))\r\n\t\t\t\t\t\t.filter(item => item !== null && !isYearEntry(item.name));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (typeof props.field === \"object\") {\r\n\t\t\t\t\tconst result = processItem(props.field, 0);\r\n\t\t\t\t\treturn result ? [result] : [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (isYearEntry(props.field)) return [];\r\n\t\t\t\tconst numValue = safeToNumber(props.field, props.fieldKey);\r\n\t\t\t\treturn numValue !== null && !isYearEntry(props.field)\r\n\t\t\t\t\t? [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvalue: Math.min(100, Math.max(0, numValue)),\r\n\t\t\t\t\t\t\t\tname: \"数值\",\r\n\t\t\t\t\t\t\t\tindex: 0\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t  ]\r\n\t\t\t\t\t: [];\r\n\t\t\t});\r\n\r\n\t\t\tconst simpleBarData = computed(() => {\r\n\t\t\t\tif (!props.field) return [];\r\n\r\n\t\t\t\tlet values = [];\r\n\r\n\t\t\t\tif (Array.isArray(props.field)) {\r\n\t\t\t\t\tvalues = props.field\r\n\t\t\t\t\t\t.filter(item => {\r\n\t\t\t\t\t\t\tconst value = item?.value || item?.raw;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\tvalue !== undefined && value !== null && !isYearEntry(value)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.map(item => safeToNumber(item.value || item.raw, props.fieldKey));\r\n\t\t\t\t} else if (typeof props.field === \"object\") {\r\n\t\t\t\t\tvalues = [\r\n\t\t\t\t\t\tsafeToNumber(props.field.value || props.field.raw, props.fieldKey)\r\n\t\t\t\t\t].filter(v => v !== null);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalues = [safeToNumber(props.field, props.fieldKey)].filter(\r\n\t\t\t\t\t\tv => v !== null\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (values.length === 0) return [];\r\n\r\n\t\t\t\treturn values.map((v, index) => ({\r\n\t\t\t\t\tvalue: v,\r\n\t\t\t\t\theight: v,\r\n\t\t\t\t\tcolor: colors[index % colors.length],\r\n\t\t\t\t\tindex: index\r\n\t\t\t\t}));\r\n\t\t\t});\r\n\r\n\t\t\tconst lineData = computed(() => {\r\n\t\t\t\tif (!props.field) return [];\r\n\r\n\t\t\t\tif (Array.isArray(props.field)) {\r\n\t\t\t\t\treturn props.field\r\n\t\t\t\t\t\t.filter(item => {\r\n\t\t\t\t\t\t\tconst value = item?.value || item?.raw;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\tvalue !== undefined && value !== null && !isYearEntry(value)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.map((item, index) => {\r\n\t\t\t\t\t\t\tconst value = safeToNumber(\r\n\t\t\t\t\t\t\t\titem.value || item.raw,\r\n\t\t\t\t\t\t\t\tprops.fieldKey\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tx: index,\r\n\t\t\t\t\t\t\t\ty: value,\r\n\t\t\t\t\t\t\t\traw: item.raw || item.value,\r\n\t\t\t\t\t\t\t\tindex: index\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (typeof props.field === \"object\") {\r\n\t\t\t\t\tconst value = safeToNumber(\r\n\t\t\t\t\t\tprops.field.value || props.field.raw,\r\n\t\t\t\t\t\tprops.fieldKey\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn value !== null\r\n\t\t\t\t\t\t? [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\t\t\ty: value,\r\n\t\t\t\t\t\t\t\t\traw: props.field.raw || props.field.value,\r\n\t\t\t\t\t\t\t\t\tindex: 0\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t  ]\r\n\t\t\t\t\t\t: [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst value = safeToNumber(props.field, props.fieldKey);\r\n\t\t\t\treturn value !== null\r\n\t\t\t\t\t? [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\t\ty: value,\r\n\t\t\t\t\t\t\t\traw: props.field,\r\n\t\t\t\t\t\t\t\tindex: 0\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t  ]\r\n\t\t\t\t\t: [];\r\n\t\t\t});\r\n\r\n\t\t\tconst hasData = computed(() => {\r\n\t\t\t\tif (!props.field) return false;\r\n\t\t\t\tif (Array.isArray(props.field)) return props.field.length > 0;\r\n\t\t\t\tif (typeof props.field === \"object\")\r\n\t\t\t\t\treturn Object.keys(props.field).length > 0;\r\n\t\t\t\treturn String(props.field).trim().length > 0;\r\n\t\t\t});\r\n\r\n\t\t\treturn {\r\n\t\t\t\thoveredIndex,\r\n\t\t\t\tactiveIndex,\r\n\t\t\t\tisTextHovered,\r\n\t\t\t\tpieContainer,\r\n\t\t\t\tbarContainer,\r\n\t\t\t\tlineContainer,\r\n\t\t\t\thandleTextHover,\r\n\t\t\t\tresetHover,\r\n\t\t\t\thandleTextClick,\r\n\t\t\t\tformatSimpleText,\r\n\t\t\t\thasData,\r\n\t\t\t\tisValidPieData,\r\n\t\t\t\tpieData,\r\n\t\t\t\tsimpleBarData,\r\n\t\t\t\tlineData,\r\n\t\t\t\tformatNumber\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.simple-chart {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tposition: relative;\r\n\t\tfont-family: Arial, sans-serif;\r\n\t}\r\n\r\n\t.simple-text {\r\n\t\ttext-align: center;\r\n\t\tfont-size: 14px;\r\n\t\tword-break: break-word;\r\n\t\tpadding: 8px;\r\n\t\tcursor: pointer;\r\n\t\ttransition: all 0.2s ease;\r\n\t\tborder-radius: 4px;\r\n\t\tbackground-color: #f8f9fa;\r\n\t\tmax-width: 100%;\r\n\t}\r\n\r\n\t.simple-text:hover {\r\n\t\tbackground-color: #e9ecef;\r\n\t\ttransform: translateY(-2px);\r\n\t\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\r\n\t}\r\n\r\n\t.text-tooltip {\r\n\t\tposition: absolute;\r\n\t\ttop: -25px;\r\n\t\tleft: 50%;\r\n\t\ttransform: translateX(-50%);\r\n\t\tbackground-color: rgba(0, 0, 0, 0.8);\r\n\t\tcolor: white;\r\n\t\tpadding: 4px 8px;\r\n\t\tborder-radius: 4px;\r\n\t\tfont-size: 12px;\r\n\t\tpointer-events: none;\r\n\t\twhite-space: nowrap;\r\n\t\tz-index: 10;\r\n\t}\r\n\r\n\t.d3-chart-container {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-height: 80px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.d3-tooltip {\r\n\t\tz-index: 10;\r\n\t\twhite-space: nowrap;\r\n\t\tpointer-events: none;\r\n\t\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);\r\n\t}\r\n\r\n\t.no-data {\r\n\t\tcolor: #999;\r\n\t\tfont-style: italic;\r\n\t\tpadding: 10px;\r\n\t}\r\n\r\n\t@media (max-width: 768px) {\r\n\t\t.simple-text {\r\n\t\t\tfont-size: 12px;\r\n\t\t}\r\n\r\n\t\t.d3-chart-container {\r\n\t\t\tmin-height: 60px;\r\n\t\t}\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}