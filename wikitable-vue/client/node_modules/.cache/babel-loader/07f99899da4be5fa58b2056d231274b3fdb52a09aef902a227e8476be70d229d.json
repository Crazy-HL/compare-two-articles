{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, Fragment as _Fragment, renderList as _renderList, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-a89cbc96\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"simple-chart\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"simple-text\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"simple-pie-container\"\n};\nconst _hoisted_4 = {\n  class: \"pie-value\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"no-data\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"simple-bars-container\"\n};\nconst _hoisted_7 = {\n  class: \"simple-bars\"\n};\nconst _hoisted_8 = {\n  class: \"bar-value\"\n};\nconst _hoisted_9 = {\n  key: 1,\n  class: \"no-data\"\n};\nconst _hoisted_10 = {\n  key: 0,\n  class: \"simple-line-container\"\n};\nconst _hoisted_11 = {\n  viewBox: \"0 0 100 50\",\n  class: \"line-svg\"\n};\nconst _hoisted_12 = [\"points\"];\nconst _hoisted_13 = {\n  class: \"line-value\"\n};\nconst _hoisted_14 = {\n  key: 1,\n  class: \"no-data\"\n};\nconst _hoisted_15 = {\n  class: \"simple-text\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 文本显示 \"), $props.visualization === 'text-only' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString($setup.formatSimpleText($props.field)), 1 /* TEXT */)) : $props.visualization === 'pie-chart' ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" 简化饼图 \"), $setup.hasData ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createElementVNode(\"div\", {\n    class: \"simple-pie\",\n    style: _normalizeStyle($setup.pieStyle)\n  }, null, 4 /* STYLE */), _createElementVNode(\"div\", _hoisted_4, _toDisplayString($setup.primaryValue) + \"%\", 1 /* TEXT */)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \"-\"))], 64 /* STABLE_FRAGMENT */)) : $props.visualization === 'bar-chart' ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 2\n  }, [_createCommentVNode(\" 简化柱状图 \"), $setup.hasData ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.simpleBarData, (item, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"simple-bar\",\n      style: _normalizeStyle({\n        height: item.height + '%'\n      })\n    }, null, 4 /* STYLE */);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_8, _toDisplayString($setup.primaryValue), 1 /* TEXT */)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, \"-\"))], 64 /* STABLE_FRAGMENT */)) : $props.visualization === 'line-chart' ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 3\n  }, [_createCommentVNode(\" 简化折线图 \"), $setup.hasData ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [(_openBlock(), _createElementBlock(\"svg\", _hoisted_11, [_createElementVNode(\"polyline\", {\n    points: $setup.linePoints,\n    fill: \"none\",\n    stroke: \"#3498db\",\n    \"stroke-width\": \"2\"\n  }, null, 8 /* PROPS */, _hoisted_12)])), _createElementVNode(\"div\", _hoisted_13, _toDisplayString($setup.primaryValue) + \"%\", 1 /* TEXT */)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, \"-\"))], 64 /* STABLE_FRAGMENT */)) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 4\n  }, [_createCommentVNode(\" 默认显示 \"), _createElementVNode(\"div\", _hoisted_15, _toDisplayString($setup.formatSimpleText($props.field)), 1 /* TEXT */)], 64 /* STABLE_FRAGMENT */))]);\n}","map":{"version":3,"names":["class","key","viewBox","_createElementBlock","_hoisted_1","_createCommentVNode","$props","visualization","_hoisted_2","_toDisplayString","$setup","formatSimpleText","field","_Fragment","hasData","_hoisted_3","_createElementVNode","style","_normalizeStyle","pieStyle","_hoisted_4","primaryValue","_hoisted_5","_hoisted_6","_hoisted_7","_renderList","simpleBarData","item","index","height","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","points","linePoints","fill","stroke","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15"],"sources":["D:\\vue_frame\\vue_frame\\wikitable-vue\\client\\src\\components\\compoents_base\\SimpleChart.vue"],"sourcesContent":["<template>\r\n\t<div class=\"simple-chart\">\r\n\t\t<!-- 文本显示 -->\r\n\t\t<template v-if=\"visualization === 'text-only'\">\r\n\t\t\t<div class=\"simple-text\">\r\n\t\t\t\t{{ formatSimpleText(field) }}\r\n\t\t\t</div>\r\n\t\t</template>\r\n\r\n\t\t<!-- 简化饼图 -->\r\n\t\t<template v-else-if=\"visualization === 'pie-chart'\">\r\n\t\t\t<div v-if=\"hasData\" class=\"simple-pie-container\">\r\n\t\t\t\t<div class=\"simple-pie\" :style=\"pieStyle\"></div>\r\n\t\t\t\t<div class=\"pie-value\">{{ primaryValue }}%</div>\r\n\t\t\t</div>\r\n\t\t\t<div v-else class=\"no-data\">-</div>\r\n\t\t</template>\r\n\r\n\t\t<!-- 简化柱状图 -->\r\n\t\t<template v-else-if=\"visualization === 'bar-chart'\">\r\n\t\t\t<div v-if=\"hasData\" class=\"simple-bars-container\">\r\n\t\t\t\t<div class=\"simple-bars\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tv-for=\"(item, index) in simpleBarData\"\r\n\t\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t\tclass=\"simple-bar\"\r\n\t\t\t\t\t\t:style=\"{ height: item.height + '%' }\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"bar-value\">{{ primaryValue }}</div>\r\n\t\t\t</div>\r\n\t\t\t<div v-else class=\"no-data\">-</div>\r\n\t\t</template>\r\n\r\n\t\t<!-- 简化折线图 -->\r\n\t\t<template v-else-if=\"visualization === 'line-chart'\">\r\n\t\t\t<div v-if=\"hasData\" class=\"simple-line-container\">\r\n\t\t\t\t<svg viewBox=\"0 0 100 50\" class=\"line-svg\">\r\n\t\t\t\t\t<polyline\r\n\t\t\t\t\t\t:points=\"linePoints\"\r\n\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\tstroke=\"#3498db\"\r\n\t\t\t\t\t\tstroke-width=\"2\" />\r\n\t\t\t\t</svg>\r\n\t\t\t\t<div class=\"line-value\">{{ primaryValue }}%</div>\r\n\t\t\t</div>\r\n\t\t\t<div v-else class=\"no-data\">-</div>\r\n\t\t</template>\r\n\r\n\t\t<!-- 默认显示 -->\r\n\t\t<template v-else>\r\n\t\t\t<div class=\"simple-text\">\r\n\t\t\t\t{{ formatSimpleText(field) }}\r\n\t\t\t</div>\r\n\t\t</template>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { computed } from \"vue\";\r\n\r\n\tconst props = defineProps({\r\n\t\tfield: [Object, Array, String, Number],\r\n\t\ttype: String,\r\n\t\tvisualization: String\r\n\t});\r\n\r\n\t// 安全转换为数字\r\n\tconst safeToNumber = value => {\r\n\t\tif (value === null || value === undefined) return 0;\r\n\t\tif (typeof value === \"number\") return value;\r\n\t\tif (typeof value === \"string\") {\r\n\t\t\tconst numStr = value.toString().replace(/[^0-9.-]/g, \"\");\r\n\t\t\tconst num = parseFloat(numStr);\r\n\t\t\treturn isNaN(num) ? 0 : num;\r\n\t\t}\r\n\t\treturn 0;\r\n\t};\r\n\r\n\t// 格式化简单文本\r\n\tconst formatSimpleText = value => {\r\n\t\tif (!value) return \"-\";\r\n\t\tif (Array.isArray(value)) {\r\n\t\t\tconst items = value.map(item => item.raw || item.value || item);\r\n\t\t\treturn items.length > 2\r\n\t\t\t\t? items.slice(0, 2).join(\"; \") + \"...\"\r\n\t\t\t\t: items.join(\"; \");\r\n\t\t}\r\n\t\tif (typeof value === \"object\") {\r\n\t\t\treturn value.raw || value.value || \"-\";\r\n\t\t}\r\n\t\treturn value.toString().length > 50\r\n\t\t\t? value.toString().substring(0, 50) + \"...\"\r\n\t\t\t: value.toString();\r\n\t};\r\n\r\n\t// 获取主要值\r\n\tconst primaryValue = computed(() => {\r\n\t\tif (!props.field) return \"-\";\r\n\r\n\t\tif (Array.isArray(props.field)) {\r\n\t\t\tconst firstItem = props.field[0];\r\n\t\t\tif (!firstItem) return \"-\";\r\n\t\t\tconst value = firstItem.value || firstItem.raw;\r\n\t\t\treturn value ? safeToNumber(value) : \"-\";\r\n\t\t}\r\n\r\n\t\tif (typeof props.field === \"object\") {\r\n\t\t\tconst value = props.field.value || props.field.raw;\r\n\t\t\treturn value ? safeToNumber(value) : \"-\";\r\n\t\t}\r\n\r\n\t\treturn safeToNumber(props.field);\r\n\t});\r\n\r\n\t// 饼图数据\r\n\tconst pieData = computed(() => {\r\n\t\tif (!props.field) return [];\r\n\r\n\t\tif (Array.isArray(props.field)) {\r\n\t\t\treturn props.field\r\n\t\t\t\t.filter(item => {\r\n\t\t\t\t\tconst value = item?.value || item?.raw;\r\n\t\t\t\t\treturn value !== undefined && value !== null;\r\n\t\t\t\t})\r\n\t\t\t\t.map((item, index) => {\r\n\t\t\t\t\tlet value = safeToNumber(item.value || item.raw);\r\n\t\t\t\t\tvalue = Math.min(100, Math.max(0, value));\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\tname: item.raw\r\n\t\t\t\t\t\t\t? item.raw.replace(/:\\s*\\d+\\.?\\d*%?/g, \"\")\r\n\t\t\t\t\t\t\t: `项目${index + 1}`\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (typeof props.field === \"object\") {\r\n\t\t\tlet value = safeToNumber(props.field.value || props.field.raw);\r\n\t\t\tvalue = Math.min(100, Math.max(0, value));\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tvalue,\r\n\t\t\t\t\tname: props.field.raw\r\n\t\t\t\t\t\t? props.field.raw.replace(/:\\s*\\d+\\.?\\d*%?/g, \"\")\r\n\t\t\t\t\t\t: \"项目\"\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\treturn [];\r\n\t});\r\n\r\n\t// 饼图样式\r\n\tconst pieStyle = computed(() => {\r\n\t\tif (pieData.value.length === 0) return {};\r\n\r\n\t\tconst value = pieData.value[0].value;\r\n\t\tconst deg = (value / 100) * 360;\r\n\r\n\t\treturn {\r\n\t\t\tbackground: `conic-gradient(#3498db 0% ${value}%, #f0f0f0 ${value}% 100%)`\r\n\t\t};\r\n\t});\r\n\r\n\t// 柱状图数据\r\n\tconst simpleBarData = computed(() => {\r\n\t\tif (!props.field) return [];\r\n\r\n\t\tlet values = [];\r\n\r\n\t\tif (Array.isArray(props.field)) {\r\n\t\t\tvalues = props.field\r\n\t\t\t\t.filter(item => {\r\n\t\t\t\t\tconst value = item?.value || item?.raw;\r\n\t\t\t\t\treturn value !== undefined && value !== null;\r\n\t\t\t\t})\r\n\t\t\t\t.map(item => safeToNumber(item.value || item.raw));\r\n\t\t} else if (typeof props.field === \"object\") {\r\n\t\t\tvalues = [safeToNumber(props.field.value || props.field.raw)];\r\n\t\t} else {\r\n\t\t\tvalues = [safeToNumber(props.field)];\r\n\t\t}\r\n\r\n\t\tif (values.length === 0) return [];\r\n\r\n\t\tconst max = Math.max(...values, 1);\r\n\t\treturn values.map(v => ({\r\n\t\t\tvalue: v,\r\n\t\t\theight: (v / max) * 100\r\n\t\t}));\r\n\t});\r\n\r\n\t// 折线图点\r\n\tconst linePoints = computed(() => {\r\n\t\tif (!props.field) return \"\";\r\n\r\n\t\tlet points = [];\r\n\r\n\t\tif (Array.isArray(props.field)) {\r\n\t\t\tpoints = props.field\r\n\t\t\t\t.filter(item => {\r\n\t\t\t\t\tconst value = item?.value || item?.raw;\r\n\t\t\t\t\treturn value !== undefined && value !== null;\r\n\t\t\t\t})\r\n\t\t\t\t.map((item, index, arr) => {\r\n\t\t\t\t\tconst value = safeToNumber(item.value || item.raw);\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tx: (index / (arr.length - 1)) * 100,\r\n\t\t\t\t\t\ty: 50 - (value / 100) * 50\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t} else if (typeof props.field === \"object\") {\r\n\t\t\tconst value = safeToNumber(props.field.value || props.field.raw);\r\n\t\t\tpoints = [\r\n\t\t\t\t{ x: 0, y: 50 - (value / 100) * 50 },\r\n\t\t\t\t{ x: 100, y: 50 - (value / 100) * 50 }\r\n\t\t\t];\r\n\t\t} else {\r\n\t\t\tconst value = safeToNumber(props.field);\r\n\t\t\tpoints = [\r\n\t\t\t\t{ x: 0, y: 50 - (value / 100) * 50 },\r\n\t\t\t\t{ x: 100, y: 50 - (value / 100) * 50 }\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\treturn points.map(p => `${p.x},${p.y}`).join(\" \");\r\n\t});\r\n\r\n\tconst hasData = computed(() => {\r\n\t\tif (!props.field) return false;\r\n\t\tif (Array.isArray(props.field)) return props.field.length > 0;\r\n\t\tif (typeof props.field === \"object\")\r\n\t\t\treturn Object.keys(props.field).length > 0;\r\n\t\treturn String(props.field).trim().length > 0;\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.simple-chart {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.simple-text {\r\n\t\ttext-align: center;\r\n\t\tfont-size: 14px;\r\n\t\tword-break: break-word;\r\n\t\tpadding: 5px;\r\n\t}\r\n\r\n\t.simple-pie-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 5px;\r\n\t}\r\n\r\n\t.simple-pie {\r\n\t\twidth: 50px;\r\n\t\theight: 50px;\r\n\t\tborder-radius: 50%;\r\n\t}\r\n\r\n\t.pie-value {\r\n\t\tfont-size: 12px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #3498db;\r\n\t}\r\n\r\n\t.simple-bars-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 5px;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.simple-bars {\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-end;\r\n\t\theight: 50px;\r\n\t\tgap: 4px;\r\n\t\twidth: 100%;\r\n\t\tpadding: 0 10px;\r\n\t}\r\n\r\n\t.simple-bar {\r\n\t\tflex: 1;\r\n\t\tbackground-color: #3498db;\r\n\t\tmin-width: 5px;\r\n\t\ttransition: height 0.3s;\r\n\t\tborder-radius: 2px 2px 0 0;\r\n\t}\r\n\r\n\t.bar-value {\r\n\t\tfont-size: 12px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #3498db;\r\n\t}\r\n\r\n\t.simple-line-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 5px;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.line-svg {\r\n\t\twidth: 100%;\r\n\t\theight: 50px;\r\n\t}\r\n\r\n\t.line-value {\r\n\t\tfont-size: 12px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #3498db;\r\n\t}\r\n\r\n\t.no-data {\r\n\t\tcolor: #999;\r\n\t\tfont-style: italic;\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}