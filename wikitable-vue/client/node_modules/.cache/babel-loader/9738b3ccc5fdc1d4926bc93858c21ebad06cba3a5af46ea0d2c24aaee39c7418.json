{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, onMounted, onUnmounted, nextTick } from \"vue\";\nimport LoadingSpinner from \"./LoadingSpinner.vue\";\nimport ErrorDisplay from \"./ErrorDisplay.vue\";\nimport WikipediaContent from \"./WikipediaContent.vue\";\nimport TextPopup from \"./TextPopup.vue\";\nimport ArticleOutline from \"./ArticleOutline.vue\";\nimport * as d3 from \"d3\";\nimport bus from \"@/js/eventBus.js\";\nimport { parseInfoboxForComparison } from \"@/js/wikiInfoboxParser\";\nimport api from \"@/api\";\nexport default {\n  __name: 'ParentComponent',\n  props: {\n    pageTitle: String,\n    divId: String,\n    selectContentClass: String,\n    linkedOutline: Array\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n    const pageHtml = ref(\"\");\n    const loading = ref(true);\n    const error = ref(\"\");\n    const selectedText = ref({});\n    const showPopup = ref({});\n    const divRef = ref(null);\n    const highlightedParagraphs = ref({});\n    const MainTextContent = ref(\"\");\n    const exactHighlightTexts = {\n      div1: {\n        GDP: [\"China is also the world's largest consumer of numerous commodities, and accounts for about half of global consumption of metals\", \"China has bilateral free trade agreements with many nations and is a member of the Regional Comprehensive Economic Partnership (RCEP).\"],\n        Population: [\"1.4 billion\", \"population census\"]\n      },\n      div3: {\n        GDP: [\"The American Reinvestment and Recovery Act was enacted by the United States Congress, and in the ensuing years the U.S. experienced the longest economic expansion on record by July 2019\"],\n        Population: [\"330 million\", \"population density\"]\n      }\n    };\n    const fetchWikipediaContent = async () => {\n      try {\n        const apiUrl = `https://en.wikipedia.org/api/rest_v1/page/html/${encodeURIComponent(props.pageTitle)}`;\n        const response = await fetch(apiUrl);\n        if (!response.ok) throw new Error(\"Failed to fetch data\");\n        const html = await response.text();\n        const MainTextContent = cleanWikipediaContent(html);\n        console.log(MainTextContent);\n        const parser = new DOMParser();\n        const doc = parser.parseFromString(html, \"text/html\");\n        const infobox = doc.querySelector(\".infobox, .sidebar, .toccolours\");\n\n        // 使用修改后的解析器\n        const parsedData = parseInfoboxForComparison(infobox);\n\n        // 确保数据结构一致\n        const comparisonData = {\n          title: props.pageTitle,\n          type: parsedData.type || \"经济\",\n          data: {\n            sections: parsedData.data?.sections || {}\n          }\n        };\n        bus.emit(`${props.divId}_InfoboxData`, comparisonData);\n        const sidebar = doc.querySelector(\".sidebar\");\n        if (sidebar) sidebar.remove();\n        const headings = doc.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\n        headings.forEach((heading, index) => {\n          const uniqueId = `heading-${index}-${props.divId}`;\n          heading.id = uniqueId;\n        });\n        const tables = doc.querySelectorAll(\"table\");\n        tables.forEach(table => {\n          table.classList.add(\"custom-table\");\n        });\n        const styles = Array.from(doc.querySelectorAll('link[rel=\"stylesheet\"]'));\n        styles.forEach(link => {\n          if (!document.querySelector(`link[href=\"${link.href}\"]`)) {\n            const styleTag = document.createElement(\"link\");\n            styleTag.rel = \"stylesheet\";\n            styleTag.href = link.href;\n            document.head.appendChild(styleTag);\n          }\n        });\n        const contentElement = doc.querySelector(\"body\");\n        if (!contentElement) throw new Error(\"Content not found\");\n        pageHtml.value = contentElement.innerHTML;\n        injectWikipediaStyles();\n        bus.emit(`${props.divId}_FullContent`, {\n          content: pageHtml.value,\n          title: props.pageTitle\n        });\n      } catch (err) {\n        error.value = \"Error fetching Wikipedia content: \" + err.message;\n        console.error(\"获取维基百科内容失败:\", err);\n      } finally {\n        loading.value = false;\n      }\n    };\n    const cleanWikipediaContent = html => {\n      const parser = new DOMParser();\n      const doc = parser.parseFromString(html, \"text/html\");\n      const selectorsToRemove = [\".infobox\", \".sidebar\", \".toc\", \".reflist\", \".hatnote\", \".navbox\", \".mw-editsection\", \"table.ambox\", \".shortdescription\", \"img\", \"figure\"];\n      selectorsToRemove.forEach(selector => {\n        doc.querySelectorAll(selector).forEach(el => el.remove());\n      });\n      const bodyContent = doc.querySelector(\"#bodyContent, #mw-content-text\") || doc.body;\n      let plainText = bodyContent.textContent || bodyContent.innerText;\n      plainText = plainText.replace(/\\s+/g, \" \").replace(/\\[\\d+\\]/g, \"\").trim();\n      return plainText;\n    };\n    const injectWikipediaStyles = () => {\n      const wikipediaStyles = [\"https://en.wikipedia.org/w/load.php?modules=site.styles\", \"https://en.wikipedia.org/w/load.php?modules=ext.cite.styles\", \"https://en.wikipedia.org/w/load.php?modules=ext.scribunto.styles\", \"https://en.wikipedia.org/w/load.php?modules=skins.vector.styles\"];\n      wikipediaStyles.forEach(url => {\n        if (!document.querySelector(`link[href=\"${url}\"]`)) {\n          const styleTag = document.createElement(\"link\");\n          styleTag.rel = \"stylesheet\";\n          styleTag.href = url;\n          document.head.appendChild(styleTag);\n        }\n      });\n    };\n    const handleHoverInfobox = _ref2 => {\n      let {\n        fieldKey,\n        infoboxTitle\n      } = _ref2;\n      if (props.pageTitle !== infoboxTitle) return;\n      const infobox = divRef.value.querySelector(\".infobox, .sidebar, .toccolours\");\n      if (!infobox) return;\n      clearInfoboxHighlights();\n      const rows = infobox.querySelectorAll(\"tr\");\n      for (const row of rows) {\n        const th = row.querySelector(\"th\");\n        if (th && th.textContent.trim() === fieldKey) {\n          row.classList.add(\"infobox-highlight\");\n          break;\n        }\n      }\n    };\n    const handleUnhoverInfobox = () => {\n      clearInfoboxHighlights();\n    };\n    const clearInfoboxHighlights = () => {\n      const infobox = divRef.value.querySelector(\".infobox, .sidebar, .toccolours\");\n      if (infobox) {\n        infobox.querySelectorAll(\".infobox-highlight\").forEach(row => {\n          row.classList.remove(\"infobox-highlight\");\n        });\n      }\n    };\n    const handleSelection = content => {\n      const isTable = /<table.*?>.*?<\\/table>/s.test(content);\n      const selection = window.getSelection();\n      if (!selection || selection.rangeCount === 0) return;\n      const range = selection.getRangeAt(0);\n      const selectedNodes = range.cloneContents().childNodes;\n      let sourceId = undefined;\n      for (const node of selectedNodes) {\n        if (node.nodeType === Node.ELEMENT_NODE && /^h[1-6]$/i.test(node.tagName)) {\n          sourceId = node.id;\n          break;\n        }\n      }\n      if (!sourceId) {\n        let startElement = range.startContainer;\n        while (startElement && !/^h[1-6]$/i.test(startElement.tagName)) {\n          startElement = startElement.parentElement;\n        }\n        sourceId = startElement ? startElement.id : undefined;\n      }\n      if (!sourceId) {\n        selectedText.value[props.divId] = content;\n        bus.emit(`${props.divId}_Event`, {\n          content\n        });\n        showPopup.value[props.divId] = true;\n        nextTick(() => {\n          updatePopupPosition();\n        });\n        return;\n      }\n      handleSelectionWithSourceId(content, sourceId, isTable);\n    };\n    const handleSelectionWithSourceId = (content, sourceId, isTable) => {\n      selectedText.value[props.divId] = content;\n      bus.emit(`${props.divId}_Event`, {\n        content\n      });\n      showPopup.value[props.divId] = true;\n      if (isTable) {\n        const {\n          linkedItem,\n          chapterContent\n        } = extractLinkedChapterContent(sourceId, props.divId);\n        if (linkedItem && chapterContent) {\n          const otherContainerId = props.divId === \"div1\" ? \"div3\" : \"div1\";\n          const targetId = props.divId === \"div1\" ? linkedItem.rightId : linkedItem.leftId;\n          const targetElement = document.getElementById(targetId);\n          if (targetElement) {\n            targetElement.scrollIntoView({\n              behavior: \"smooth\"\n            });\n          }\n          bus.emit(`${otherContainerId}_Event`, {\n            content: chapterContent\n          });\n          bus.emit(`${otherContainerId}Event`, {\n            content: chapterContent,\n            sourceId: sourceId\n          });\n        }\n      }\n      nextTick(() => {\n        updatePopupPosition();\n      });\n    };\n    const closePopup = () => {\n      showPopup.value[props.divId] = false;\n      selectedText.value[props.divId] = \"\";\n      const container = props.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\n      d3.select(container).html(\"\");\n    };\n    const updatePopupPosition = () => {\n      if (showPopup.value[props.divId] && divRef.value) {\n        const popup = divRef.value.querySelector(\".text-popup\");\n        const overlay = divRef.value.querySelector(\".overlay\");\n        if (popup && overlay) {\n          const rect = divRef.value.getBoundingClientRect();\n          const scrollTop = divRef.value.scrollTop;\n          const scrollLeft = divRef.value.scrollLeft;\n          overlay.style.top = `${scrollTop}px`;\n          overlay.style.left = `${scrollLeft}px`;\n          overlay.style.width = `${divRef.value.clientWidth}px`;\n          overlay.style.height = `${divRef.value.clientHeight}px`;\n          popup.style.top = `${rect.height / 2 + scrollTop}px`;\n          popup.style.left = `${rect.width / 2 + scrollLeft}px`;\n        }\n      }\n    };\n    const extractLinkedChapterContent = (sourceId, sourceContainerId) => {\n      if (!props.linkedOutline) {\n        return {\n          linkedItem: null,\n          chapterContent: \"\"\n        };\n      }\n      const linkedItem = props.linkedOutline.find(linked => linked.leftId === sourceId || linked.rightId === sourceId);\n      if (!linkedItem) {\n        return {\n          linkedItem: null,\n          chapterContent: \"\"\n        };\n      }\n      const targetContainerId = sourceContainerId === \"div1\" ? \"div3\" : \"div1\";\n      const targetId = sourceContainerId === \"div1\" ? linkedItem.rightId : linkedItem.leftId;\n      const targetContainer = document.getElementById(targetContainerId);\n      if (!targetContainer) {\n        return {\n          linkedItem: null,\n          chapterContent: \"\"\n        };\n      }\n      const targetElement = targetContainer.querySelector(`#${targetId}`);\n      if (!targetElement) {\n        return {\n          linkedItem: null,\n          chapterContent: \"\"\n        };\n      }\n      let chapterContent = \"\";\n      let currentNode = targetElement;\n      while (currentNode) {\n        if (currentNode !== targetElement && currentNode.nodeType === Node.ELEMENT_NODE && /^h[1-6]$/i.test(currentNode.tagName)) {\n          break;\n        }\n        if (currentNode.nodeType === Node.ELEMENT_NODE || currentNode.nodeType === Node.TEXT_NODE) {\n          chapterContent += currentNode.outerHTML || currentNode.textContent;\n        }\n        currentNode = currentNode.nextSibling;\n      }\n      return {\n        linkedItem,\n        chapterContent\n      };\n    };\n    const highlightParagraphs = fieldKey => {\n      clearHighlights();\n      if (!divRef.value) return;\n      const textsToHighlight = exactHighlightTexts[props.divId]?.[fieldKey] || [];\n      textsToHighlight.forEach(text => {\n        highlightExactText(text);\n      });\n    };\n    const highlightExactText = textToHighlight => {\n      const contentElement = divRef.value.querySelector(\".wikipedia-content\");\n      if (!contentElement || !textToHighlight) return;\n      const walker = document.createTreeWalker(contentElement, NodeFilter.SHOW_TEXT, null, false);\n      let node;\n      const matches = [];\n      while (node = walker.nextNode()) {\n        const nodeValue = node.nodeValue;\n        let pos = 0;\n        while ((pos = nodeValue.indexOf(textToHighlight, pos)) >= 0) {\n          matches.push({\n            node,\n            start: pos,\n            end: pos + textToHighlight.length\n          });\n          pos += textToHighlight.length;\n        }\n      }\n      matches.reverse().forEach(_ref3 => {\n        let {\n          node,\n          start,\n          end\n        } = _ref3;\n        const parent = node.parentNode;\n        const before = node.splitText(start);\n        const highlighted = before.splitText(end - start);\n        const span = document.createElement(\"span\");\n        span.className = `highlight-exact highlight-${props.divId}`;\n        span.textContent = before.nodeValue;\n        parent.replaceChild(span, before);\n        if (!highlightedParagraphs.value[props.divId]) {\n          highlightedParagraphs.value[props.divId] = [];\n        }\n        highlightedParagraphs.value[props.divId].push(span);\n      });\n      if (highlightedParagraphs.value[props.divId]?.[0]) {\n        highlightedParagraphs.value[props.divId][0].scrollIntoView({\n          behavior: \"smooth\",\n          block: \"center\"\n        });\n      }\n    };\n    const clearHighlights = () => {\n      if (!highlightedParagraphs.value[props.divId]) return;\n      highlightedParagraphs.value[props.divId].forEach(highlight => {\n        if (highlight.parentNode) {\n          const textNode = document.createTextNode(highlight.textContent);\n          highlight.parentNode.replaceChild(textNode, highlight);\n        }\n      });\n      highlightedParagraphs.value[props.divId] = [];\n    };\n    onMounted(() => {\n      fetchWikipediaContent();\n      if (divRef.value) {\n        divRef.value.addEventListener(\"scroll\", updatePopupPosition);\n      }\n      const hoverEvent = `hover-${props.divId === \"div1\" ? \"left\" : \"right\"}-infobox`;\n      const unhoverEvent = `unhover-${props.divId === \"div1\" ? \"left\" : \"right\"}-infobox`;\n      bus.on(hoverEvent, handleHoverInfobox);\n      bus.on(unhoverEvent, handleUnhoverInfobox);\n      bus.on(`${props.divId}Event`, _ref4 => {\n        let {\n          content,\n          sourceId\n        } = _ref4;\n        selectedText.value[props.divId] = content;\n        showPopup.value[props.divId] = true;\n        nextTick(() => {\n          updatePopupPosition();\n        });\n      });\n      bus.on(`highlight-${props.divId}-paragraphs`, highlightParagraphs);\n      bus.on(`clear-${props.divId}-highlights`, clearHighlights);\n    });\n    onUnmounted(() => {\n      if (divRef.value) {\n        divRef.value.removeEventListener(\"scroll\", updatePopupPosition);\n      }\n      const hoverEvent = `hover-${props.divId === \"div1\" ? \"left\" : \"right\"}-infobox`;\n      const unhoverEvent = `unhover-${props.divId === \"div1\" ? \"left\" : \"right\"}-infobox`;\n      bus.off(hoverEvent, handleHoverInfobox);\n      bus.off(unhoverEvent, handleUnhoverInfobox);\n      bus.off(`${props.divId}Event`);\n      bus.off(`highlight-${props.divId}-paragraphs`, highlightParagraphs);\n      bus.off(`clear-${props.divId}-highlights`, clearHighlights);\n    });\n    const __returned__ = {\n      props,\n      pageHtml,\n      loading,\n      error,\n      selectedText,\n      showPopup,\n      divRef,\n      highlightedParagraphs,\n      MainTextContent,\n      exactHighlightTexts,\n      fetchWikipediaContent,\n      cleanWikipediaContent,\n      injectWikipediaStyles,\n      handleHoverInfobox,\n      handleUnhoverInfobox,\n      clearInfoboxHighlights,\n      handleSelection,\n      handleSelectionWithSourceId,\n      closePopup,\n      updatePopupPosition,\n      extractLinkedChapterContent,\n      highlightParagraphs,\n      highlightExactText,\n      clearHighlights,\n      ref,\n      onMounted,\n      onUnmounted,\n      nextTick,\n      LoadingSpinner,\n      ErrorDisplay,\n      WikipediaContent,\n      TextPopup,\n      ArticleOutline,\n      get d3() {\n        return d3;\n      },\n      get bus() {\n        return bus;\n      },\n      get parseInfoboxForComparison() {\n        return parseInfoboxForComparison;\n      },\n      get api() {\n        return api;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","nextTick","LoadingSpinner","ErrorDisplay","WikipediaContent","TextPopup","ArticleOutline","d3","bus","parseInfoboxForComparison","api","props","__props","pageHtml","loading","error","selectedText","showPopup","divRef","highlightedParagraphs","MainTextContent","exactHighlightTexts","div1","GDP","Population","div3","fetchWikipediaContent","apiUrl","encodeURIComponent","pageTitle","response","fetch","ok","Error","html","text","cleanWikipediaContent","console","log","parser","DOMParser","doc","parseFromString","infobox","querySelector","parsedData","comparisonData","title","type","data","sections","emit","divId","sidebar","remove","headings","querySelectorAll","forEach","heading","index","uniqueId","id","tables","table","classList","add","styles","Array","from","link","document","href","styleTag","createElement","rel","head","appendChild","contentElement","value","innerHTML","injectWikipediaStyles","content","err","message","selectorsToRemove","selector","el","bodyContent","body","plainText","textContent","innerText","replace","trim","wikipediaStyles","url","handleHoverInfobox","_ref2","fieldKey","infoboxTitle","clearInfoboxHighlights","rows","row","th","handleUnhoverInfobox","handleSelection","isTable","test","selection","window","getSelection","rangeCount","range","getRangeAt","selectedNodes","cloneContents","childNodes","sourceId","undefined","node","nodeType","Node","ELEMENT_NODE","tagName","startElement","startContainer","parentElement","updatePopupPosition","handleSelectionWithSourceId","linkedItem","chapterContent","extractLinkedChapterContent","otherContainerId","targetId","rightId","leftId","targetElement","getElementById","scrollIntoView","behavior","closePopup","container","select","popup","overlay","rect","getBoundingClientRect","scrollTop","scrollLeft","style","top","left","width","clientWidth","height","clientHeight","sourceContainerId","linkedOutline","find","linked","targetContainerId","targetContainer","currentNode","TEXT_NODE","outerHTML","nextSibling","highlightParagraphs","clearHighlights","textsToHighlight","highlightExactText","textToHighlight","walker","createTreeWalker","NodeFilter","SHOW_TEXT","matches","nextNode","nodeValue","pos","indexOf","push","start","end","length","reverse","_ref3","parent","parentNode","before","splitText","highlighted","span","className","replaceChild","block","highlight","textNode","createTextNode","addEventListener","hoverEvent","unhoverEvent","on","_ref4","removeEventListener","off"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/compoents_base/ParentComponent.vue"],"sourcesContent":["<template>\r\n\t<div :class=\"['div0', selectContentClass]\" :id=\"divId\" ref=\"divRef\">\r\n\t\t<h1>{{ props.pageTitle }}</h1>\r\n\r\n\t\t<LoadingSpinner v-if=\"loading\" />\r\n\r\n\t\t<ErrorDisplay\r\n\t\t\tv-else-if=\"error\"\r\n\t\t\t:message=\"error\"\r\n\t\t\t@retry=\"fetchWikipediaContent\" />\r\n\r\n\t\t<WikipediaContent v-else :content=\"pageHtml\" @select=\"handleSelection\" />\r\n\r\n\t\t<TextPopup\r\n\t\t\t:visible=\"showPopup[divId]\"\r\n\t\t\t:content=\"selectedText[divId]\"\r\n\t\t\t:containerClass=\"\r\n\t\t\t\tdivId === 'div1' ? 'chart-container1' : 'chart-container2'\r\n\t\t\t\"\r\n\t\t\t:containerRef=\"divRef\"\r\n\t\t\t@close=\"closePopup\" />\r\n\r\n\t\t<ArticleOutline :content=\"pageHtml\" :divId=\"divId\" />\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted, onUnmounted, nextTick } from \"vue\";\r\n\timport LoadingSpinner from \"./LoadingSpinner.vue\";\r\n\timport ErrorDisplay from \"./ErrorDisplay.vue\";\r\n\timport WikipediaContent from \"./WikipediaContent.vue\";\r\n\timport TextPopup from \"./TextPopup.vue\";\r\n\timport ArticleOutline from \"./ArticleOutline.vue\";\r\n\timport * as d3 from \"d3\";\r\n\timport bus from \"@/js/eventBus.js\";\r\n\timport { parseInfoboxForComparison } from \"@/js/wikiInfoboxParser\";\r\n\timport api from \"@/api\";\r\n\r\n\tconst props = defineProps({\r\n\t\tpageTitle: String,\r\n\t\tdivId: String,\r\n\t\tselectContentClass: String,\r\n\t\tlinkedOutline: Array\r\n\t});\r\n\r\n\tconst pageHtml = ref(\"\");\r\n\tconst loading = ref(true);\r\n\tconst error = ref(\"\");\r\n\tconst selectedText = ref({});\r\n\tconst showPopup = ref({});\r\n\tconst divRef = ref(null);\r\n\tconst highlightedParagraphs = ref({});\r\n\tconst MainTextContent = ref(\"\");\r\n\r\n\tconst exactHighlightTexts = {\r\n\t\tdiv1: {\r\n\t\t\tGDP: [\r\n\t\t\t\t\"China is also the world's largest consumer of numerous commodities, and accounts for about half of global consumption of metals\",\r\n\t\t\t\t\"China has bilateral free trade agreements with many nations and is a member of the Regional Comprehensive Economic Partnership (RCEP).\"\r\n\t\t\t],\r\n\t\t\tPopulation: [\"1.4 billion\", \"population census\"]\r\n\t\t},\r\n\t\tdiv3: {\r\n\t\t\tGDP: [\r\n\t\t\t\t\"The American Reinvestment and Recovery Act was enacted by the United States Congress, and in the ensuing years the U.S. experienced the longest economic expansion on record by July 2019\"\r\n\t\t\t],\r\n\t\t\tPopulation: [\"330 million\", \"population density\"]\r\n\t\t}\r\n\t};\r\n\r\n\tconst fetchWikipediaContent = async () => {\r\n\t\ttry {\r\n\t\t\tconst apiUrl = `https://en.wikipedia.org/api/rest_v1/page/html/${encodeURIComponent(\r\n\t\t\t\tprops.pageTitle\r\n\t\t\t)}`;\r\n\t\t\tconst response = await fetch(apiUrl);\r\n\t\t\tif (!response.ok) throw new Error(\"Failed to fetch data\");\r\n\r\n\t\t\tconst html = await response.text();\r\n\t\t\tconst MainTextContent = cleanWikipediaContent(html);\r\n\t\t\tconsole.log(MainTextContent);\r\n\t\t\tconst parser = new DOMParser();\r\n\t\t\tconst doc = parser.parseFromString(html, \"text/html\");\r\n\r\n\t\t\tconst infobox = doc.querySelector(\".infobox, .sidebar, .toccolours\");\r\n\r\n\t\t\t// 使用修改后的解析器\r\n\t\t\tconst parsedData = parseInfoboxForComparison(infobox);\r\n\r\n\t\t\t// 确保数据结构一致\r\n\t\t\tconst comparisonData = {\r\n\t\t\t\ttitle: props.pageTitle,\r\n\t\t\t\ttype: parsedData.type || \"经济\",\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tsections: parsedData.data?.sections || {}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tbus.emit(`${props.divId}_InfoboxData`, comparisonData);\r\n\r\n\t\t\tconst sidebar = doc.querySelector(\".sidebar\");\r\n\t\t\tif (sidebar) sidebar.remove();\r\n\r\n\t\t\tconst headings = doc.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\r\n\t\t\theadings.forEach((heading, index) => {\r\n\t\t\t\tconst uniqueId = `heading-${index}-${props.divId}`;\r\n\t\t\t\theading.id = uniqueId;\r\n\t\t\t});\r\n\r\n\t\t\tconst tables = doc.querySelectorAll(\"table\");\r\n\t\t\ttables.forEach(table => {\r\n\t\t\t\ttable.classList.add(\"custom-table\");\r\n\t\t\t});\r\n\r\n\t\t\tconst styles = Array.from(doc.querySelectorAll('link[rel=\"stylesheet\"]'));\r\n\t\t\tstyles.forEach(link => {\r\n\t\t\t\tif (!document.querySelector(`link[href=\"${link.href}\"]`)) {\r\n\t\t\t\t\tconst styleTag = document.createElement(\"link\");\r\n\t\t\t\t\tstyleTag.rel = \"stylesheet\";\r\n\t\t\t\t\tstyleTag.href = link.href;\r\n\t\t\t\t\tdocument.head.appendChild(styleTag);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tconst contentElement = doc.querySelector(\"body\");\r\n\t\t\tif (!contentElement) throw new Error(\"Content not found\");\r\n\r\n\t\t\tpageHtml.value = contentElement.innerHTML;\r\n\t\t\tinjectWikipediaStyles();\r\n\r\n\t\t\tbus.emit(`${props.divId}_FullContent`, {\r\n\t\t\t\tcontent: pageHtml.value,\r\n\t\t\t\ttitle: props.pageTitle\r\n\t\t\t});\r\n\t\t} catch (err) {\r\n\t\t\terror.value = \"Error fetching Wikipedia content: \" + err.message;\r\n\t\t\tconsole.error(\"获取维基百科内容失败:\", err);\r\n\t\t} finally {\r\n\t\t\tloading.value = false;\r\n\t\t}\r\n\t};\r\n\r\n\tconst cleanWikipediaContent = html => {\r\n\t\tconst parser = new DOMParser();\r\n\t\tconst doc = parser.parseFromString(html, \"text/html\");\r\n\r\n\t\tconst selectorsToRemove = [\r\n\t\t\t\".infobox\",\r\n\t\t\t\".sidebar\",\r\n\t\t\t\".toc\",\r\n\t\t\t\".reflist\",\r\n\t\t\t\".hatnote\",\r\n\t\t\t\".navbox\",\r\n\t\t\t\".mw-editsection\",\r\n\t\t\t\"table.ambox\",\r\n\t\t\t\".shortdescription\",\r\n\t\t\t\"img\",\r\n\t\t\t\"figure\"\r\n\t\t];\r\n\r\n\t\tselectorsToRemove.forEach(selector => {\r\n\t\t\tdoc.querySelectorAll(selector).forEach(el => el.remove());\r\n\t\t});\r\n\r\n\t\tconst bodyContent =\r\n\t\t\tdoc.querySelector(\"#bodyContent, #mw-content-text\") || doc.body;\r\n\r\n\t\tlet plainText = bodyContent.textContent || bodyContent.innerText;\r\n\r\n\t\tplainText = plainText\r\n\t\t\t.replace(/\\s+/g, \" \")\r\n\t\t\t.replace(/\\[\\d+\\]/g, \"\")\r\n\t\t\t.trim();\r\n\r\n\t\treturn plainText;\r\n\t};\r\n\r\n\tconst injectWikipediaStyles = () => {\r\n\t\tconst wikipediaStyles = [\r\n\t\t\t\"https://en.wikipedia.org/w/load.php?modules=site.styles\",\r\n\t\t\t\"https://en.wikipedia.org/w/load.php?modules=ext.cite.styles\",\r\n\t\t\t\"https://en.wikipedia.org/w/load.php?modules=ext.scribunto.styles\",\r\n\t\t\t\"https://en.wikipedia.org/w/load.php?modules=skins.vector.styles\"\r\n\t\t];\r\n\r\n\t\twikipediaStyles.forEach(url => {\r\n\t\t\tif (!document.querySelector(`link[href=\"${url}\"]`)) {\r\n\t\t\t\tconst styleTag = document.createElement(\"link\");\r\n\t\t\t\tstyleTag.rel = \"stylesheet\";\r\n\t\t\t\tstyleTag.href = url;\r\n\t\t\t\tdocument.head.appendChild(styleTag);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleHoverInfobox = ({ fieldKey, infoboxTitle }) => {\r\n\t\tif (props.pageTitle !== infoboxTitle) return;\r\n\r\n\t\tconst infobox = divRef.value.querySelector(\r\n\t\t\t\".infobox, .sidebar, .toccolours\"\r\n\t\t);\r\n\t\tif (!infobox) return;\r\n\r\n\t\tclearInfoboxHighlights();\r\n\r\n\t\tconst rows = infobox.querySelectorAll(\"tr\");\r\n\t\tfor (const row of rows) {\r\n\t\t\tconst th = row.querySelector(\"th\");\r\n\t\t\tif (th && th.textContent.trim() === fieldKey) {\r\n\t\t\t\trow.classList.add(\"infobox-highlight\");\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleUnhoverInfobox = () => {\r\n\t\tclearInfoboxHighlights();\r\n\t};\r\n\r\n\tconst clearInfoboxHighlights = () => {\r\n\t\tconst infobox = divRef.value.querySelector(\r\n\t\t\t\".infobox, .sidebar, .toccolours\"\r\n\t\t);\r\n\t\tif (infobox) {\r\n\t\t\tinfobox.querySelectorAll(\".infobox-highlight\").forEach(row => {\r\n\t\t\t\trow.classList.remove(\"infobox-highlight\");\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleSelection = content => {\r\n\t\tconst isTable = /<table.*?>.*?<\\/table>/s.test(content);\r\n\t\tconst selection = window.getSelection();\r\n\t\tif (!selection || selection.rangeCount === 0) return;\r\n\r\n\t\tconst range = selection.getRangeAt(0);\r\n\t\tconst selectedNodes = range.cloneContents().childNodes;\r\n\r\n\t\tlet sourceId = undefined;\r\n\t\tfor (const node of selectedNodes) {\r\n\t\t\tif (\r\n\t\t\t\tnode.nodeType === Node.ELEMENT_NODE &&\r\n\t\t\t\t/^h[1-6]$/i.test(node.tagName)\r\n\t\t\t) {\r\n\t\t\t\tsourceId = node.id;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!sourceId) {\r\n\t\t\tlet startElement = range.startContainer;\r\n\t\t\twhile (startElement && !/^h[1-6]$/i.test(startElement.tagName)) {\r\n\t\t\t\tstartElement = startElement.parentElement;\r\n\t\t\t}\r\n\t\t\tsourceId = startElement ? startElement.id : undefined;\r\n\t\t}\r\n\r\n\t\tif (!sourceId) {\r\n\t\t\tselectedText.value[props.divId] = content;\r\n\t\t\tbus.emit(`${props.divId}_Event`, { content });\r\n\t\t\tshowPopup.value[props.divId] = true;\r\n\t\t\tnextTick(() => {\r\n\t\t\t\tupdatePopupPosition();\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\thandleSelectionWithSourceId(content, sourceId, isTable);\r\n\t};\r\n\r\n\tconst handleSelectionWithSourceId = (content, sourceId, isTable) => {\r\n\t\tselectedText.value[props.divId] = content;\r\n\t\tbus.emit(`${props.divId}_Event`, { content });\r\n\t\tshowPopup.value[props.divId] = true;\r\n\r\n\t\tif (isTable) {\r\n\t\t\tconst { linkedItem, chapterContent } = extractLinkedChapterContent(\r\n\t\t\t\tsourceId,\r\n\t\t\t\tprops.divId\r\n\t\t\t);\r\n\r\n\t\t\tif (linkedItem && chapterContent) {\r\n\t\t\t\tconst otherContainerId = props.divId === \"div1\" ? \"div3\" : \"div1\";\r\n\t\t\t\tconst targetId =\r\n\t\t\t\t\tprops.divId === \"div1\" ? linkedItem.rightId : linkedItem.leftId;\r\n\r\n\t\t\t\tconst targetElement = document.getElementById(targetId);\r\n\t\t\t\tif (targetElement) {\r\n\t\t\t\t\ttargetElement.scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbus.emit(`${otherContainerId}_Event`, { content: chapterContent });\r\n\t\t\t\tbus.emit(`${otherContainerId}Event`, {\r\n\t\t\t\t\tcontent: chapterContent,\r\n\t\t\t\t\tsourceId: sourceId\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tnextTick(() => {\r\n\t\t\tupdatePopupPosition();\r\n\t\t});\r\n\t};\r\n\r\n\tconst closePopup = () => {\r\n\t\tshowPopup.value[props.divId] = false;\r\n\t\tselectedText.value[props.divId] = \"\";\r\n\t\tconst container =\r\n\t\t\tprops.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\r\n\t\td3.select(container).html(\"\");\r\n\t};\r\n\r\n\tconst updatePopupPosition = () => {\r\n\t\tif (showPopup.value[props.divId] && divRef.value) {\r\n\t\t\tconst popup = divRef.value.querySelector(\".text-popup\");\r\n\t\t\tconst overlay = divRef.value.querySelector(\".overlay\");\r\n\t\t\tif (popup && overlay) {\r\n\t\t\t\tconst rect = divRef.value.getBoundingClientRect();\r\n\t\t\t\tconst scrollTop = divRef.value.scrollTop;\r\n\t\t\t\tconst scrollLeft = divRef.value.scrollLeft;\r\n\r\n\t\t\t\toverlay.style.top = `${scrollTop}px`;\r\n\t\t\t\toverlay.style.left = `${scrollLeft}px`;\r\n\t\t\t\toverlay.style.width = `${divRef.value.clientWidth}px`;\r\n\t\t\t\toverlay.style.height = `${divRef.value.clientHeight}px`;\r\n\r\n\t\t\t\tpopup.style.top = `${rect.height / 2 + scrollTop}px`;\r\n\t\t\t\tpopup.style.left = `${rect.width / 2 + scrollLeft}px`;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst extractLinkedChapterContent = (sourceId, sourceContainerId) => {\r\n\t\tif (!props.linkedOutline) {\r\n\t\t\treturn { linkedItem: null, chapterContent: \"\" };\r\n\t\t}\r\n\r\n\t\tconst linkedItem = props.linkedOutline.find(\r\n\t\t\tlinked => linked.leftId === sourceId || linked.rightId === sourceId\r\n\t\t);\r\n\t\tif (!linkedItem) {\r\n\t\t\treturn { linkedItem: null, chapterContent: \"\" };\r\n\t\t}\r\n\r\n\t\tconst targetContainerId = sourceContainerId === \"div1\" ? \"div3\" : \"div1\";\r\n\t\tconst targetId =\r\n\t\t\tsourceContainerId === \"div1\" ? linkedItem.rightId : linkedItem.leftId;\r\n\r\n\t\tconst targetContainer = document.getElementById(targetContainerId);\r\n\t\tif (!targetContainer) {\r\n\t\t\treturn { linkedItem: null, chapterContent: \"\" };\r\n\t\t}\r\n\r\n\t\tconst targetElement = targetContainer.querySelector(`#${targetId}`);\r\n\t\tif (!targetElement) {\r\n\t\t\treturn { linkedItem: null, chapterContent: \"\" };\r\n\t\t}\r\n\r\n\t\tlet chapterContent = \"\";\r\n\t\tlet currentNode = targetElement;\r\n\r\n\t\twhile (currentNode) {\r\n\t\t\tif (\r\n\t\t\t\tcurrentNode !== targetElement &&\r\n\t\t\t\tcurrentNode.nodeType === Node.ELEMENT_NODE &&\r\n\t\t\t\t/^h[1-6]$/i.test(currentNode.tagName)\r\n\t\t\t) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tcurrentNode.nodeType === Node.ELEMENT_NODE ||\r\n\t\t\t\tcurrentNode.nodeType === Node.TEXT_NODE\r\n\t\t\t) {\r\n\t\t\t\tchapterContent += currentNode.outerHTML || currentNode.textContent;\r\n\t\t\t}\r\n\r\n\t\t\tcurrentNode = currentNode.nextSibling;\r\n\t\t}\r\n\r\n\t\treturn { linkedItem, chapterContent };\r\n\t};\r\n\r\n\tconst highlightParagraphs = fieldKey => {\r\n\t\tclearHighlights();\r\n\r\n\t\tif (!divRef.value) return;\r\n\r\n\t\tconst textsToHighlight = exactHighlightTexts[props.divId]?.[fieldKey] || [];\r\n\r\n\t\ttextsToHighlight.forEach(text => {\r\n\t\t\thighlightExactText(text);\r\n\t\t});\r\n\t};\r\n\r\n\tconst highlightExactText = textToHighlight => {\r\n\t\tconst contentElement = divRef.value.querySelector(\".wikipedia-content\");\r\n\t\tif (!contentElement || !textToHighlight) return;\r\n\r\n\t\tconst walker = document.createTreeWalker(\r\n\t\t\tcontentElement,\r\n\t\t\tNodeFilter.SHOW_TEXT,\r\n\t\t\tnull,\r\n\t\t\tfalse\r\n\t\t);\r\n\r\n\t\tlet node;\r\n\t\tconst matches = [];\r\n\r\n\t\twhile ((node = walker.nextNode())) {\r\n\t\t\tconst nodeValue = node.nodeValue;\r\n\t\t\tlet pos = 0;\r\n\t\t\twhile ((pos = nodeValue.indexOf(textToHighlight, pos)) >= 0) {\r\n\t\t\t\tmatches.push({\r\n\t\t\t\t\tnode,\r\n\t\t\t\t\tstart: pos,\r\n\t\t\t\t\tend: pos + textToHighlight.length\r\n\t\t\t\t});\r\n\t\t\t\tpos += textToHighlight.length;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmatches.reverse().forEach(({ node, start, end }) => {\r\n\t\t\tconst parent = node.parentNode;\r\n\r\n\t\t\tconst before = node.splitText(start);\r\n\t\t\tconst highlighted = before.splitText(end - start);\r\n\r\n\t\t\tconst span = document.createElement(\"span\");\r\n\t\t\tspan.className = `highlight-exact highlight-${props.divId}`;\r\n\t\t\tspan.textContent = before.nodeValue;\r\n\r\n\t\t\tparent.replaceChild(span, before);\r\n\r\n\t\t\tif (!highlightedParagraphs.value[props.divId]) {\r\n\t\t\t\thighlightedParagraphs.value[props.divId] = [];\r\n\t\t\t}\r\n\t\t\thighlightedParagraphs.value[props.divId].push(span);\r\n\t\t});\r\n\r\n\t\tif (highlightedParagraphs.value[props.divId]?.[0]) {\r\n\t\t\thighlightedParagraphs.value[props.divId][0].scrollIntoView({\r\n\t\t\t\tbehavior: \"smooth\",\r\n\t\t\t\tblock: \"center\"\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst clearHighlights = () => {\r\n\t\tif (!highlightedParagraphs.value[props.divId]) return;\r\n\r\n\t\thighlightedParagraphs.value[props.divId].forEach(highlight => {\r\n\t\t\tif (highlight.parentNode) {\r\n\t\t\t\tconst textNode = document.createTextNode(highlight.textContent);\r\n\t\t\t\thighlight.parentNode.replaceChild(textNode, highlight);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\thighlightedParagraphs.value[props.divId] = [];\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tfetchWikipediaContent();\r\n\r\n\t\tif (divRef.value) {\r\n\t\t\tdivRef.value.addEventListener(\"scroll\", updatePopupPosition);\r\n\t\t}\r\n\r\n\t\tconst hoverEvent = `hover-${\r\n\t\t\tprops.divId === \"div1\" ? \"left\" : \"right\"\r\n\t\t}-infobox`;\r\n\t\tconst unhoverEvent = `unhover-${\r\n\t\t\tprops.divId === \"div1\" ? \"left\" : \"right\"\r\n\t\t}-infobox`;\r\n\r\n\t\tbus.on(hoverEvent, handleHoverInfobox);\r\n\t\tbus.on(unhoverEvent, handleUnhoverInfobox);\r\n\r\n\t\tbus.on(`${props.divId}Event`, ({ content, sourceId }) => {\r\n\t\t\tselectedText.value[props.divId] = content;\r\n\t\t\tshowPopup.value[props.divId] = true;\r\n\t\t\tnextTick(() => {\r\n\t\t\t\tupdatePopupPosition();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tbus.on(`highlight-${props.divId}-paragraphs`, highlightParagraphs);\r\n\t\tbus.on(`clear-${props.divId}-highlights`, clearHighlights);\r\n\t});\r\n\r\n\tonUnmounted(() => {\r\n\t\tif (divRef.value) {\r\n\t\t\tdivRef.value.removeEventListener(\"scroll\", updatePopupPosition);\r\n\t\t}\r\n\r\n\t\tconst hoverEvent = `hover-${\r\n\t\t\tprops.divId === \"div1\" ? \"left\" : \"right\"\r\n\t\t}-infobox`;\r\n\t\tconst unhoverEvent = `unhover-${\r\n\t\t\tprops.divId === \"div1\" ? \"left\" : \"right\"\r\n\t\t}-infobox`;\r\n\r\n\t\tbus.off(hoverEvent, handleHoverInfobox);\r\n\t\tbus.off(unhoverEvent, handleUnhoverInfobox);\r\n\t\tbus.off(`${props.divId}Event`);\r\n\r\n\t\tbus.off(`highlight-${props.divId}-paragraphs`, highlightParagraphs);\r\n\t\tbus.off(`clear-${props.divId}-highlights`, clearHighlights);\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\th1 {\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 20px;\r\n\t\tcolor: #2c3e50;\r\n\t}\r\n\r\n\t.div0 {\r\n\t\tposition: relative;\r\n\t\twidth: 55%;\r\n\t\tmax-width: 100%;\r\n\t\tmax-height: 100%;\r\n\t\toverflow: auto;\r\n\t\tpadding: 20px;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-radius: 12px;\r\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n\t\tmargin: 10px;\r\n\t}\r\n\r\n\t#div1,\r\n\t#div3 {\r\n\t\twidth: 55%;\r\n\t\tmax-width: 100%;\r\n\t\tmax-height: 100%;\r\n\t\toverflow: auto;\r\n\t\tpadding: 20px;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-radius: 12px;\r\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n\t\tmargin: 10px;\r\n\t}\r\n\r\n\t.showHtml {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\toverflow: auto;\r\n\t}\r\n\r\n\t::selection {\r\n\t\tbackground-color: rgba(255, 255, 0, 0.3);\r\n\t\tcolor: inherit;\r\n\t}\r\n</style>\r\n\r\n<style>\r\n\t.infobox tr.infobox-highlight th,\r\n\t.infobox tr.infobox-highlight td,\r\n\t.sidebar tr.infobox-highlight th,\r\n\t.sidebar tr.infobox-highlight td,\r\n\t.toccolours tr.infobox-highlight th,\r\n\t.toccolours tr.infobox-highlight td {\r\n\t\tbackground-color: #fffacd !important;\r\n\t\tbox-shadow: 0 0 8px rgba(255, 235, 59, 0.8) !important;\r\n\t\ttransition: all 0.15s ease !important;\r\n\t}\r\n\r\n\t.highlight-exact.highlight-div1 {\r\n\t\tbackground-color: rgba(255, 235, 59, 0.6);\r\n\t\tpadding: 0 2px;\r\n\t\tborder-radius: 3px;\r\n\t\tbox-shadow: 0 0 0 1px rgba(255, 235, 59, 0.3);\r\n\t}\r\n\r\n\t.highlight-exact.highlight-div3 {\r\n\t\tbackground-color: rgba(100, 221, 23, 0.6);\r\n\t\tpadding: 0 2px;\r\n\t\tborder-radius: 3px;\r\n\t\tbox-shadow: 0 0 0 1px rgba(76, 175, 80, 0.3);\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}