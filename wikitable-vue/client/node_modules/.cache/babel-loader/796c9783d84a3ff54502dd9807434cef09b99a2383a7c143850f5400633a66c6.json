{"ast":null,"code":"// highlight.js\n\n// 高亮选中的文本\nfunction highlightText(range) {\n  try {\n    // 检查选区的起始和结束节点是否为文本节点\n    const startNode = range.startContainer;\n    const endNode = range.endContainer;\n    if (startNode.nodeType === 3 && endNode.nodeType === 3) {\n      // 如果选中的范围是纯文本节点，可以进行高亮\n      const span = document.createElement(\"span\");\n      span.classList.add(\"highlight\");\n      range.surroundContents(span);\n    } else {\n      console.error(\"选区包含非文本节点，无法高亮\");\n    }\n  } catch (error) {\n    console.error(\"高亮处理失败:\", error);\n  }\n}\n\n// 序列化选区信息\nfunction serializeRange(range) {\n  return {\n    startContainer: range.startContainer.parentElement.outerHTML,\n    startOffset: range.startOffset,\n    endContainer: range.endContainer.parentElement.outerHTML,\n    endOffset: range.endOffset,\n    text: range.toString()\n  };\n}\n\n// 反序列化选区信息\nfunction deserializeRange(serialized) {\n  const pageContent = document.getElementById(\"pageContent\");\n  const walker = document.createTreeWalker(pageContent, NodeFilter.SHOW_TEXT);\n  let startNode, endNode;\n  while (walker.nextNode()) {\n    if (walker.currentNode.parentElement.outerHTML === serialized.startContainer) {\n      startNode = walker.currentNode;\n    }\n    if (walker.currentNode.parentElement.outerHTML === serialized.endContainer) {\n      endNode = walker.currentNode;\n    }\n  }\n  if (startNode && endNode) {\n    const range = document.createRange();\n    range.setStart(startNode, serialized.startOffset);\n    range.setEnd(endNode, serialized.endOffset);\n    return range;\n  }\n  return null;\n}\n\n// 保存高亮信息\nfunction saveHighlights(highlights) {\n  localStorage.setItem(\"highlights\", JSON.stringify(highlights));\n  console.log(\"高亮已保存！\");\n}\n\n// 加载高亮信息\nfunction loadHighlights() {\n  const savedHighlights = JSON.parse(localStorage.getItem(\"highlights\") || \"[]\");\n  return savedHighlights;\n}\n\n// 导出函数以便在其他地方调用\nexport default {\n  highlightText,\n  serializeRange,\n  deserializeRange,\n  saveHighlights,\n  loadHighlights\n};","map":{"version":3,"names":["highlightText","range","startNode","startContainer","endNode","endContainer","nodeType","span","document","createElement","classList","add","surroundContents","console","error","serializeRange","parentElement","outerHTML","startOffset","endOffset","text","toString","deserializeRange","serialized","pageContent","getElementById","walker","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","currentNode","createRange","setStart","setEnd","saveHighlights","highlights","localStorage","setItem","JSON","stringify","log","loadHighlights","savedHighlights","parse","getItem"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/js/highlight.js"],"sourcesContent":["// highlight.js\r\n\r\n// 高亮选中的文本\r\nfunction highlightText(range) {\r\n  try {\r\n    // 检查选区的起始和结束节点是否为文本节点\r\n    const startNode = range.startContainer;\r\n    const endNode = range.endContainer;\r\n\r\n    if (startNode.nodeType === 3 && endNode.nodeType === 3) {\r\n      // 如果选中的范围是纯文本节点，可以进行高亮\r\n      const span = document.createElement(\"span\");\r\n      span.classList.add(\"highlight\");\r\n      range.surroundContents(span);\r\n    } else {\r\n      console.error(\"选区包含非文本节点，无法高亮\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"高亮处理失败:\", error);\r\n  }\r\n}\r\n\r\n// 序列化选区信息\r\nfunction serializeRange(range) {\r\n  return {\r\n    startContainer: range.startContainer.parentElement.outerHTML,\r\n    startOffset: range.startOffset,\r\n    endContainer: range.endContainer.parentElement.outerHTML,\r\n    endOffset: range.endOffset,\r\n    text: range.toString()\r\n  };\r\n}\r\n\r\n// 反序列化选区信息\r\nfunction deserializeRange(serialized) {\r\n  const pageContent = document.getElementById(\"pageContent\");\r\n  const walker = document.createTreeWalker(\r\n    pageContent,\r\n    NodeFilter.SHOW_TEXT\r\n  );\r\n\r\n  let startNode, endNode;\r\n  while (walker.nextNode()) {\r\n    if (\r\n      walker.currentNode.parentElement.outerHTML ===\r\n      serialized.startContainer\r\n    ) {\r\n      startNode = walker.currentNode;\r\n    }\r\n    if (\r\n      walker.currentNode.parentElement.outerHTML ===\r\n      serialized.endContainer\r\n    ) {\r\n      endNode = walker.currentNode;\r\n    }\r\n  }\r\n\r\n  if (startNode && endNode) {\r\n    const range = document.createRange();\r\n    range.setStart(startNode, serialized.startOffset);\r\n    range.setEnd(endNode, serialized.endOffset);\r\n    return range;\r\n  }\r\n  return null;\r\n}\r\n\r\n// 保存高亮信息\r\nfunction saveHighlights(highlights) {\r\n  localStorage.setItem(\"highlights\", JSON.stringify(highlights));\r\n  console.log(\"高亮已保存！\");\r\n}\r\n\r\n// 加载高亮信息\r\nfunction loadHighlights() {\r\n  const savedHighlights = JSON.parse(\r\n    localStorage.getItem(\"highlights\") || \"[]\"\r\n  );\r\n  return savedHighlights;\r\n}\r\n\r\n// 导出函数以便在其他地方调用\r\nexport default {\r\n  highlightText,\r\n  serializeRange,\r\n  deserializeRange,\r\n  saveHighlights,\r\n  loadHighlights\r\n};\r\n"],"mappings":"AAAA;;AAEA;AACA,SAASA,aAAaA,CAACC,KAAK,EAAE;EAC5B,IAAI;IACF;IACA,MAAMC,SAAS,GAAGD,KAAK,CAACE,cAAc;IACtC,MAAMC,OAAO,GAAGH,KAAK,CAACI,YAAY;IAElC,IAAIH,SAAS,CAACI,QAAQ,KAAK,CAAC,IAAIF,OAAO,CAACE,QAAQ,KAAK,CAAC,EAAE;MACtD;MACA,MAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;MAC3CF,IAAI,CAACG,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;MAC/BV,KAAK,CAACW,gBAAgB,CAACL,IAAI,CAAC;IAC9B,CAAC,MAAM;MACLM,OAAO,CAACC,KAAK,CAAC,gBAAgB,CAAC;IACjC;EACF,CAAC,CAAC,OAAOA,KAAK,EAAE;IACdD,OAAO,CAACC,KAAK,CAAC,SAAS,EAAEA,KAAK,CAAC;EACjC;AACF;;AAEA;AACA,SAASC,cAAcA,CAACd,KAAK,EAAE;EAC7B,OAAO;IACLE,cAAc,EAAEF,KAAK,CAACE,cAAc,CAACa,aAAa,CAACC,SAAS;IAC5DC,WAAW,EAAEjB,KAAK,CAACiB,WAAW;IAC9Bb,YAAY,EAAEJ,KAAK,CAACI,YAAY,CAACW,aAAa,CAACC,SAAS;IACxDE,SAAS,EAAElB,KAAK,CAACkB,SAAS;IAC1BC,IAAI,EAAEnB,KAAK,CAACoB,QAAQ,CAAC;EACvB,CAAC;AACH;;AAEA;AACA,SAASC,gBAAgBA,CAACC,UAAU,EAAE;EACpC,MAAMC,WAAW,GAAGhB,QAAQ,CAACiB,cAAc,CAAC,aAAa,CAAC;EAC1D,MAAMC,MAAM,GAAGlB,QAAQ,CAACmB,gBAAgB,CACtCH,WAAW,EACXI,UAAU,CAACC,SACb,CAAC;EAED,IAAI3B,SAAS,EAAEE,OAAO;EACtB,OAAOsB,MAAM,CAACI,QAAQ,CAAC,CAAC,EAAE;IACxB,IACEJ,MAAM,CAACK,WAAW,CAACf,aAAa,CAACC,SAAS,KAC1CM,UAAU,CAACpB,cAAc,EACzB;MACAD,SAAS,GAAGwB,MAAM,CAACK,WAAW;IAChC;IACA,IACEL,MAAM,CAACK,WAAW,CAACf,aAAa,CAACC,SAAS,KAC1CM,UAAU,CAAClB,YAAY,EACvB;MACAD,OAAO,GAAGsB,MAAM,CAACK,WAAW;IAC9B;EACF;EAEA,IAAI7B,SAAS,IAAIE,OAAO,EAAE;IACxB,MAAMH,KAAK,GAAGO,QAAQ,CAACwB,WAAW,CAAC,CAAC;IACpC/B,KAAK,CAACgC,QAAQ,CAAC/B,SAAS,EAAEqB,UAAU,CAACL,WAAW,CAAC;IACjDjB,KAAK,CAACiC,MAAM,CAAC9B,OAAO,EAAEmB,UAAU,CAACJ,SAAS,CAAC;IAC3C,OAAOlB,KAAK;EACd;EACA,OAAO,IAAI;AACb;;AAEA;AACA,SAASkC,cAAcA,CAACC,UAAU,EAAE;EAClCC,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEC,IAAI,CAACC,SAAS,CAACJ,UAAU,CAAC,CAAC;EAC9DvB,OAAO,CAAC4B,GAAG,CAAC,QAAQ,CAAC;AACvB;;AAEA;AACA,SAASC,cAAcA,CAAA,EAAG;EACxB,MAAMC,eAAe,GAAGJ,IAAI,CAACK,KAAK,CAChCP,YAAY,CAACQ,OAAO,CAAC,YAAY,CAAC,IAAI,IACxC,CAAC;EACD,OAAOF,eAAe;AACxB;;AAEA;AACA,eAAe;EACb3C,aAAa;EACbe,cAAc;EACdO,gBAAgB;EAChBa,cAAc;EACdO;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}