{"ast":null,"code":"import { ref, onMounted, watch } from \"vue\";\nimport * as echarts from \"echarts\";\nexport default {\n  __name: 'BarChart',\n  props: {\n    value: {\n      type: Number,\n      default: 0\n    },\n    max: {\n      type: Number,\n      default: 100\n    },\n    title: {\n      type: String,\n      default: \"\"\n    },\n    unit: {\n      type: String,\n      default: \"\"\n    }\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n    const chartEl = ref(null);\n    let chartInstance = null;\n    const initChart = () => {\n      if (!chartEl.value) return;\n      chartInstance = echarts.init(chartEl.value);\n\n      // 计算比例\n      const percentage = Math.min(props.value / props.max * 100, 100);\n      const remaining = 100 - percentage;\n      const option = {\n        title: {\n          text: `${props.title}\\n${props.value}${props.unit}`,\n          left: \"center\",\n          top: \"center\",\n          textStyle: {\n            fontSize: 14,\n            fontWeight: \"normal\"\n          }\n        },\n        tooltip: {\n          trigger: \"item\",\n          formatter: \"{b}: {c} ({d}%)\"\n        },\n        series: [{\n          name: \"比例\",\n          type: \"pie\",\n          radius: [\"70%\", \"90%\"],\n          avoidLabelOverlap: false,\n          itemStyle: {\n            borderRadius: 10,\n            borderColor: \"#fff\",\n            borderWidth: 2\n          },\n          label: {\n            show: false,\n            position: \"center\"\n          },\n          emphasis: {\n            label: {\n              show: true,\n              fontSize: 18,\n              fontWeight: \"bold\"\n            }\n          },\n          labelLine: {\n            show: false\n          },\n          data: [{\n            value: percentage,\n            name: \"已完成\",\n            itemStyle: {\n              color: \"#3498db\"\n            }\n          }, {\n            value: remaining,\n            name: \"剩余\",\n            itemStyle: {\n              color: \"#eee\"\n            }\n          }]\n        }]\n      };\n      chartInstance.setOption(option);\n    };\n    onMounted(() => {\n      initChart();\n      window.addEventListener(\"resize\", () => chartInstance?.resize());\n    });\n    watch(() => [props.value, props.max], () => {\n      if (chartInstance) {\n        initChart();\n      }\n    }, {\n      deep: true\n    });\n    const __returned__ = {\n      props,\n      chartEl,\n      get chartInstance() {\n        return chartInstance;\n      },\n      set chartInstance(v) {\n        chartInstance = v;\n      },\n      initChart,\n      ref,\n      onMounted,\n      watch,\n      get echarts() {\n        return echarts;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","watch","echarts","props","__props","chartEl","chartInstance","initChart","value","init","percentage","Math","min","max","remaining","option","title","text","unit","left","top","textStyle","fontSize","fontWeight","tooltip","trigger","formatter","series","name","type","radius","avoidLabelOverlap","itemStyle","borderRadius","borderColor","borderWidth","label","show","position","emphasis","labelLine","data","color","setOption","window","addEventListener","resize","deep"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/compoents_base/charts/BarChart.vue"],"sourcesContent":["<template>\r\n\t<div ref=\"chartEl\" class=\"pie-chart\"></div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted, watch } from \"vue\";\r\n\timport * as echarts from \"echarts\";\r\n\r\n\tconst props = defineProps({\r\n\t\tvalue: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tmax: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 100\r\n\t\t},\r\n\t\ttitle: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"\"\r\n\t\t},\r\n\t\tunit: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"\"\r\n\t\t}\r\n\t});\r\n\r\n\tconst chartEl = ref(null);\r\n\tlet chartInstance = null;\r\n\r\n\tconst initChart = () => {\r\n\t\tif (!chartEl.value) return;\r\n\r\n\t\tchartInstance = echarts.init(chartEl.value);\r\n\r\n\t\t// 计算比例\r\n\t\tconst percentage = Math.min((props.value / props.max) * 100, 100);\r\n\t\tconst remaining = 100 - percentage;\r\n\r\n\t\tconst option = {\r\n\t\t\ttitle: {\r\n\t\t\t\ttext: `${props.title}\\n${props.value}${props.unit}`,\r\n\t\t\t\tleft: \"center\",\r\n\t\t\t\ttop: \"center\",\r\n\t\t\t\ttextStyle: {\r\n\t\t\t\t\tfontSize: 14,\r\n\t\t\t\t\tfontWeight: \"normal\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttooltip: {\r\n\t\t\t\ttrigger: \"item\",\r\n\t\t\t\tformatter: \"{b}: {c} ({d}%)\"\r\n\t\t\t},\r\n\t\t\tseries: [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: \"比例\",\r\n\t\t\t\t\ttype: \"pie\",\r\n\t\t\t\t\tradius: [\"70%\", \"90%\"],\r\n\t\t\t\t\tavoidLabelOverlap: false,\r\n\t\t\t\t\titemStyle: {\r\n\t\t\t\t\t\tborderRadius: 10,\r\n\t\t\t\t\t\tborderColor: \"#fff\",\r\n\t\t\t\t\t\tborderWidth: 2\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlabel: {\r\n\t\t\t\t\t\tshow: false,\r\n\t\t\t\t\t\tposition: \"center\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\temphasis: {\r\n\t\t\t\t\t\tlabel: {\r\n\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\tfontSize: 18,\r\n\t\t\t\t\t\t\tfontWeight: \"bold\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlabelLine: {\r\n\t\t\t\t\t\tshow: false\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvalue: percentage,\r\n\t\t\t\t\t\t\tname: \"已完成\",\r\n\t\t\t\t\t\t\titemStyle: { color: \"#3498db\" }\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvalue: remaining,\r\n\t\t\t\t\t\t\tname: \"剩余\",\r\n\t\t\t\t\t\t\titemStyle: { color: \"#eee\" }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tchartInstance.setOption(option);\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tinitChart();\r\n\t\twindow.addEventListener(\"resize\", () => chartInstance?.resize());\r\n\t});\r\n\r\n\twatch(\r\n\t\t() => [props.value, props.max],\r\n\t\t() => {\r\n\t\t\tif (chartInstance) {\r\n\t\t\t\tinitChart();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{ deep: true }\r\n\t);\r\n</script>\r\n\r\n<style scoped>\r\n\t.pie-chart {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-height: 300px;\r\n\t}\r\n</style>\r\n"],"mappings":"AAKC,SAASA,GAAG,EAAEC,SAAS,EAAEC,KAAK,QAAQ,KAAK;AAC3C,OAAO,KAAKC,OAAO,MAAM,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;IAElC,MAAMC,KAAK,GAAGC,OAiBZ;IAEF,MAAMC,OAAO,GAAGN,GAAG,CAAC,IAAI,CAAC;IACzB,IAAIO,aAAa,GAAG,IAAI;IAExB,MAAMC,SAAS,GAAGA,CAAA,KAAM;MACvB,IAAI,CAACF,OAAO,CAACG,KAAK,EAAE;MAEpBF,aAAa,GAAGJ,OAAO,CAACO,IAAI,CAACJ,OAAO,CAACG,KAAK,CAAC;;MAE3C;MACA,MAAME,UAAU,GAAGC,IAAI,CAACC,GAAG,CAAET,KAAK,CAACK,KAAK,GAAGL,KAAK,CAACU,GAAG,GAAI,GAAG,EAAE,GAAG,CAAC;MACjE,MAAMC,SAAS,GAAG,GAAG,GAAGJ,UAAU;MAElC,MAAMK,MAAM,GAAG;QACdC,KAAK,EAAE;UACNC,IAAI,EAAE,GAAGd,KAAK,CAACa,KAAK,KAAKb,KAAK,CAACK,KAAK,GAAGL,KAAK,CAACe,IAAI,EAAE;UACnDC,IAAI,EAAE,QAAQ;UACdC,GAAG,EAAE,QAAQ;UACbC,SAAS,EAAE;YACVC,QAAQ,EAAE,EAAE;YACZC,UAAU,EAAE;UACb;QACD,CAAC;QACDC,OAAO,EAAE;UACRC,OAAO,EAAE,MAAM;UACfC,SAAS,EAAE;QACZ,CAAC;QACDC,MAAM,EAAE,CACP;UACCC,IAAI,EAAE,IAAI;UACVC,IAAI,EAAE,KAAK;UACXC,MAAM,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;UACtBC,iBAAiB,EAAE,KAAK;UACxBC,SAAS,EAAE;YACVC,YAAY,EAAE,EAAE;YAChBC,WAAW,EAAE,MAAM;YACnBC,WAAW,EAAE;UACd,CAAC;UACDC,KAAK,EAAE;YACNC,IAAI,EAAE,KAAK;YACXC,QAAQ,EAAE;UACX,CAAC;UACDC,QAAQ,EAAE;YACTH,KAAK,EAAE;cACNC,IAAI,EAAE,IAAI;cACVf,QAAQ,EAAE,EAAE;cACZC,UAAU,EAAE;YACb;UACD,CAAC;UACDiB,SAAS,EAAE;YACVH,IAAI,EAAE;UACP,CAAC;UACDI,IAAI,EAAE,CACL;YACCjC,KAAK,EAAEE,UAAU;YACjBkB,IAAI,EAAE,KAAK;YACXI,SAAS,EAAE;cAAEU,KAAK,EAAE;YAAU;UAC/B,CAAC,EACD;YACClC,KAAK,EAAEM,SAAS;YAChBc,IAAI,EAAE,IAAI;YACVI,SAAS,EAAE;cAAEU,KAAK,EAAE;YAAO;UAC5B,CAAC;QAEH,CAAC;MAEH,CAAC;MAEDpC,aAAa,CAACqC,SAAS,CAAC5B,MAAM,CAAC;IAChC,CAAC;IAEDf,SAAS,CAAC,MAAM;MACfO,SAAS,CAAC,CAAC;MACXqC,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAE,MAAMvC,aAAa,EAAEwC,MAAM,CAAC,CAAC,CAAC;IACjE,CAAC,CAAC;IAEF7C,KAAK,CACJ,MAAM,CAACE,KAAK,CAACK,KAAK,EAAEL,KAAK,CAACU,GAAG,CAAC,EAC9B,MAAM;MACL,IAAIP,aAAa,EAAE;QAClBC,SAAS,CAAC,CAAC;MACZ;IACD,CAAC,EACD;MAAEwC,IAAI,EAAE;IAAK,CACd,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}