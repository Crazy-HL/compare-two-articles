{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  id: \"app\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"h1\", null, \"数据可视化工具\", -1 /* HOISTED */);\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"可视化结果\", -1 /* HOISTED */);\nconst _hoisted_5 = {\n  ref: \"chart\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.text = $event),\n    placeholder: \"请输入文章内容\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.text]]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = function () {\n      return $options.processText && $options.processText(...arguments);\n    })\n  }, \"提交并可视化\"), $data.jsonData ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_hoisted_4, _createElementVNode(\"div\", _hoisted_5, null, 512 /* NEED_PATCH */)])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["id","_createElementVNode","key","ref","_createElementBlock","_hoisted_1","_hoisted_2","_cache","$event","$data","text","placeholder","onClick","$options","processText","arguments","jsonData","_hoisted_3","_hoisted_4","_hoisted_5","_createCommentVNode"],"sources":["D:\\vue_frame\\vue_frame\\wikitable-vue\\client\\src\\components\\Vis2.vue"],"sourcesContent":["<template>\r\n\t<div id=\"app\">\r\n\t\t<h1>数据可视化工具</h1>\r\n\t\t<textarea v-model=\"text\" placeholder=\"请输入文章内容\"></textarea>\r\n\t\t<button @click=\"processText\">提交并可视化</button>\r\n\r\n\t\t<div v-if=\"jsonData\">\r\n\t\t\t<h2>可视化结果</h2>\r\n\t\t\t<div ref=\"chart\"></div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport axios from \"axios\";\r\n\timport * as d3 from \"d3\";\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttext: \"\",\r\n\t\t\t\tjsonData: null\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync processText() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await axios.post(\"http://localhost:5000/process\", {\r\n\t\t\t\t\t\ttext: this.text\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.jsonData = JSON.parse(response.data.json_data);\r\n\t\t\t\t\tthis.renderChart();\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error(\"Error processing text:\", error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trenderChart() {\r\n\t\t\t\tconst chartType = this.jsonData.type;\r\n\t\t\t\tconst data = this.jsonData.data;\r\n\r\n\t\t\t\td3.select(this.$refs.chart).html(\"\"); // 清空图表\r\n\r\n\t\t\t\tif (chartType === \"trend\") {\r\n\t\t\t\t\tthis.renderLineChart(data);\r\n\t\t\t\t} else if (chartType === \"proportion\") {\r\n\t\t\t\t\tthis.renderPieChart(data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.renderBarChart(data);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trenderLineChart(data) {\r\n\t\t\t\tconst margin = { top: 20, right: 30, bottom: 30, left: 40 };\r\n\t\t\t\tconst width = 600 - margin.left - margin.right;\r\n\t\t\t\tconst height = 400 - margin.top - margin.bottom;\r\n\r\n\t\t\t\tconst svg = d3\r\n\t\t\t\t\t.select(this.$refs.chart)\r\n\t\t\t\t\t.append(\"svg\")\r\n\t\t\t\t\t.attr(\"width\", width + margin.left + margin.right)\r\n\t\t\t\t\t.attr(\"height\", height + margin.top + margin.bottom)\r\n\t\t\t\t\t.append(\"g\")\r\n\t\t\t\t\t.attr(\"transform\", `translate(${margin.left},${margin.top})`);\r\n\r\n\t\t\t\tconst x = d3\r\n\t\t\t\t\t.scaleLinear()\r\n\t\t\t\t\t.domain([0, data.length - 1])\r\n\t\t\t\t\t.range([0, width]);\r\n\t\t\t\tconst y = d3\r\n\t\t\t\t\t.scaleLinear()\r\n\t\t\t\t\t.domain([0, d3.max(data)])\r\n\t\t\t\t\t.range([height, 0]);\r\n\r\n\t\t\t\tsvg\r\n\t\t\t\t\t.append(\"path\")\r\n\t\t\t\t\t.datum(data)\r\n\t\t\t\t\t.attr(\"fill\", \"none\")\r\n\t\t\t\t\t.attr(\"stroke\", \"steelblue\")\r\n\t\t\t\t\t.attr(\"stroke-width\", 1.5)\r\n\t\t\t\t\t.attr(\r\n\t\t\t\t\t\t\"d\",\r\n\t\t\t\t\t\td3\r\n\t\t\t\t\t\t\t.line()\r\n\t\t\t\t\t\t\t.x((d, i) => x(i))\r\n\t\t\t\t\t\t\t.y(d => y(d))\r\n\t\t\t\t\t);\r\n\t\t\t},\r\n\t\t\trenderPieChart(data) {\r\n\t\t\t\tconst width = 400;\r\n\t\t\t\tconst height = 400;\r\n\t\t\t\tconst radius = Math.min(width, height) / 2;\r\n\r\n\t\t\t\tconst svg = d3\r\n\t\t\t\t\t.select(this.$refs.chart)\r\n\t\t\t\t\t.append(\"svg\")\r\n\t\t\t\t\t.attr(\"width\", width)\r\n\t\t\t\t\t.attr(\"height\", height)\r\n\t\t\t\t\t.append(\"g\")\r\n\t\t\t\t\t.attr(\"transform\", `translate(${width / 2},${height / 2})`);\r\n\r\n\t\t\t\tconst color = d3.scaleOrdinal(d3.schemeCategory10);\r\n\r\n\t\t\t\tconst pie = d3.pie().value(d => d.value);\r\n\t\t\t\tconst arc = d3.arc().innerRadius(0).outerRadius(radius);\r\n\r\n\t\t\t\tconst arcs = svg\r\n\t\t\t\t\t.selectAll(\"arc\")\r\n\t\t\t\t\t.data(pie(data))\r\n\t\t\t\t\t.enter()\r\n\t\t\t\t\t.append(\"g\")\r\n\t\t\t\t\t.attr(\"class\", \"arc\");\r\n\r\n\t\t\t\tarcs\r\n\t\t\t\t\t.append(\"path\")\r\n\t\t\t\t\t.attr(\"d\", arc)\r\n\t\t\t\t\t.attr(\"fill\", (d, i) => color(i));\r\n\r\n\t\t\t\tarcs\r\n\t\t\t\t\t.append(\"text\")\r\n\t\t\t\t\t.attr(\"transform\", d => `translate(${arc.centroid(d)})`)\r\n\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t\t.text(d => d.data.category);\r\n\t\t\t},\r\n\t\t\trenderBarChart(data) {\r\n\t\t\t\tconst margin = { top: 20, right: 30, bottom: 30, left: 40 };\r\n\t\t\t\tconst width = 600 - margin.left - margin.right;\r\n\t\t\t\tconst height = 400 - margin.top - margin.bottom;\r\n\r\n\t\t\t\tconst svg = d3\r\n\t\t\t\t\t.select(this.$refs.chart)\r\n\t\t\t\t\t.append(\"svg\")\r\n\t\t\t\t\t.attr(\"width\", width + margin.left + margin.right)\r\n\t\t\t\t\t.attr(\"height\", height + margin.top + margin.bottom)\r\n\t\t\t\t\t.append(\"g\")\r\n\t\t\t\t\t.attr(\"transform\", `translate(${margin.left},${margin.top})`);\r\n\r\n\t\t\t\tconst x = d3\r\n\t\t\t\t\t.scaleBand()\r\n\t\t\t\t\t.domain(data.map(d => d.category))\r\n\t\t\t\t\t.range([0, width])\r\n\t\t\t\t\t.padding(0.1);\r\n\t\t\t\tconst y = d3\r\n\t\t\t\t\t.scaleLinear()\r\n\t\t\t\t\t.domain([0, d3.max(data, d => d.value)])\r\n\t\t\t\t\t.range([height, 0]);\r\n\r\n\t\t\t\tsvg\r\n\t\t\t\t\t.selectAll(\"rect\")\r\n\t\t\t\t\t.data(data)\r\n\t\t\t\t\t.enter()\r\n\t\t\t\t\t.append(\"rect\")\r\n\t\t\t\t\t.attr(\"x\", d => x(d.category))\r\n\t\t\t\t\t.attr(\"y\", d => y(d.value))\r\n\t\t\t\t\t.attr(\"width\", x.bandwidth())\r\n\t\t\t\t\t.attr(\"height\", d => height - y(d.value))\r\n\t\t\t\t\t.attr(\"fill\", \"steelblue\");\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style>\r\n\t#app {\r\n\t\tfont-family: Avenir, Helvetica, Arial, sans-serif;\r\n\t\ttext-align: center;\r\n\t\tmargin-top: 60px;\r\n\t}\r\n\r\n\ttextarea {\r\n\t\twidth: 80%;\r\n\t\theight: 150px;\r\n\t\tmargin-bottom: 20px;\r\n\t}\r\n\r\n\tbutton {\r\n\t\tpadding: 10px 20px;\r\n\t\tfont-size: 16px;\r\n\t}\r\n</style>\r\n"],"mappings":";;EACMA,EAAE,EAAC;AAAK;gCACZC,mBAAA,CAAgB,YAAZ,SAAO;;EAFbC,GAAA;AAAA;gCAOGD,mBAAA,CAAc,YAAV,OAAK;;EACJE,GAAG,EAAC;AAAO;;uBAPlBC,mBAAA,CASM,OATNC,UASM,GARLC,UAAgB,E,gBAChBL,mBAAA,CAA0D;IAH5D,uBAAAM,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAGqBC,KAAA,CAAAC,IAAI,GAAAF,MAAA;IAAEG,WAAW,EAAC;iDAAlBF,KAAA,CAAAC,IAAI,E,GACvBT,mBAAA,CAA4C;IAAnCW,OAAK,EAAAL,MAAA,QAAAA,MAAA;MAAA,OAAEM,QAAA,CAAAC,WAAA,IAAAD,QAAA,CAAAC,WAAA,IAAAC,SAAA,CAAW;IAAA;KAAE,QAAM,GAExBN,KAAA,CAAAO,QAAQ,I,cAAnBZ,mBAAA,CAGM,OATRa,UAAA,GAOGC,UAAc,EACdjB,mBAAA,CAAuB,OAAvBkB,UAAuB,8B,KAR1BC,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}