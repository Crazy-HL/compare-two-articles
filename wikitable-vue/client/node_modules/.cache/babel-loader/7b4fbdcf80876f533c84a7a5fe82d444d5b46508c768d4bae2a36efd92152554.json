{"ast":null,"code":"(function (global) {\n  const MouseSelection = {\n    debounce(fn) {\n      let time = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;\n      let timeout = null;\n      return function () {\n        clearTimeout(timeout);\n        timeout = setTimeout(() => {\n          fn.apply(this, arguments);\n        }, time);\n      };\n    },\n    getSelectContent() {\n      const selection = window.getSelection();\n      if (selection) {\n        if (selection.isCollapsed) {\n          return selection.toString().trim().length ? {\n            type: 'text',\n            content: selection.toString().trim()\n          } : null;\n        }\n        const range = selection.getRangeAt(0);\n        const rangeClone = range.cloneContents();\n        if (rangeClone.childElementCount > 0) {\n          const container = document.createElement('div');\n          container.appendChild(rangeClone);\n          if (!selection.toString().trim().length) {\n            const hasSpNode = MouseSelection.getSpNode(container);\n            return hasSpNode ? {\n              type: 'html',\n              content: container.innerHTML\n            } : null;\n          }\n          return {\n            type: 'html',\n            content: container.innerHTML\n          };\n        } else {\n          return selection.toString().trim().length ? {\n            type: 'text',\n            content: selection.toString().trim()\n          } : null;\n        }\n      } else {\n        return null;\n      }\n    },\n    getSpNode(parent) {\n      const nodeNameList = ['iframe', 'svg', 'img', 'audio', 'video'];\n      const inpList = ['input', 'textarea', 'select'];\n      return Array.from(parent.children).some(node => {\n        if (nodeNameList.includes(node.nodeName.toLowerCase())) return true;\n        if (inpList.includes(node.nodeName.toLowerCase()) && node.value.trim().length) return true;\n        if (node.children) {\n          return MouseSelection.getSpNode(node);\n        }\n        return false;\n      });\n    },\n    selectionChangeFun(callback) {\n      const debounced = MouseSelection.debounce(callback, 500);\n      const selectContent = MouseSelection.getSelectContent();\n      if (selectContent) {\n        debounced(selectContent);\n      } else {\n        debounced(null);\n      }\n    },\n    // 启动选择功能，支持范围配置\n    start() {\n      let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      const {\n        rangeSelector\n      } = options; // 获取范围配置\n      const rangeElement = rangeSelector ? document.querySelector(rangeSelector) : document;\n      if (!rangeElement) {\n        console.error('Invalid range selector');\n        return;\n      }\n      let selectionchangeMouseTrack = false;\n\n      // 鼠标按下事件\n      rangeElement.addEventListener('mousedown', () => {\n        selectionchangeMouseTrack = true;\n      });\n\n      // 鼠标抬起事件\n      rangeElement.addEventListener('mouseup', MouseSelection.debounce(() => {\n        MouseSelection.selectionChangeFun(selectContent => {\n          if (selectContent) {\n            console.log('选中的内容:', selectContent);\n          } else {\n            console.log('没有选择内容');\n          }\n        });\n      }, 100));\n\n      // 选择区域发生变化时\n      rangeElement.addEventListener('selectionchange', MouseSelection.debounce(() => {\n        if (selectionchangeMouseTrack) return;\n        MouseSelection.selectionChangeFun(selectContent => {\n          if (selectContent) {\n            console.log('选中的内容:', selectContent);\n          } else {\n            console.log('没有选择内容');\n          }\n        });\n      }));\n\n      // 双击事件\n      rangeElement.addEventListener('dblclick', () => {\n        MouseSelection.selectionChangeFun(selectContent => {\n          if (selectContent) {\n            console.log('选中的内容:', selectContent);\n          } else {\n            console.log('没有选择内容');\n          }\n        });\n      });\n\n      // 右键事件\n      rangeElement.addEventListener('contextmenu', MouseSelection.debounce(() => {\n        MouseSelection.selectionChangeFun(selectContent => {\n          if (selectContent) {\n            console.log('选中的内容:', selectContent);\n          } else {\n            console.log('没有选择内容');\n          }\n        });\n      }, 100));\n    }\n  };\n\n  // 将 MouseSelection 注册到全局对象上\n  global.MouseSelection = MouseSelection;\n})(window);","map":{"version":3,"names":["global","MouseSelection","debounce","fn","time","arguments","length","undefined","timeout","clearTimeout","setTimeout","apply","getSelectContent","selection","window","getSelection","isCollapsed","toString","trim","type","content","range","getRangeAt","rangeClone","cloneContents","childElementCount","container","document","createElement","appendChild","hasSpNode","getSpNode","innerHTML","parent","nodeNameList","inpList","Array","from","children","some","node","includes","nodeName","toLowerCase","value","selectionChangeFun","callback","debounced","selectContent","start","options","rangeSelector","rangeElement","querySelector","console","error","selectionchangeMouseTrack","addEventListener","log"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/js/mouse_selection.js"],"sourcesContent":["(function (global) {\r\n  const MouseSelection = {\r\n    debounce(fn, time = 500) {\r\n      let timeout = null;\r\n      return function () {\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(() => {\r\n          fn.apply(this, arguments);\r\n        }, time);\r\n      };\r\n    },\r\n\r\n    getSelectContent() {\r\n      const selection = window.getSelection();\r\n      if (selection) {\r\n        if (selection.isCollapsed) {\r\n          return selection.toString().trim().length ? {\r\n            type: 'text',\r\n            content: selection.toString().trim()\r\n          } : null;\r\n        }\r\n\r\n        const range = selection.getRangeAt(0);\r\n        const rangeClone = range.cloneContents();\r\n        if (rangeClone.childElementCount > 0) {\r\n          const container = document.createElement('div');\r\n          container.appendChild(rangeClone);\r\n          if (!selection.toString().trim().length) {\r\n            const hasSpNode = MouseSelection.getSpNode(container);\r\n            return hasSpNode ? {\r\n              type: 'html',\r\n              content: container.innerHTML\r\n            } : null;\r\n          }\r\n          return {\r\n            type: 'html',\r\n            content: container.innerHTML\r\n          };\r\n        } else {\r\n          return selection.toString().trim().length ? {\r\n            type: 'text',\r\n            content: selection.toString().trim()\r\n          } : null;\r\n        }\r\n      } else {\r\n        return null;\r\n      }\r\n    },\r\n\r\n    getSpNode(parent) {\r\n      const nodeNameList = ['iframe', 'svg', 'img', 'audio', 'video'];\r\n      const inpList = ['input', 'textarea', 'select'];\r\n      return Array.from(parent.children).some((node) => {\r\n        if (nodeNameList.includes(node.nodeName.toLowerCase())) return true;\r\n        if (inpList.includes(node.nodeName.toLowerCase()) && node.value.trim().length) return true;\r\n        if (node.children) {\r\n          return MouseSelection.getSpNode(node);\r\n        }\r\n        return false;\r\n      });\r\n    },\r\n\r\n    selectionChangeFun(callback) {\r\n      const debounced = MouseSelection.debounce(callback, 500);\r\n      const selectContent = MouseSelection.getSelectContent();\r\n      if (selectContent) {\r\n        debounced(selectContent);\r\n      } else {\r\n        debounced(null);\r\n      }\r\n    },\r\n\r\n    // 启动选择功能，支持范围配置\r\n    start(options = {}) {\r\n      const { rangeSelector } = options; // 获取范围配置\r\n      const rangeElement = rangeSelector ? document.querySelector(rangeSelector) : document;\r\n\r\n      if (!rangeElement) {\r\n        console.error('Invalid range selector');\r\n        return;\r\n      }\r\n\r\n      let selectionchangeMouseTrack = false;\r\n\r\n      // 鼠标按下事件\r\n      rangeElement.addEventListener('mousedown', () => {\r\n        selectionchangeMouseTrack = true;\r\n      });\r\n\r\n      // 鼠标抬起事件\r\n      rangeElement.addEventListener('mouseup', MouseSelection.debounce(() => {\r\n        MouseSelection.selectionChangeFun((selectContent) => {\r\n          if (selectContent) {\r\n            console.log('选中的内容:', selectContent);\r\n          } else {\r\n            console.log('没有选择内容');\r\n          }\r\n        });\r\n      }, 100));\r\n\r\n      // 选择区域发生变化时\r\n      rangeElement.addEventListener('selectionchange', MouseSelection.debounce(() => {\r\n        if (selectionchangeMouseTrack) return;\r\n        MouseSelection.selectionChangeFun((selectContent) => {\r\n          if (selectContent) {\r\n            console.log('选中的内容:', selectContent);\r\n          } else {\r\n            console.log('没有选择内容');\r\n          }\r\n        });\r\n      }));\r\n\r\n      // 双击事件\r\n      rangeElement.addEventListener('dblclick', () => {\r\n        MouseSelection.selectionChangeFun((selectContent) => {\r\n          if (selectContent) {\r\n            console.log('选中的内容:', selectContent);\r\n          } else {\r\n            console.log('没有选择内容');\r\n          }\r\n        });\r\n      });\r\n\r\n      // 右键事件\r\n      rangeElement.addEventListener('contextmenu', MouseSelection.debounce(() => {\r\n        MouseSelection.selectionChangeFun((selectContent) => {\r\n          if (selectContent) {\r\n            console.log('选中的内容:', selectContent);\r\n          } else {\r\n            console.log('没有选择内容');\r\n          }\r\n        });\r\n      }, 100));\r\n    }\r\n  };\r\n\r\n  // 将 MouseSelection 注册到全局对象上\r\n  global.MouseSelection = MouseSelection;\r\n})(window);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}