{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-2e9e4c20\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"outline-window\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", null, \"大纲\", -1 /* HOISTED */));\nconst _hoisted_4 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 文章内容 \"), _createVNode($setup[\"ParentComponent\"], {\n    pageTitle: \"LeBron James\",\n    divId: \"div1\",\n    selectContentClass: \"custom-class\"\n  }), _createCommentVNode(\" 大纲视窗 \"), _createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.outline, chapter => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: chapter.id,\n      class: _normalizeClass({\n        active: $setup.activeChapter === chapter.id\n      }),\n      onClick: $event => $setup.scrollToChapter(chapter.id)\n    }, _toDisplayString(chapter.text), 11 /* TEXT, CLASS, PROPS */, _hoisted_4);\n  }), 128 /* KEYED_FRAGMENT */))])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_createCommentVNode","_createVNode","$setup","pageTitle","divId","selectContentClass","_hoisted_2","_hoisted_3","_Fragment","_renderList","outline","chapter","key","id","_normalizeClass","active","activeChapter","onClick","$event","scrollToChapter","text","_hoisted_4"],"sources":["D:\\vue_frame\\vue_frame\\wikitable-vue\\client\\src\\components\\Div1.vue"],"sourcesContent":["<template>\r\n\t<div class=\"container\">\r\n\t\t<!-- 文章内容 -->\r\n\t\t<ParentComponent\r\n\t\t\tpageTitle=\"LeBron James\"\r\n\t\t\tdivId=\"div1\"\r\n\t\t\tselectContentClass=\"custom-class\" />\r\n\r\n\t\t<!-- 大纲视窗 -->\r\n\t\t<div class=\"outline-window\">\r\n\t\t\t<h3>大纲</h3>\r\n\t\t\t<ul>\r\n\t\t\t\t<li\r\n\t\t\t\t\tv-for=\"chapter in outline\"\r\n\t\t\t\t\t:key=\"chapter.id\"\r\n\t\t\t\t\t:class=\"{ active: activeChapter === chapter.id }\"\r\n\t\t\t\t\t@click=\"scrollToChapter(chapter.id)\">\r\n\t\t\t\t\t{{ chapter.text }}\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted } from \"vue\";\r\n\timport ParentComponent from \"@/components/compoents_base/ParentComponent.vue\";\r\n\timport bus from \"@/js/eventBus.js\";\r\n\r\n\tconst outline = ref([]); // 存储大纲\r\n\tconst activeChapter = ref(null); // 当前活动的章节\r\n\r\n\t// 提取大纲\r\n\tconst extractOutline = htmlContent => {\r\n\t\tconst parser = new DOMParser();\r\n\t\tconst doc = parser.parseFromString(htmlContent, \"text/html\");\r\n\t\tconst headings = doc.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\r\n\t\tconst chapters = Array.from(headings).map(heading => {\r\n\t\t\tconst id = heading.textContent\r\n\t\t\t\t.trim()\r\n\t\t\t\t.toLowerCase()\r\n\t\t\t\t.replace(/[^a-z0-9]+/g, \"-\")\r\n\t\t\t\t.replace(/^-+|-+$/g, \"\");\r\n\r\n\t\t\tif (!heading.id) {\r\n\t\t\t\theading.id = id;\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: heading.id,\r\n\t\t\t\ttext: heading.textContent.trim(),\r\n\t\t\t\tlevel: parseInt(heading.tagName.replace(\"H\", \"\"), 10)\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn chapters;\r\n\t};\r\n\r\n\t// 滚动到指定章节\r\n\tconst scrollToChapter = chapterId => {\r\n\t\tconst escapedId = CSS.escape(chapterId);\r\n\t\tconst chapterElement = document.querySelector(`#${escapedId}`);\r\n\t\tif (chapterElement) {\r\n\t\t\tchapterElement.scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\tactiveChapter.value = chapterId;\r\n\t\t\tbus.emit(\"syncOutline\", { chapterId, source: \"div1\" });\r\n\t\t}\r\n\t};\r\n\r\n\t// 监听文章内容加载完成\r\n\tonMounted(() => {\r\n\t\tbus.on(\"contentLoaded\", data => {\r\n\t\t\tif (data.divId === \"div1\") {\r\n\t\t\t\toutline.value = extractOutline(data.content);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t// 监听大纲同步事件\r\n\tonMounted(() => {\r\n\t\tbus.on(\"syncOutline\", data => {\r\n\t\t\tif (data.source !== \"div1\") {\r\n\t\t\t\tscrollToChapter(data.chapterId);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\tonUnmounted(() => {\r\n\t\tbus.off(\"contentLoaded\");\r\n\t\tbus.off(\"syncOutline\");\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.container {\r\n\t\tposition: relative;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.outline-window {\r\n\t\tposition: fixed;\r\n\t\ttop: 20px;\r\n\t\tright: 20px;\r\n\t\twidth: 250px;\r\n\t\tmax-height: 80vh;\r\n\t\toverflow-y: auto;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder: 1px solid #e0e0e0;\r\n\t\tborder-radius: 8px;\r\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n\t\tpadding: 16px;\r\n\t\tz-index: 1000;\r\n\t}\r\n\r\n\t.outline-window h3 {\r\n\t\tmargin-bottom: 12px;\r\n\t\tfont-size: 16px;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.outline-window ul {\r\n\t\tlist-style: none;\r\n\t\tpadding: 0;\r\n\t\tmargin: 0;\r\n\t}\r\n\r\n\t.outline-window li {\r\n\t\tmargin-bottom: 8px;\r\n\t\tcursor: pointer;\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.outline-window li:hover {\r\n\t\tcolor: #0077b6;\r\n\t}\r\n\r\n\t.outline-window li.active {\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #0077b6;\r\n\t}\r\n</style>\r\n"],"mappings":";;;EACMA,KAAK,EAAC;AAAW;;EAQhBA,KAAK,EAAC;AAAgB;gEAC1BC,mBAAA,CAAW,YAAP,IAAE;mBAVT;;uBACCC,mBAAA,CAoBM,OApBNC,UAoBM,GAnBLC,mBAAA,UAAa,EACbC,YAAA,CAGqCC,MAAA;IAFpCC,SAAS,EAAC,cAAc;IACxBC,KAAK,EAAC,MAAM;IACZC,kBAAkB,EAAC;MAEpBL,mBAAA,UAAa,EACbH,mBAAA,CAWM,OAXNS,UAWM,GAVLC,UAAW,EACXV,mBAAA,CAQK,c,kBAPJC,mBAAA,CAMKU,SAAA,QAlBTC,WAAA,CAauBP,MAAA,CAAAQ,OAAO,EAAlBC,OAAO;yBADfb,mBAAA,CAMK;MAJHc,GAAG,EAAED,OAAO,CAACE,EAAE;MACfjB,KAAK,EAfXkB,eAAA;QAAAC,MAAA,EAeuBb,MAAA,CAAAc,aAAa,KAAKL,OAAO,CAACE;MAAE;MAC7CI,OAAK,EAAAC,MAAA,IAAEhB,MAAA,CAAAiB,eAAe,CAACR,OAAO,CAACE,EAAE;wBAC/BF,OAAO,CAACS,IAAI,gCAjBpBC,UAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}