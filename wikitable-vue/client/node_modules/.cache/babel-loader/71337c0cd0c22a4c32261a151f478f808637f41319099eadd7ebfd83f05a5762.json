{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-ea6f3360\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"comparison-table\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"table-title\"\n};\nconst _hoisted_3 = {\n  class: \"table-grid\"\n};\nconst _hoisted_4 = {\n  class: \"header left-column\"\n};\nconst _hoisted_5 = {\n  class: \"header middle-column\"\n};\nconst _hoisted_6 = {\n  class: \"header right-column\"\n};\nconst _hoisted_7 = {\n  class: \"cell left-column\"\n};\nconst _hoisted_8 = {\n  key: 1,\n  class: \"empty-placeholder\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  class: \"cell right-column\"\n};\nconst _hoisted_11 = {\n  key: 1,\n  class: \"empty-placeholder\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 表格标题 \"), $props.title ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString($props.title), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 表格主体 \"), _createElementVNode(\"div\", _hoisted_3, [_createCommentVNode(\" 表头 \"), _createElementVNode(\"div\", _hoisted_4, _toDisplayString($props.leftHeader), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_5, _toDisplayString($props.middleHeader), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, _toDisplayString($props.rightHeader), 1 /* TEXT */), _createCommentVNode(\" 动态生成行 \"), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.displayAttributes, (attr, index) => {\n    return _openBlock(), _createElementBlock(_Fragment, {\n      key: index\n    }, [_createCommentVNode(\" 左侧图表 \"), _createElementVNode(\"div\", _hoisted_7, [attr ? (_openBlock(), _createElementBlock(\"div\", {\n      key: 0,\n      class: \"chart-container\",\n      ref_for: true,\n      ref: el => $setup.setChartRef(el, index, 'left')\n    }, null, 512 /* NEED_PATCH */)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"-\"))]), _createCommentVNode(\" 中间属性 \"), _createElementVNode(\"div\", {\n      class: _normalizeClass([\"cell middle-column attribute-cell\", {\n        active: $setup.selectedIndex === index\n      }]),\n      onClick: $event => $setup.selectRow(index)\n    }, _toDisplayString(attr || $props.emptyPlaceholder), 11 /* TEXT, CLASS, PROPS */, _hoisted_9), _createCommentVNode(\" 右侧图表 \"), _createElementVNode(\"div\", _hoisted_10, [attr ? (_openBlock(), _createElementBlock(\"div\", {\n      key: 0,\n      class: \"chart-container\",\n      ref_for: true,\n      ref: el => $setup.setChartRef(el, index, 'right')\n    }, null, 512 /* NEED_PATCH */)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, \"-\"))])], 64 /* STABLE_FRAGMENT */);\n  }), 128 /* KEYED_FRAGMENT */))])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createCommentVNode","$props","title","_hoisted_2","_toDisplayString","_createElementVNode","_hoisted_3","_hoisted_4","leftHeader","_hoisted_5","middleHeader","_hoisted_6","rightHeader","_Fragment","_renderList","$setup","displayAttributes","attr","index","_hoisted_7","ref_for","ref","el","setChartRef","_hoisted_8","_normalizeClass","active","selectedIndex","onClick","$event","selectRow","emptyPlaceholder","_hoisted_9","_hoisted_10","_hoisted_11"],"sources":["D:\\vue_frame\\vue_frame\\wikitable-vue\\client\\src\\components\\compoents_base\\CompareTable.vue"],"sourcesContent":["<template>\r\n\t<div class=\"comparison-table\">\r\n\t\t<!-- 表格标题 -->\r\n\t\t<div class=\"table-title\" v-if=\"title\">{{ title }}</div>\r\n\r\n\t\t<!-- 表格主体 -->\r\n\t\t<div class=\"table-grid\">\r\n\t\t\t<!-- 表头 -->\r\n\t\t\t<div class=\"header left-column\">{{ leftHeader }}</div>\r\n\t\t\t<div class=\"header middle-column\">{{ middleHeader }}</div>\r\n\t\t\t<div class=\"header right-column\">{{ rightHeader }}</div>\r\n\r\n\t\t\t<!-- 动态生成行 -->\r\n\t\t\t<template v-for=\"(attr, index) in displayAttributes\" :key=\"index\">\r\n\t\t\t\t<!-- 左侧图表 -->\r\n\t\t\t\t<div class=\"cell left-column\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tv-if=\"attr\"\r\n\t\t\t\t\t\tclass=\"chart-container\"\r\n\t\t\t\t\t\t:ref=\"el => setChartRef(el, index, 'left')\"></div>\r\n\t\t\t\t\t<div v-else class=\"empty-placeholder\">-</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<!-- 中间属性 -->\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"cell middle-column attribute-cell\"\r\n\t\t\t\t\t:class=\"{ active: selectedIndex === index }\"\r\n\t\t\t\t\t@click=\"selectRow(index)\">\r\n\t\t\t\t\t{{ attr || emptyPlaceholder }}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<!-- 右侧图表 -->\r\n\t\t\t\t<div class=\"cell right-column\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tv-if=\"attr\"\r\n\t\t\t\t\t\tclass=\"chart-container\"\r\n\t\t\t\t\t\t:ref=\"el => setChartRef(el, index, 'right')\"></div>\r\n\t\t\t\t\t<div v-else class=\"empty-placeholder\">-</div>\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport { ref, watch, nextTick } from \"vue\";\r\n\timport * as d3 from \"d3\";\r\n\timport {\r\n\t\trenderLineChart,\r\n\t\trenderBarChart,\r\n\t\trenderPieChart\r\n\t} from \"@/js/chartUtils\";\r\n\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\ttitle: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"数据对比\"\r\n\t\t\t},\r\n\t\t\tleftHeader: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"表格1\"\r\n\t\t\t},\r\n\t\t\tmiddleHeader: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"公共属性\"\r\n\t\t\t},\r\n\t\t\trightHeader: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"表格2\"\r\n\t\t\t},\r\n\t\t\ttableData1: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: () => ({})\r\n\t\t\t},\r\n\t\t\ttableData2: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: () => ({})\r\n\t\t\t},\r\n\t\t\temptyPlaceholder: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"无数据\"\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\temits: [\"row-selected\"],\r\n\r\n\t\tsetup(props, { emit }) {\r\n\t\t\tconst selectedIndex = ref(-1);\r\n\t\t\tconst commonAttributes = ref([]);\r\n\t\t\tconst displayAttributes = ref(Array(2).fill(null)); // 默认显示2行\r\n\t\t\tconst chartRefs = ref({ left: [], right: [] });\r\n\r\n\t\t\t// 提取公共属性\r\n\t\t\tconst extractCommonAttributes = () => {\r\n\t\t\t\tif (!props.tableData1 || !props.tableData2) return [];\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst attrs1 = Object.keys(props.tableData1);\r\n\t\t\t\t\tconst attrs2 = Object.keys(props.tableData2);\r\n\t\t\t\t\treturn attrs1.filter(attr => attrs2.includes(attr));\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error(\"提取公共属性失败:\", error);\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 渲染图表\r\n\t\t\tconst renderCharts = () => {\r\n\t\t\t\tnextTick(() => {\r\n\t\t\t\t\tcommonAttributes.value.forEach((attr, index) => {\r\n\t\t\t\t\t\t// 渲染左侧图表\r\n\t\t\t\t\t\tif (chartRefs.value.left[index] && props.tableData1[attr]) {\r\n\t\t\t\t\t\t\trenderChart(\r\n\t\t\t\t\t\t\t\tchartRefs.value.left[index],\r\n\t\t\t\t\t\t\t\tprops.tableData1[attr],\r\n\t\t\t\t\t\t\t\t\"left\"\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 渲染右侧图表\r\n\t\t\t\t\t\tif (chartRefs.value.right[index] && props.tableData2[attr]) {\r\n\t\t\t\t\t\t\trenderChart(\r\n\t\t\t\t\t\t\t\tchartRefs.value.right[index],\r\n\t\t\t\t\t\t\t\tprops.tableData2[attr],\r\n\t\t\t\t\t\t\t\t\"right\"\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 统一图表渲染方法\r\n\t\t\tconst renderChart = (container, data, side) => {\r\n\t\t\t\tif (!container || !data) return;\r\n\r\n\t\t\t\t// 根据数据类型自动选择图表类型\r\n\t\t\t\tlet chartType = \"Bar Chart\";\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\tchartType = data[0]?.value !== undefined ? \"Bar Chart\" : \"Line Chart\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch (chartType) {\r\n\t\t\t\t\tcase \"Line Chart\":\r\n\t\t\t\t\t\trenderLineChart(container, data);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Bar Chart\":\r\n\t\t\t\t\t\trenderBarChart(container, data);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Pie Chart\":\r\n\t\t\t\t\t\trenderPieChart(container, data);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\trenderBarChart(container, data);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 设置图表引用\r\n\t\t\tconst setChartRef = (el, index, type) => {\r\n\t\t\t\tif (el) {\r\n\t\t\t\t\tchartRefs.value[type][index] = el;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 选择行\r\n\t\t\tconst selectRow = index => {\r\n\t\t\t\tif (commonAttributes.value[index]) {\r\n\t\t\t\t\tselectedIndex.value = index;\r\n\t\t\t\t\temit(\"row-selected\", index);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 监听表格数据变化\r\n\t\t\twatch(\r\n\t\t\t\t() => [props.tableData1, props.tableData2],\r\n\t\t\t\t() => {\r\n\t\t\t\t\tcommonAttributes.value = extractCommonAttributes();\r\n\t\t\t\t\tdisplayAttributes.value = [\r\n\t\t\t\t\t\t...commonAttributes.value,\r\n\t\t\t\t\t\t...Array(2 - commonAttributes.value.length).fill(null)\r\n\t\t\t\t\t];\r\n\t\t\t\t\trenderCharts();\r\n\t\t\t\t},\r\n\t\t\t\t{ immediate: true, deep: true }\r\n\t\t\t);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tselectedIndex,\r\n\t\t\t\tcommonAttributes,\r\n\t\t\t\tdisplayAttributes,\r\n\t\t\t\tsetChartRef,\r\n\t\t\t\tselectRow\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.comparison-table {\r\n\t\twidth: 100%;\r\n\t\tbackground: white;\r\n\t\tborder-radius: 12px;\r\n\t\tbox-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.table-title {\r\n\t\tpadding: 16px 20px;\r\n\t\tfont-size: 18px;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #333;\r\n\t\tborder-bottom: 1px solid #f0f0f0;\r\n\t}\r\n\r\n\t.table-grid {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: 1fr 1fr 1fr;\r\n\t\tgrid-template-rows: auto repeat(2, 1fr);\r\n\t\tgap: 1px;\r\n\t\tbackground: #f0f0f0;\r\n\t}\r\n\r\n\t.header {\r\n\t\tpadding: 12px;\r\n\t\tbackground: #f8f9fa;\r\n\t\tfont-weight: 500;\r\n\t\ttext-align: center;\r\n\t\tcolor: #555;\r\n\t}\r\n\r\n\t.cell {\r\n\t\tpadding: 16px;\r\n\t\tbackground: white;\r\n\t\tmin-height: 120px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.left-column {\r\n\t\tborder-right: 1px solid #f0f0f0;\r\n\t}\r\n\r\n\t.right-column {\r\n\t\tborder-left: 1px solid #f0f0f0;\r\n\t}\r\n\r\n\t.attribute-cell {\r\n\t\tcursor: pointer;\r\n\t\tfont-weight: 500;\r\n\t\ttransition: all 0.2s;\r\n\t}\r\n\r\n\t.attribute-cell:hover {\r\n\t\tbackground: #f5f9ff;\r\n\t}\r\n\r\n\t.attribute-cell.active {\r\n\t\tbackground: #e6f0ff;\r\n\t\tcolor: #1976d2;\r\n\t}\r\n\r\n\t.chart-container {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-height: 100px;\r\n\t}\r\n\r\n\t.empty-placeholder {\r\n\t\tcolor: #999;\r\n\t\tfont-style: italic;\r\n\t}\r\n\r\n\t/* 响应式设计 */\r\n\t@media (max-width: 768px) {\r\n\t\t.table-grid {\r\n\t\t\tgrid-template-columns: 1fr;\r\n\t\t\tgrid-template-rows: auto repeat(6, auto);\r\n\t\t}\r\n\r\n\t\t.header {\r\n\t\t\tdisplay: none;\r\n\t\t}\r\n\r\n\t\t.left-column,\r\n\t\t.right-column {\r\n\t\t\tborder: none;\r\n\t\t\tborder-bottom: 1px solid #f0f0f0;\r\n\t\t}\r\n\t}\r\n</style>\r\n"],"mappings":";;;EACMA,KAAK,EAAC;AAAkB;;EAD9BC,GAAA;EAGOD,KAAK,EAAC;;;EAGNA,KAAK,EAAC;AAAY;;EAEjBA,KAAK,EAAC;AAAoB;;EAC1BA,KAAK,EAAC;AAAsB;;EAC5BA,KAAK,EAAC;AAAqB;;EAK1BA,KAAK,EAAC;AAAkB;;EAfjCC,GAAA;EAoBiBD,KAAK,EAAC;;mBApBvB;;EAgCSA,KAAK,EAAC;AAAmB;;EAhClCC,GAAA;EAqCiBD,KAAK,EAAC;;;uBApCtBE,mBAAA,CAwCM,OAxCNC,UAwCM,GAvCLC,mBAAA,UAAa,EACkBC,MAAA,CAAAC,KAAK,I,cAApCJ,mBAAA,CAAuD,OAAvDK,UAAuD,EAAAC,gBAAA,CAAdH,MAAA,CAAAC,KAAK,oBAHhDF,mBAAA,gBAKEA,mBAAA,UAAa,EACbK,mBAAA,CAkCM,OAlCNC,UAkCM,GAjCLN,mBAAA,QAAW,EACXK,mBAAA,CAAsD,OAAtDE,UAAsD,EAAAH,gBAAA,CAAnBH,MAAA,CAAAO,UAAU,kBAC7CH,mBAAA,CAA0D,OAA1DI,UAA0D,EAAAL,gBAAA,CAArBH,MAAA,CAAAS,YAAY,kBACjDL,mBAAA,CAAwD,OAAxDM,UAAwD,EAAAP,gBAAA,CAApBH,MAAA,CAAAW,WAAW,kBAE/CZ,mBAAA,WAAc,G,kBACdF,mBAAA,CA0BWe,SAAA,QAvCdC,WAAA,CAaqCC,MAAA,CAAAC,iBAAiB,EAbtD,CAaqBC,IAAI,EAAEC,KAAK;yBAbhCpB,mBAAA,CAAAe,SAAA;MAAAhB,GAAA,EAa8DqB;IAAK,IAC/DlB,mBAAA,UAAa,EACbK,mBAAA,CAMM,OANNc,UAMM,GAJEF,IAAI,I,cADXnB,mBAAA,CAGmD;MAnBxDD,GAAA;MAkBMD,KAAK,EAAC,iBAAiB;MAlB7BwB,OAAA;MAmBOC,GAAG,EAAEC,EAAE,IAAIP,MAAA,CAAAQ,WAAW,CAACD,EAAE,EAAEJ,KAAK;qDAClCpB,mBAAA,CAA6C,OAA7C0B,UAA6C,EAAP,GAAC,G,GAGxCxB,mBAAA,UAAa,EACbK,mBAAA,CAKM;MAJLT,KAAK,EAzBV6B,eAAA,EAyBW,mCAAmC;QAAAC,MAAA,EACvBX,MAAA,CAAAY,aAAa,KAAKT;MAAK;MACxCU,OAAK,EAAAC,MAAA,IAAEd,MAAA,CAAAe,SAAS,CAACZ,KAAK;wBACpBD,IAAI,IAAIhB,MAAA,CAAA8B,gBAAgB,gCA5BhCC,UAAA,GA+BIhC,mBAAA,UAAa,EACbK,mBAAA,CAMM,OANN4B,WAMM,GAJEhB,IAAI,I,cADXnB,mBAAA,CAGoD;MApCzDD,GAAA;MAmCMD,KAAK,EAAC,iBAAiB;MAnC7BwB,OAAA;MAoCOC,GAAG,EAAEC,EAAE,IAAIP,MAAA,CAAAQ,WAAW,CAACD,EAAE,EAAEJ,KAAK;qDAClCpB,mBAAA,CAA6C,OAA7CoC,WAA6C,EAAP,GAAC,G","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}