{"ast":null,"code":"import { ref, onMounted } from \"vue\";\nimport ParentComponent from \"@/components/compoents_base/ParentComponent.vue\";\nimport bus from \"@/js/eventBus.js\";\nexport default {\n  __name: 'Div3',\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const outline = ref([]); // 存储大纲\n    const activeChapter = ref(null); // 当前活动的章节\n\n    // 提取大纲\n    const extractOutline = htmlContent => {\n      const parser = new DOMParser();\n      const doc = parser.parseFromString(htmlContent, \"text/html\");\n      const headings = doc.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\n      const chapters = Array.from(headings).map(heading => {\n        const id = heading.textContent.trim().toLowerCase().replace(/[^a-z0-9]+/g, \"-\").replace(/^-+|-+$/g, \"\");\n        if (!heading.id) {\n          heading.id = id;\n        }\n        return {\n          id: heading.id,\n          text: heading.textContent.trim(),\n          level: parseInt(heading.tagName.replace(\"H\", \"\"), 10)\n        };\n      });\n      return chapters;\n    };\n\n    // 滚动到指定章节\n    const scrollToChapter = chapterId => {\n      const escapedId = CSS.escape(chapterId);\n      const chapterElement = document.querySelector(`#${escapedId}`);\n      if (chapterElement) {\n        chapterElement.scrollIntoView({\n          behavior: \"smooth\"\n        });\n        activeChapter.value = chapterId;\n        bus.emit(\"syncOutline\", {\n          chapterId,\n          source: \"div3\"\n        });\n      }\n    };\n\n    // 监听文章内容加载完成\n    onMounted(() => {\n      bus.on(\"contentLoaded\", data => {\n        if (data.divId === \"div3\") {\n          outline.value = extractOutline(data.content);\n        }\n      });\n    });\n\n    // 监听大纲同步事件\n    onMounted(() => {\n      bus.on(\"syncOutline\", data => {\n        if (data.source !== \"div3\") {\n          scrollToChapter(data.chapterId);\n        }\n      });\n    });\n    onUnmounted(() => {\n      bus.off(\"contentLoaded\");\n      bus.off(\"syncOutline\");\n    });\n    const __returned__ = {\n      outline,\n      activeChapter,\n      extractOutline,\n      scrollToChapter,\n      ref,\n      onMounted,\n      ParentComponent,\n      get bus() {\n        return bus;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","ParentComponent","bus","outline","activeChapter","extractOutline","htmlContent","parser","DOMParser","doc","parseFromString","headings","querySelectorAll","chapters","Array","from","map","heading","id","textContent","trim","toLowerCase","replace","text","level","parseInt","tagName","scrollToChapter","chapterId","escapedId","CSS","escape","chapterElement","document","querySelector","scrollIntoView","behavior","value","emit","source","on","data","divId","content","onUnmounted","off"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/Div3.vue"],"sourcesContent":["<template>\r\n\t<div class=\"container\">\r\n\t\t<!-- 文章内容 -->\r\n\t\t<ParentComponent\r\n\t\t\tpageTitle=\"Jimmer Fredette\"\r\n\t\t\tdivId=\"div3\"\r\n\t\t\tselectContentClass=\"selectContent2\" />\r\n\r\n\t\t<!-- 大纲视窗 -->\r\n\t\t<div class=\"outline-window\">\r\n\t\t\t<h3>大纲</h3>\r\n\t\t\t<ul>\r\n\t\t\t\t<li\r\n\t\t\t\t\tv-for=\"chapter in outline\"\r\n\t\t\t\t\t:key=\"chapter.id\"\r\n\t\t\t\t\t:class=\"{ active: activeChapter === chapter.id }\"\r\n\t\t\t\t\t@click=\"scrollToChapter(chapter.id)\">\r\n\t\t\t\t\t{{ chapter.text }}\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted } from \"vue\";\r\n\timport ParentComponent from \"@/components/compoents_base/ParentComponent.vue\";\r\n\timport bus from \"@/js/eventBus.js\";\r\n\r\n\tconst outline = ref([]); // 存储大纲\r\n\tconst activeChapter = ref(null); // 当前活动的章节\r\n\r\n\t// 提取大纲\r\n\tconst extractOutline = htmlContent => {\r\n\t\tconst parser = new DOMParser();\r\n\t\tconst doc = parser.parseFromString(htmlContent, \"text/html\");\r\n\t\tconst headings = doc.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\r\n\t\tconst chapters = Array.from(headings).map(heading => {\r\n\t\t\tconst id = heading.textContent\r\n\t\t\t\t.trim()\r\n\t\t\t\t.toLowerCase()\r\n\t\t\t\t.replace(/[^a-z0-9]+/g, \"-\")\r\n\t\t\t\t.replace(/^-+|-+$/g, \"\");\r\n\r\n\t\t\tif (!heading.id) {\r\n\t\t\t\theading.id = id;\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: heading.id,\r\n\t\t\t\ttext: heading.textContent.trim(),\r\n\t\t\t\tlevel: parseInt(heading.tagName.replace(\"H\", \"\"), 10)\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn chapters;\r\n\t};\r\n\r\n\t// 滚动到指定章节\r\n\tconst scrollToChapter = chapterId => {\r\n\t\tconst escapedId = CSS.escape(chapterId);\r\n\t\tconst chapterElement = document.querySelector(`#${escapedId}`);\r\n\t\tif (chapterElement) {\r\n\t\t\tchapterElement.scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\tactiveChapter.value = chapterId;\r\n\t\t\tbus.emit(\"syncOutline\", { chapterId, source: \"div3\" });\r\n\t\t}\r\n\t};\r\n\r\n\t// 监听文章内容加载完成\r\n\tonMounted(() => {\r\n\t\tbus.on(\"contentLoaded\", data => {\r\n\t\t\tif (data.divId === \"div3\") {\r\n\t\t\t\toutline.value = extractOutline(data.content);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t// 监听大纲同步事件\r\n\tonMounted(() => {\r\n\t\tbus.on(\"syncOutline\", data => {\r\n\t\t\tif (data.source !== \"div3\") {\r\n\t\t\t\tscrollToChapter(data.chapterId);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\tonUnmounted(() => {\r\n\t\tbus.off(\"contentLoaded\");\r\n\t\tbus.off(\"syncOutline\");\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.container {\r\n\t\tposition: relative;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.outline-window {\r\n\t\tposition: fixed;\r\n\t\ttop: 20px;\r\n\t\tright: 20px;\r\n\t\twidth: 250px;\r\n\t\tmax-height: 80vh;\r\n\t\toverflow-y: auto;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder: 1px solid #e0e0e0;\r\n\t\tborder-radius: 8px;\r\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n\t\tpadding: 16px;\r\n\t\tz-index: 1000;\r\n\t}\r\n\r\n\t.outline-window h3 {\r\n\t\tmargin-bottom: 12px;\r\n\t\tfont-size: 16px;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.outline-window ul {\r\n\t\tlist-style: none;\r\n\t\tpadding: 0;\r\n\t\tmargin: 0;\r\n\t}\r\n\r\n\t.outline-window li {\r\n\t\tmargin-bottom: 8px;\r\n\t\tcursor: pointer;\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.outline-window li:hover {\r\n\t\tcolor: #0077b6;\r\n\t}\r\n\r\n\t.outline-window li.active {\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #0077b6;\r\n\t}\r\n</style>\r\n"],"mappings":"AAyBC,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,eAAe,MAAM,iDAAiD;AAC7E,OAAOC,GAAG,MAAM,kBAAkB;;;;;;;;IAElC,MAAMC,OAAO,GAAGJ,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IACzB,MAAMK,aAAa,GAAGL,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;;IAEjC;IACA,MAAMM,cAAc,GAAGC,WAAW,IAAI;MACrC,MAAMC,MAAM,GAAG,IAAIC,SAAS,CAAC,CAAC;MAC9B,MAAMC,GAAG,GAAGF,MAAM,CAACG,eAAe,CAACJ,WAAW,EAAE,WAAW,CAAC;MAC5D,MAAMK,QAAQ,GAAGF,GAAG,CAACG,gBAAgB,CAAC,wBAAwB,CAAC;MAC/D,MAAMC,QAAQ,GAAGC,KAAK,CAACC,IAAI,CAACJ,QAAQ,CAAC,CAACK,GAAG,CAACC,OAAO,IAAI;QACpD,MAAMC,EAAE,GAAGD,OAAO,CAACE,WAAW,CAC5BC,IAAI,CAAC,CAAC,CACNC,WAAW,CAAC,CAAC,CACbC,OAAO,CAAC,aAAa,EAAE,GAAG,CAAC,CAC3BA,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;QAEzB,IAAI,CAACL,OAAO,CAACC,EAAE,EAAE;UAChBD,OAAO,CAACC,EAAE,GAAGA,EAAE;QAChB;QAEA,OAAO;UACNA,EAAE,EAAED,OAAO,CAACC,EAAE;UACdK,IAAI,EAAEN,OAAO,CAACE,WAAW,CAACC,IAAI,CAAC,CAAC;UAChCI,KAAK,EAAEC,QAAQ,CAACR,OAAO,CAACS,OAAO,CAACJ,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE;QACrD,CAAC;MACF,CAAC,CAAC;MACF,OAAOT,QAAQ;IAChB,CAAC;;IAED;IACA,MAAMc,eAAe,GAAGC,SAAS,IAAI;MACpC,MAAMC,SAAS,GAAGC,GAAG,CAACC,MAAM,CAACH,SAAS,CAAC;MACvC,MAAMI,cAAc,GAAGC,QAAQ,CAACC,aAAa,CAAC,IAAIL,SAAS,EAAE,CAAC;MAC9D,IAAIG,cAAc,EAAE;QACnBA,cAAc,CAACG,cAAc,CAAC;UAAEC,QAAQ,EAAE;QAAS,CAAC,CAAC;QACrDhC,aAAa,CAACiC,KAAK,GAAGT,SAAS;QAC/B1B,GAAG,CAACoC,IAAI,CAAC,aAAa,EAAE;UAAEV,SAAS;UAAEW,MAAM,EAAE;QAAO,CAAC,CAAC;MACvD;IACD,CAAC;;IAED;IACAvC,SAAS,CAAC,MAAM;MACfE,GAAG,CAACsC,EAAE,CAAC,eAAe,EAAEC,IAAI,IAAI;QAC/B,IAAIA,IAAI,CAACC,KAAK,KAAK,MAAM,EAAE;UAC1BvC,OAAO,CAACkC,KAAK,GAAGhC,cAAc,CAACoC,IAAI,CAACE,OAAO,CAAC;QAC7C;MACD,CAAC,CAAC;IACH,CAAC,CAAC;;IAEF;IACA3C,SAAS,CAAC,MAAM;MACfE,GAAG,CAACsC,EAAE,CAAC,aAAa,EAAEC,IAAI,IAAI;QAC7B,IAAIA,IAAI,CAACF,MAAM,KAAK,MAAM,EAAE;UAC3BZ,eAAe,CAACc,IAAI,CAACb,SAAS,CAAC;QAChC;MACD,CAAC,CAAC;IACH,CAAC,CAAC;IAEFgB,WAAW,CAAC,MAAM;MACjB1C,GAAG,CAAC2C,GAAG,CAAC,eAAe,CAAC;MACxB3C,GAAG,CAAC2C,GAAG,CAAC,aAAa,CAAC;IACvB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}