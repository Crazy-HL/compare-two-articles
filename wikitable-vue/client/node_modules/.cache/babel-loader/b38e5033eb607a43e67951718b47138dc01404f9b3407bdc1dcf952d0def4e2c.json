{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, onMounted, watch } from \"vue\";\nimport * as echarts from \"echarts\";\nexport default {\n  __name: 'BarChart',\n  props: {\n    data: {\n      type: Array,\n      default: () => []\n    },\n    yRange: {\n      type: Array,\n      default: () => [0, 100]\n    },\n    compareData: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n    const chartEl = ref(null);\n    let chartInstance = null;\n    const initChart = () => {\n      if (!chartEl.value) return;\n      chartInstance = echarts.init(chartEl.value);\n\n      // 计算数据的最大值\n      const allData = [...props.data, ...props.compareData];\n      const maxValue = Math.max(...allData.map(item => item.value), 100); // 确保最小值为100\n\n      const series = [{\n        name: \"当前数据\",\n        type: \"bar\",\n        barWidth: \"40%\",\n        data: props.data.map(item => item.value),\n        itemStyle: {\n          color: \"#3498db\"\n        }\n      }];\n\n      // 如果有对比数据\n      if (props.compareData && props.compareData.length > 0) {\n        series.push({\n          name: \"对比数据\",\n          type: \"bar\",\n          barWidth: \"40%\",\n          data: props.compareData.map(item => item.value),\n          itemStyle: {\n            color: \"#e74c3c\"\n          }\n        });\n      }\n      const option = {\n        tooltip: {\n          trigger: \"axis\",\n          axisPointer: {\n            type: \"shadow\"\n          }\n        },\n        grid: {\n          left: \"3%\",\n          right: \"4%\",\n          bottom: \"3%\",\n          containLabel: true\n        },\n        xAxis: {\n          type: \"category\",\n          data: props.data.map(item => item.name)\n        },\n        yAxis: {\n          type: \"value\",\n          min: 0,\n          max: maxValue // 使用计算的最大值\n        },\n        series\n      };\n      chartInstance.setOption(option);\n    };\n    onMounted(() => {\n      initChart();\n      window.addEventListener(\"resize\", () => chartInstance?.resize());\n    });\n    watch(() => [props.data, props.compareData, props.yRange], () => {\n      if (chartInstance) {\n        initChart();\n      }\n    }, {\n      deep: true\n    });\n    const __returned__ = {\n      props,\n      chartEl,\n      get chartInstance() {\n        return chartInstance;\n      },\n      set chartInstance(v) {\n        chartInstance = v;\n      },\n      initChart,\n      ref,\n      onMounted,\n      watch,\n      get echarts() {\n        return echarts;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","watch","echarts","props","__props","chartEl","chartInstance","initChart","value","init","allData","data","compareData","maxValue","Math","max","map","item","series","name","type","barWidth","itemStyle","color","length","push","option","tooltip","trigger","axisPointer","grid","left","right","bottom","containLabel","xAxis","yAxis","min","setOption","window","addEventListener","resize","yRange","deep"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/compoents_base/charts/BarChart.vue"],"sourcesContent":["<template>\r\n\t<div ref=\"chartEl\" class=\"bar-chart\"></div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted, watch } from \"vue\";\r\n\timport * as echarts from \"echarts\";\r\n\r\n\tconst props = defineProps({\r\n\t\tdata: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => []\r\n\t\t},\r\n\t\tyRange: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => [0, 100]\r\n\t\t},\r\n\t\tcompareData: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => []\r\n\t\t}\r\n\t});\r\n\r\n\tconst chartEl = ref(null);\r\n\tlet chartInstance = null;\r\n\r\n\tconst initChart = () => {\r\n\t\tif (!chartEl.value) return;\r\n\r\n\t\tchartInstance = echarts.init(chartEl.value);\r\n\r\n\t\t// 计算数据的最大值\r\n\t\tconst allData = [...props.data, ...props.compareData];\r\n\t\tconst maxValue = Math.max(...allData.map(item => item.value), 100); // 确保最小值为100\r\n\r\n\t\tconst series = [\r\n\t\t\t{\r\n\t\t\t\tname: \"当前数据\",\r\n\t\t\t\ttype: \"bar\",\r\n\t\t\t\tbarWidth: \"40%\",\r\n\t\t\t\tdata: props.data.map(item => item.value),\r\n\t\t\t\titemStyle: {\r\n\t\t\t\t\tcolor: \"#3498db\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\t// 如果有对比数据\r\n\t\tif (props.compareData && props.compareData.length > 0) {\r\n\t\t\tseries.push({\r\n\t\t\t\tname: \"对比数据\",\r\n\t\t\t\ttype: \"bar\",\r\n\t\t\t\tbarWidth: \"40%\",\r\n\t\t\t\tdata: props.compareData.map(item => item.value),\r\n\t\t\t\titemStyle: {\r\n\t\t\t\t\tcolor: \"#e74c3c\"\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst option = {\r\n\t\t\ttooltip: {\r\n\t\t\t\ttrigger: \"axis\",\r\n\t\t\t\taxisPointer: {\r\n\t\t\t\t\ttype: \"shadow\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgrid: {\r\n\t\t\t\tleft: \"3%\",\r\n\t\t\t\tright: \"4%\",\r\n\t\t\t\tbottom: \"3%\",\r\n\t\t\t\tcontainLabel: true\r\n\t\t\t},\r\n\t\t\txAxis: {\r\n\t\t\t\ttype: \"category\",\r\n\t\t\t\tdata: props.data.map(item => item.name)\r\n\t\t\t},\r\n\t\t\tyAxis: {\r\n\t\t\t\ttype: \"value\",\r\n\t\t\t\tmin: 0,\r\n\t\t\t\tmax: maxValue // 使用计算的最大值\r\n\t\t\t},\r\n\t\t\tseries\r\n\t\t};\r\n\r\n\t\tchartInstance.setOption(option);\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tinitChart();\r\n\t\twindow.addEventListener(\"resize\", () => chartInstance?.resize());\r\n\t});\r\n\r\n\twatch(\r\n\t\t() => [props.data, props.compareData, props.yRange],\r\n\t\t() => {\r\n\t\t\tif (chartInstance) {\r\n\t\t\t\tinitChart();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{ deep: true }\r\n\t);\r\n</script>\r\n\r\n<style scoped>\r\n\t.bar-chart {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-height: 150px;\r\n\t}\r\n</style>\r\n"],"mappings":";AAKC,SAASA,GAAG,EAAEC,SAAS,EAAEC,KAAK,QAAQ,KAAK;AAC3C,OAAO,KAAKC,OAAO,MAAM,SAAS;;;;;;;;;;;;;;;;;;;;;;IAElC,MAAMC,KAAK,GAAGC,OAaZ;IAEF,MAAMC,OAAO,GAAGN,GAAG,CAAC,IAAI,CAAC;IACzB,IAAIO,aAAa,GAAG,IAAI;IAExB,MAAMC,SAAS,GAAGA,CAAA,KAAM;MACvB,IAAI,CAACF,OAAO,CAACG,KAAK,EAAE;MAEpBF,aAAa,GAAGJ,OAAO,CAACO,IAAI,CAACJ,OAAO,CAACG,KAAK,CAAC;;MAE3C;MACA,MAAME,OAAO,GAAG,CAAC,GAAGP,KAAK,CAACQ,IAAI,EAAE,GAAGR,KAAK,CAACS,WAAW,CAAC;MACrD,MAAMC,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAAC,GAAGL,OAAO,CAACM,GAAG,CAACC,IAAI,IAAIA,IAAI,CAACT,KAAK,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;;MAEpE,MAAMU,MAAM,GAAG,CACd;QACCC,IAAI,EAAE,MAAM;QACZC,IAAI,EAAE,KAAK;QACXC,QAAQ,EAAE,KAAK;QACfV,IAAI,EAAER,KAAK,CAACQ,IAAI,CAACK,GAAG,CAACC,IAAI,IAAIA,IAAI,CAACT,KAAK,CAAC;QACxCc,SAAS,EAAE;UACVC,KAAK,EAAE;QACR;MACD,CAAC,CACD;;MAED;MACA,IAAIpB,KAAK,CAACS,WAAW,IAAIT,KAAK,CAACS,WAAW,CAACY,MAAM,GAAG,CAAC,EAAE;QACtDN,MAAM,CAACO,IAAI,CAAC;UACXN,IAAI,EAAE,MAAM;UACZC,IAAI,EAAE,KAAK;UACXC,QAAQ,EAAE,KAAK;UACfV,IAAI,EAAER,KAAK,CAACS,WAAW,CAACI,GAAG,CAACC,IAAI,IAAIA,IAAI,CAACT,KAAK,CAAC;UAC/Cc,SAAS,EAAE;YACVC,KAAK,EAAE;UACR;QACD,CAAC,CAAC;MACH;MAEA,MAAMG,MAAM,GAAG;QACdC,OAAO,EAAE;UACRC,OAAO,EAAE,MAAM;UACfC,WAAW,EAAE;YACZT,IAAI,EAAE;UACP;QACD,CAAC;QACDU,IAAI,EAAE;UACLC,IAAI,EAAE,IAAI;UACVC,KAAK,EAAE,IAAI;UACXC,MAAM,EAAE,IAAI;UACZC,YAAY,EAAE;QACf,CAAC;QACDC,KAAK,EAAE;UACNf,IAAI,EAAE,UAAU;UAChBT,IAAI,EAAER,KAAK,CAACQ,IAAI,CAACK,GAAG,CAACC,IAAI,IAAIA,IAAI,CAACE,IAAI;QACvC,CAAC;QACDiB,KAAK,EAAE;UACNhB,IAAI,EAAE,OAAO;UACbiB,GAAG,EAAE,CAAC;UACNtB,GAAG,EAAEF,QAAQ,CAAC;QACf,CAAC;QACDK;MACD,CAAC;MAEDZ,aAAa,CAACgC,SAAS,CAACZ,MAAM,CAAC;IAChC,CAAC;IAED1B,SAAS,CAAC,MAAM;MACfO,SAAS,CAAC,CAAC;MACXgC,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAE,MAAMlC,aAAa,EAAEmC,MAAM,CAAC,CAAC,CAAC;IACjE,CAAC,CAAC;IAEFxC,KAAK,CACJ,MAAM,CAACE,KAAK,CAACQ,IAAI,EAAER,KAAK,CAACS,WAAW,EAAET,KAAK,CAACuC,MAAM,CAAC,EACnD,MAAM;MACL,IAAIpC,aAAa,EAAE;QAClBC,SAAS,CAAC,CAAC;MACZ;IACD,CAAC,EACD;MAAEoC,IAAI,EAAE;IAAK,CACd,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}