{"ast":null,"code":"import { onMounted, onUnmounted } from \"vue\";\nimport bus from \"@/js/eventBus.js\";\nimport * as d3 from \"d3\";\nexport default {\n  __name: 'TextPopup',\n  props: {\n    visible: Boolean,\n    content: String,\n    containerClass: String,\n    containerRef: Object\n  },\n  emits: [\"close\"],\n  setup(__props, _ref) {\n    let {\n      expose: __expose,\n      emit: __emit\n    } = _ref;\n    __expose();\n    const props = __props;\n    const emit = __emit;\n    const close = () => {\n      emit(\"close\");\n    };\n\n    // 监听infobox字段点击事件\n    onMounted(() => {\n      bus.on(\"fieldClicked\", fieldKey => {\n        highlightField(fieldKey);\n      });\n    });\n    const highlightField = fieldKey => {\n      const contentElement = document.querySelector(\".popup-content\");\n      if (!contentElement) return;\n\n      // 移除旧的高亮\n      const previous = contentElement.querySelectorAll(\".highlighted\");\n      previous.forEach(el => el.classList.remove(\"highlighted\"));\n\n      // 查找匹配的字段\n      const elements = contentElement.querySelectorAll(\"th, td\");\n      elements.forEach(el => {\n        if (el.textContent.toLowerCase().includes(fieldKey.toLowerCase())) {\n          el.classList.add(\"highlighted\");\n          el.scrollIntoView({\n            behavior: \"smooth\",\n            block: \"center\"\n          });\n        }\n      });\n    };\n    onUnmounted(() => {\n      bus.off(\"fieldClicked\");\n    });\n    const __returned__ = {\n      props,\n      emit,\n      close,\n      highlightField,\n      onMounted,\n      onUnmounted,\n      get bus() {\n        return bus;\n      },\n      get d3() {\n        return d3;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","onUnmounted","bus","d3","props","__props","emit","__emit","close","on","fieldKey","highlightField","contentElement","document","querySelector","previous","querySelectorAll","forEach","el","classList","remove","elements","textContent","toLowerCase","includes","add","scrollIntoView","behavior","block","off"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/compoents_base/TextPopup.vue"],"sourcesContent":["<template>\r\n\t<div v-if=\"visible\" class=\"overlay\">\r\n\t\t<div class=\"text-popup\">\r\n\t\t\t<button class=\"close-button\" @click=\"close\">×</button>\r\n\t\t\t<div class=\"popup-header\">\r\n\t\t\t\t<h3>选中的内容</h3>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"popup-content\" v-html=\"content\"></div>\r\n\t\t\t<div :class=\"containerClass\"></div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { onMounted, onUnmounted } from \"vue\";\r\n\timport bus from \"@/js/eventBus.js\";\r\n\timport * as d3 from \"d3\";\r\n\r\n\tconst props = defineProps({\r\n\t\tvisible: Boolean,\r\n\t\tcontent: String,\r\n\t\tcontainerClass: String,\r\n\t\tcontainerRef: Object\r\n\t});\r\n\r\n\tconst emit = defineEmits([\"close\"]);\r\n\r\n\tconst close = () => {\r\n\t\temit(\"close\");\r\n\t};\r\n\r\n\t// 监听infobox字段点击事件\r\n\tonMounted(() => {\r\n\t\tbus.on(\"fieldClicked\", fieldKey => {\r\n\t\t\thighlightField(fieldKey);\r\n\t\t});\r\n\t});\r\n\r\n\tconst highlightField = fieldKey => {\r\n\t\tconst contentElement = document.querySelector(\".popup-content\");\r\n\t\tif (!contentElement) return;\r\n\r\n\t\t// 移除旧的高亮\r\n\t\tconst previous = contentElement.querySelectorAll(\".highlighted\");\r\n\t\tprevious.forEach(el => el.classList.remove(\"highlighted\"));\r\n\r\n\t\t// 查找匹配的字段\r\n\t\tconst elements = contentElement.querySelectorAll(\"th, td\");\r\n\t\telements.forEach(el => {\r\n\t\t\tif (el.textContent.toLowerCase().includes(fieldKey.toLowerCase())) {\r\n\t\t\t\tel.classList.add(\"highlighted\");\r\n\t\t\t\tel.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tonUnmounted(() => {\r\n\t\tbus.off(\"fieldClicked\");\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.overlay {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t\tz-index: 100;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.text-popup {\r\n\t\tposition: relative;\r\n\t\twidth: 80%;\r\n\t\tmax-width: 800px;\r\n\t\tmax-height: 80vh;\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 8px;\r\n\t\tpadding: 20px;\r\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\r\n\t\toverflow: auto;\r\n\t}\r\n\r\n\t.close-button {\r\n\t\tposition: absolute;\r\n\t\ttop: 10px;\r\n\t\tright: 10px;\r\n\t\tbackground: none;\r\n\t\tborder: none;\r\n\t\tfont-size: 24px;\r\n\t\tcursor: pointer;\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t.popup-header {\r\n\t\tmargin-bottom: 15px;\r\n\t\tpadding-bottom: 10px;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t}\r\n\r\n\t.popup-content {\r\n\t\tmargin-bottom: 20px;\r\n\t\tmax-height: 300px;\r\n\t\toverflow-y: auto;\r\n\t\tborder: 1px solid #eee;\r\n\t\tpadding: 10px;\r\n\t}\r\n\r\n\t.highlighted {\r\n\t\tbackground-color: #fffacd;\r\n\t\ttransition: background-color 0.3s ease;\r\n\t}\r\n</style>\r\n"],"mappings":"AAcC,SAASA,SAAS,EAAEC,WAAW,QAAQ,KAAK;AAC5C,OAAOC,GAAG,MAAM,kBAAkB;AAClC,OAAO,KAAKC,EAAE,MAAM,IAAI;;;;;;;;;;;;;;;;IAExB,MAAMC,KAAK,GAAGC,OAKZ;IAEF,MAAMC,IAAI,GAAGC,MAAsB;IAEnC,MAAMC,KAAK,GAAGA,CAAA,KAAM;MACnBF,IAAI,CAAC,OAAO,CAAC;IACd,CAAC;;IAED;IACAN,SAAS,CAAC,MAAM;MACfE,GAAG,CAACO,EAAE,CAAC,cAAc,EAAEC,QAAQ,IAAI;QAClCC,cAAc,CAACD,QAAQ,CAAC;MACzB,CAAC,CAAC;IACH,CAAC,CAAC;IAEF,MAAMC,cAAc,GAAGD,QAAQ,IAAI;MAClC,MAAME,cAAc,GAAGC,QAAQ,CAACC,aAAa,CAAC,gBAAgB,CAAC;MAC/D,IAAI,CAACF,cAAc,EAAE;;MAErB;MACA,MAAMG,QAAQ,GAAGH,cAAc,CAACI,gBAAgB,CAAC,cAAc,CAAC;MAChED,QAAQ,CAACE,OAAO,CAACC,EAAE,IAAIA,EAAE,CAACC,SAAS,CAACC,MAAM,CAAC,aAAa,CAAC,CAAC;;MAE1D;MACA,MAAMC,QAAQ,GAAGT,cAAc,CAACI,gBAAgB,CAAC,QAAQ,CAAC;MAC1DK,QAAQ,CAACJ,OAAO,CAACC,EAAE,IAAI;QACtB,IAAIA,EAAE,CAACI,WAAW,CAACC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACd,QAAQ,CAACa,WAAW,CAAC,CAAC,CAAC,EAAE;UAClEL,EAAE,CAACC,SAAS,CAACM,GAAG,CAAC,aAAa,CAAC;UAC/BP,EAAE,CAACQ,cAAc,CAAC;YAAEC,QAAQ,EAAE,QAAQ;YAAEC,KAAK,EAAE;UAAS,CAAC,CAAC;QAC3D;MACD,CAAC,CAAC;IACH,CAAC;IAED3B,WAAW,CAAC,MAAM;MACjBC,GAAG,CAAC2B,GAAG,CAAC,cAAc,CAAC;IACxB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}