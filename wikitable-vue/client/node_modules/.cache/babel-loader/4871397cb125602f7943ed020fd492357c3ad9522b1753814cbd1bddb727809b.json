{"ast":null,"code":"import { useCssVars as _useCssVars, unref as _unref } from 'vue';\nimport { computed } from \"vue\";\nimport SparklineChart from \"./SparklineChart.vue\";\nexport default {\n  __name: 'FieldVisualization',\n  props: {\n    field: {\n      type: [Object, Array],\n      default: null\n    },\n    type: {\n      type: String,\n      default: \"number\"\n    }\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    _useCssVars(_ctx => ({\n      \"35226a1e-chartColor\": chartColor.value\n    }));\n    const props = __props;\n    const chartColor = computed(() => {\n      return props.type === \"percentage\" ? \"#4CAF50\" : props.type === \"currency\" ? \"#2196F3\" : \"#9C27B0\";\n    });\n    const hasData = computed(() => {\n      return props.field && (props.field.value !== undefined || Array.isArray(props.field) && props.field.length > 0);\n    });\n    const isTimeSeries = computed(() => {\n      return Array.isArray(props.field) && props.field.every(item => item.value !== undefined && item.year !== undefined);\n    });\n    const isSingleValue = computed(() => {\n      return props.field.value !== undefined && !isTimeSeries.value;\n    });\n    const isPercentage = computed(() => {\n      return props.type === \"percentage\" && isSingleValue.value;\n    });\n    const timeSeriesData = computed(() => {\n      if (!isTimeSeries.value) return [];\n      return props.field.map(item => ({\n        year: item.year,\n        value: item.value\n      }));\n    });\n    const formattedValue = computed(() => {\n      if (!props.field.value) return \"-\";\n\n      // 格式化大数字\n      const num = parseFloat(props.field.value);\n      if (num >= 1e12) return `$${(num / 1e12).toFixed(1)}万亿`;\n      if (num >= 1e8) return `$${(num / 1e8).toFixed(1)}亿`;\n      if (num >= 1e4) return `$${(num / 1e4).toFixed(1)}万`;\n      return num.toLocaleString();\n    });\n    const circleStyle = computed(() => {\n      if (!isPercentage.value) return {};\n      const percent = Math.min(100, Math.max(0, parseFloat(props.field.value)));\n      return {\n        background: `conic-gradient(${chartColor.value} ${percent}%, #eee ${percent}% 100%)`\n      };\n    });\n    const __returned__ = {\n      props,\n      chartColor,\n      hasData,\n      isTimeSeries,\n      isSingleValue,\n      isPercentage,\n      timeSeriesData,\n      formattedValue,\n      circleStyle,\n      computed,\n      SparklineChart\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","SparklineChart","props","__props","chartColor","type","hasData","field","value","undefined","Array","isArray","length","isTimeSeries","every","item","year","isSingleValue","isPercentage","timeSeriesData","map","formattedValue","num","parseFloat","toFixed","toLocaleString","circleStyle","percent","Math","min","max","background"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/compoents_base/FieldVisualization.vue"],"sourcesContent":["<template>\r\n\t<div class=\"field-visualization\">\r\n\t\t<template v-if=\"hasData\">\r\n\t\t\t<!-- 时间序列数据 - 显示折线图 -->\r\n\t\t\t<SparklineChart\r\n\t\t\t\tv-if=\"isTimeSeries\"\r\n\t\t\t\t:data=\"timeSeriesData\"\r\n\t\t\t\t:max-width=\"250\"\r\n\t\t\t\t:max-height=\"100\"\r\n\t\t\t\t:line-color=\"chartColor\" />\r\n\r\n\t\t\t<!-- 单一数值 - 显示大数字或仪表盘 -->\r\n\t\t\t<div v-else-if=\"isSingleValue\" class=\"single-value\">\r\n\t\t\t\t<div class=\"value\">{{ formattedValue }}</div>\r\n\t\t\t\t<div v-if=\"field.unit\" class=\"unit\">{{ field.unit }}</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<!-- 百分比 - 显示圆形进度条 -->\r\n\t\t\t<div v-else-if=\"isPercentage\" class=\"percentage-chart\">\r\n\t\t\t\t<div class=\"circle-progress\" :style=\"circleStyle\"></div>\r\n\t\t\t\t<div class=\"percentage-value\">{{ field.value }}%</div>\r\n\t\t\t</div>\r\n\t\t</template>\r\n\r\n\t\t<div v-else class=\"no-data\">无可用数据</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { computed } from \"vue\";\r\n\timport SparklineChart from \"./SparklineChart.vue\";\r\n\r\n\tconst props = defineProps({\r\n\t\tfield: {\r\n\t\t\ttype: [Object, Array],\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\ttype: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"number\"\r\n\t\t}\r\n\t});\r\n\r\n\tconst chartColor = computed(() => {\r\n\t\treturn props.type === \"percentage\"\r\n\t\t\t? \"#4CAF50\"\r\n\t\t\t: props.type === \"currency\"\r\n\t\t\t? \"#2196F3\"\r\n\t\t\t: \"#9C27B0\";\r\n\t});\r\n\r\n\tconst hasData = computed(() => {\r\n\t\treturn (\r\n\t\t\tprops.field &&\r\n\t\t\t(props.field.value !== undefined ||\r\n\t\t\t\t(Array.isArray(props.field) && props.field.length > 0))\r\n\t\t);\r\n\t});\r\n\r\n\tconst isTimeSeries = computed(() => {\r\n\t\treturn (\r\n\t\t\tArray.isArray(props.field) &&\r\n\t\t\tprops.field.every(\r\n\t\t\t\titem => item.value !== undefined && item.year !== undefined\r\n\t\t\t)\r\n\t\t);\r\n\t});\r\n\r\n\tconst isSingleValue = computed(() => {\r\n\t\treturn props.field.value !== undefined && !isTimeSeries.value;\r\n\t});\r\n\r\n\tconst isPercentage = computed(() => {\r\n\t\treturn props.type === \"percentage\" && isSingleValue.value;\r\n\t});\r\n\r\n\tconst timeSeriesData = computed(() => {\r\n\t\tif (!isTimeSeries.value) return [];\r\n\t\treturn props.field.map(item => ({\r\n\t\t\tyear: item.year,\r\n\t\t\tvalue: item.value\r\n\t\t}));\r\n\t});\r\n\r\n\tconst formattedValue = computed(() => {\r\n\t\tif (!props.field.value) return \"-\";\r\n\r\n\t\t// 格式化大数字\r\n\t\tconst num = parseFloat(props.field.value);\r\n\t\tif (num >= 1e12) return `$${(num / 1e12).toFixed(1)}万亿`;\r\n\t\tif (num >= 1e8) return `$${(num / 1e8).toFixed(1)}亿`;\r\n\t\tif (num >= 1e4) return `$${(num / 1e4).toFixed(1)}万`;\r\n\t\treturn num.toLocaleString();\r\n\t});\r\n\r\n\tconst circleStyle = computed(() => {\r\n\t\tif (!isPercentage.value) return {};\r\n\t\tconst percent = Math.min(100, Math.max(0, parseFloat(props.field.value)));\r\n\t\treturn {\r\n\t\t\tbackground: `conic-gradient(${chartColor.value} ${percent}%, #eee ${percent}% 100%)`\r\n\t\t};\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.field-visualization {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.single-value {\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.single-value .value {\r\n\t\tfont-size: 24px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: v-bind(chartColor);\r\n\t}\r\n\r\n\t.single-value .unit {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #666;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t.percentage-chart {\r\n\t\tposition: relative;\r\n\t\twidth: 80px;\r\n\t\theight: 80px;\r\n\t}\r\n\r\n\t.circle-progress {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tborder-radius: 50%;\r\n\t}\r\n\r\n\t.percentage-value {\r\n\t\tposition: absolute;\r\n\t\ttop: 50%;\r\n\t\tleft: 50%;\r\n\t\ttransform: translate(-50%, -50%);\r\n\t\tfont-size: 16px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: v-bind(chartColor);\r\n\t}\r\n\r\n\t.no-data {\r\n\t\tcolor: #999;\r\n\t\tfont-style: italic;\r\n\t\ttext-align: center;\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}