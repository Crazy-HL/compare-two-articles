{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, onMounted, onUnmounted, watch, nextTick } from \"vue\";\nimport bus from \"@/js/eventBus.js\";\nimport CompareTable from \"@/components/compoents_base/CompareTable.vue\";\nimport CausalFlowChart from \"@/components/compoents_base/CausalFlowChart.vue\";\nimport api from \"@/js/api\";\n\n// 保留字段映射\n\nexport default {\n  __name: 'Div2',\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const PRESERVED_FIELDS_BY_SECTION = {\n      Statistics: [\"Population\", \"GDP\", \"GDP rank\", \"GDP growth\", \"GDP per capita\", \"GDP per capita rank\", \"GDP by sector\", \"Inflation (CPI)\", \"Population below poverty line\", \"Gini coefficient\", \"Human Development Index\", \"Corruption Perceptions Index\", \"Labor force\", \"Labor force by occupation\", \"Unemployment\", \"Average gross salary\", \"Average net salary\", \"Main industries\"],\n      \"Public finances\": [\"Government debt\", \"Foreign reserves\", \"Budget balance\", \"Revenues\", \"Expenses\", \"Economic aid\", \"Credit rating\"]\n    };\n\n    // 状态\n    const userQuestion = ref(\"\");\n    const chatHistory = ref([]);\n    const div1RawData = ref(null);\n    const div3RawData = ref(null);\n    const isLoading = ref(false);\n    const showSuggestedQuestion = ref(false);\n    const suggestedQuestion = ref(\"\");\n    const currentFieldKey = ref(\"\");\n    const leftData = ref(null);\n    const rightData = ref(null);\n    const div1InfoboxData = ref(null);\n    const div3InfoboxData = ref(null);\n\n    // 聊天记录本地存储\n    const loadChatHistory = () => {\n      const saved = localStorage.getItem(\"chatHistory\");\n      if (saved) {\n        try {\n          chatHistory.value = JSON.parse(saved);\n        } catch {}\n      }\n    };\n    watch(chatHistory, newVal => {\n      localStorage.setItem(\"chatHistory\", JSON.stringify(newVal));\n    }, {\n      deep: true\n    });\n    const scrollToBottom = () => {\n      nextTick(() => {\n        const container = document.querySelector(\".chat-history\");\n        if (container) container.scrollTop = container.scrollHeight;\n      });\n    };\n    onMounted(() => {\n      loadChatHistory();\n      bus.on(\"div1_Event\", data => handleSelection(data, \"div1\"));\n      bus.on(\"div3_Event\", data => handleSelection(data, \"div3\"));\n      bus.on(\"div1_InfoboxData\", data => div1InfoboxData.value = data);\n      bus.on(\"div3_InfoboxData\", data => div3InfoboxData.value = data);\n    });\n    onUnmounted(() => {\n      bus.off(\"div1_Event\");\n      bus.off(\"div3_Event\");\n      bus.off(\"div1_InfoboxData\");\n      bus.off(\"div3_InfoboxData\");\n    });\n    function handleSelection(data, source) {\n      const plain = getPlainTextFromSelection(data.content);\n      if (source === \"div1\") div1RawData.value = data.content;else div3RawData.value = data.content;\n    }\n    function getPlainTextFromSelection(html) {\n      const c = document.createElement(\"div\");\n      c.innerHTML = html;\n      return c.innerText || c.textContent || \"\";\n    }\n    function formatAnalysisResult(text) {\n      if (!text) return \"\";\n      return `<div class=\\\"markdown-content\\\">${text.replace(/^# (.*$)/gm, \"<h1>$1</h1>\").replace(/^## (.*$)/gm, \"<h2>$1</h2>\").replace(/^### (.*$)/gm, \"<h3>$1</h3>\").replace(/\\*\\*(.*?)\\*\\*/g, \"<strong>$1</strong>\").replace(/\\*(.*?)\\*/g, \"<em>$1</em>\").replace(/`(.*?)`/g, \"<code>$1</code>\").replace(/(?:^|\\n)\\d+\\.\\s+(.*)/g, \"<li>$1</li>\").replace(/(?:^|\\n)-\\s+(.*)/g, \"<li>$1</li>\").replace(/(?:^|\\n)\\>\\s+(.*)/g, \"<blockquote>$1</blockquote>\").replace(/(<li>.*<\\/li>)/gs, \"<ul>$1</ul>\").replace(/\\n\\n/g, \"<br><br>\").replace(/\\n/g, \"<br>\")}</div>`;\n    }\n    function extractEssentialData(item) {\n      const e = {\n        value: item.value,\n        type: item.type\n      };\n      if (item.unit) e.unit = item.unit;\n      if (item.currency) e.currency = item.currency;\n      if (item.raw) e.raw = item.raw;\n      return e;\n    }\n    function simplifyInfobox(infobox) {\n      if (!infobox) return {};\n      const r = {\n        title: infobox.title,\n        type: infobox.type,\n        sections: {}\n      };\n      Object.entries(infobox.sections || {}).forEach(_ref2 => {\n        let [sec, data] = _ref2;\n        if (PRESERVED_FIELDS_BY_SECTION[sec]) {\n          r.sections[sec] = {};\n          PRESERVED_FIELDS_BY_SECTION[sec].forEach(f => {\n            if (data[f]) {\n              r.sections[sec][f] = Array.isArray(data[f]) ? data[f].map(extractEssentialData) : extractEssentialData(data[f]);\n            }\n          });\n        }\n      });\n      return r;\n    }\n\n    // 处理对比分析\n    async function handleAttributeComparison(_ref3) {\n      let {\n        fieldKey,\n        leftData: ld,\n        rightData: rd,\n        leftTitle,\n        rightTitle,\n        fieldType\n      } = _ref3;\n      if (!ld || !rd) {\n        chatHistory.value.push({\n          role: \"assistant\",\n          content: \"请先选择要对比的数据\",\n          timestamp: new Date().toLocaleString(),\n          error: true\n        });\n        return;\n      }\n      leftData.value = ld;\n      rightData.value = rd;\n      currentFieldKey.value = fieldKey;\n      isLoading.value = true;\n      chatHistory.value.push({\n        role: \"assistant\",\n        content: `正在对比分析<strong>${fieldKey}</strong>属性...`,\n        timestamp: new Date().toLocaleString()\n      });\n      try {\n        const resp = await api.post(\"compare_attributes\", {\n          chartData: {\n            leftData: ld,\n            rightData: rd,\n            leftTitle,\n            rightTitle,\n            fieldKey,\n            fieldType,\n            leftInfobox: simplifyInfobox(div1InfoboxData.value),\n            rightInfobox: simplifyInfobox(div3InfoboxData.value)\n          },\n          chartType: \"comparison\",\n          followUp: false\n        });\n        // 使用后端返回的结构化 chains\n        chatHistory.value.push({\n          role: \"assistant\",\n          content: \"以下是因果链分析：\",\n          isCausalFlow: Array.isArray(resp.chains) && resp.chains.length > 0,\n          causalChains: resp.chains,\n          timestamp: new Date().toLocaleString()\n        });\n        suggestedQuestion.value = `请结合其他属性深入分析得出上述结论的原因`;\n        showSuggestedQuestion.value = true;\n        scrollToBottom();\n      } catch (e) {\n        chatHistory.value.push({\n          role: \"assistant\",\n          content: `对比分析失败: ${e.message}`,\n          timestamp: new Date().toLocaleString(),\n          error: true\n        });\n      } finally {\n        isLoading.value = false;\n        scrollToBottom();\n      }\n    }\n\n    // 提问\n    async function askQuestion() {\n      if (!userQuestion.value.trim()) {\n        chatHistory.value.push({\n          role: \"assistant\",\n          content: \"问题不能为空\",\n          timestamp: new Date().toLocaleString(),\n          error: true\n        });\n        return;\n      }\n      chatHistory.value.push({\n        role: \"user\",\n        content: userQuestion.value,\n        timestamp: new Date().toLocaleString()\n      });\n      userQuestion.value = \"\";\n      isLoading.value = true;\n      showSuggestedQuestion.value = false;\n      try {\n        const resp = await api.post(\"ask_infobox\", {\n          question: userQuestion.value,\n          leftInfobox: simplifyInfobox(div1InfoboxData.value),\n          rightInfobox: simplifyInfobox(div3InfoboxData.value)\n        });\n        chatHistory.value.push({\n          role: \"assistant\",\n          content: formatAnalysisResult(resp.answer),\n          timestamp: new Date().toLocaleString()\n        });\n        scrollToBottom();\n      } catch (e) {\n        chatHistory.value.push({\n          role: \"assistant\",\n          content: `请求失败: ${e.message}`,\n          timestamp: new Date().toLocaleString(),\n          error: true\n        });\n        scrollToBottom();\n      } finally {\n        isLoading.value = false;\n      }\n    }\n    function useSuggestedQuestion() {\n      userQuestion.value = suggestedQuestion.value;\n      showSuggestedQuestion.value = false;\n      nextTick(() => document.querySelector(\".input-container textarea\").focus());\n    }\n    const __returned__ = {\n      PRESERVED_FIELDS_BY_SECTION,\n      userQuestion,\n      chatHistory,\n      div1RawData,\n      div3RawData,\n      isLoading,\n      showSuggestedQuestion,\n      suggestedQuestion,\n      currentFieldKey,\n      leftData,\n      rightData,\n      div1InfoboxData,\n      div3InfoboxData,\n      loadChatHistory,\n      scrollToBottom,\n      handleSelection,\n      getPlainTextFromSelection,\n      formatAnalysisResult,\n      extractEssentialData,\n      simplifyInfobox,\n      handleAttributeComparison,\n      askQuestion,\n      useSuggestedQuestion,\n      ref,\n      onMounted,\n      onUnmounted,\n      watch,\n      nextTick,\n      get bus() {\n        return bus;\n      },\n      CompareTable,\n      CausalFlowChart,\n      get api() {\n        return api;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","watch","nextTick","bus","CompareTable","CausalFlowChart","api","PRESERVED_FIELDS_BY_SECTION","Statistics","userQuestion","chatHistory","div1RawData","div3RawData","isLoading","showSuggestedQuestion","suggestedQuestion","currentFieldKey","leftData","rightData","div1InfoboxData","div3InfoboxData","loadChatHistory","saved","localStorage","getItem","value","JSON","parse","newVal","setItem","stringify","deep","scrollToBottom","container","document","querySelector","scrollTop","scrollHeight","on","data","handleSelection","off","source","plain","getPlainTextFromSelection","content","html","c","createElement","innerHTML","innerText","textContent","formatAnalysisResult","text","replace","extractEssentialData","item","e","type","unit","currency","raw","simplifyInfobox","infobox","r","title","sections","Object","entries","forEach","_ref2","sec","f","Array","isArray","map","handleAttributeComparison","_ref3","fieldKey","ld","rd","leftTitle","rightTitle","fieldType","push","role","timestamp","Date","toLocaleString","error","resp","post","chartData","leftInfobox","rightInfobox","chartType","followUp","isCausalFlow","chains","length","causalChains","message","askQuestion","trim","question","answer","useSuggestedQuestion","focus"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/Div2.vue"],"sourcesContent":["<template>\r\n\t<div class=\"main-container\">\r\n\t\t<div class=\"chat-container\">\r\n\t\t\t<div class=\"chat-history\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tv-for=\"(message, index) in chatHistory\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t:class=\"['message', message.role, { error: message.error }]\">\r\n\t\t\t\t\t<div class=\"message-content\" v-html=\"message.content\"></div>\r\n\t\t\t\t\t<CausalFlowChart\r\n\t\t\t\t\t\tv-if=\"message.isCausalFlow\"\r\n\t\t\t\t\t\t:chains=\"message.causalChains\"\r\n\t\t\t\t\t\tclass=\"causal-flow-container\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div v-if=\"isLoading\" class=\"loading-indicator\">\r\n\t\t\t\t\t<div class=\"loading-spinner\"></div>\r\n\t\t\t\t\t正在处理中...\r\n\t\t\t\t</div>\r\n\t\t\t\t<div v-if=\"showSuggestedQuestion\" class=\"suggested-question\">\r\n\t\t\t\t\t<div class=\"suggestion-text\">建议深入分析的问题：</div>\r\n\t\t\t\t\t<div class=\"suggestion-content\" @click=\"useSuggestedQuestion\">\r\n\t\t\t\t\t\t{{ suggestedQuestion }}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"vis-container\">\r\n\t\t\t<CompareTable\r\n\t\t\t\tclass=\"compare-table\"\r\n\t\t\t\t:div1-raw-data=\"div1RawData\"\r\n\t\t\t\t:div3-raw-data=\"div3RawData\"\r\n\t\t\t\t@compareAttribute=\"handleAttributeComparison\" />\r\n\t\t</div>\r\n\t\t<div class=\"input-area\">\r\n\t\t\t<div class=\"input-container\">\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tv-model=\"userQuestion\"\r\n\t\t\t\t\trows=\"2\"\r\n\t\t\t\t\tplaceholder=\"请输入你想问的问题...\"\r\n\t\t\t\t\t:disabled=\"isLoading\"></textarea>\r\n\t\t\t\t<div class=\"button-container\">\r\n\t\t\t\t\t<button @click=\"askQuestion\" :disabled=\"isLoading\">\r\n\t\t\t\t\t\t{{ isLoading ? \"处理中...\" : \"发送\" }}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted, onUnmounted, watch, nextTick } from \"vue\";\r\n\timport bus from \"@/js/eventBus.js\";\r\n\timport CompareTable from \"@/components/compoents_base/CompareTable.vue\";\r\n\timport CausalFlowChart from \"@/components/compoents_base/CausalFlowChart.vue\";\r\n\timport api from \"@/js/api\";\r\n\r\n\t// 保留字段映射\r\n\tconst PRESERVED_FIELDS_BY_SECTION = {\r\n\t\tStatistics: [\r\n\t\t\t\"Population\",\r\n\t\t\t\"GDP\",\r\n\t\t\t\"GDP rank\",\r\n\t\t\t\"GDP growth\",\r\n\t\t\t\"GDP per capita\",\r\n\t\t\t\"GDP per capita rank\",\r\n\t\t\t\"GDP by sector\",\r\n\t\t\t\"Inflation (CPI)\",\r\n\t\t\t\"Population below poverty line\",\r\n\t\t\t\"Gini coefficient\",\r\n\t\t\t\"Human Development Index\",\r\n\t\t\t\"Corruption Perceptions Index\",\r\n\t\t\t\"Labor force\",\r\n\t\t\t\"Labor force by occupation\",\r\n\t\t\t\"Unemployment\",\r\n\t\t\t\"Average gross salary\",\r\n\t\t\t\"Average net salary\",\r\n\t\t\t\"Main industries\"\r\n\t\t],\r\n\t\t\"Public finances\": [\r\n\t\t\t\"Government debt\",\r\n\t\t\t\"Foreign reserves\",\r\n\t\t\t\"Budget balance\",\r\n\t\t\t\"Revenues\",\r\n\t\t\t\"Expenses\",\r\n\t\t\t\"Economic aid\",\r\n\t\t\t\"Credit rating\"\r\n\t\t]\r\n\t};\r\n\r\n\t// 状态\r\n\tconst userQuestion = ref(\"\");\r\n\tconst chatHistory = ref([]);\r\n\tconst div1RawData = ref(null);\r\n\tconst div3RawData = ref(null);\r\n\tconst isLoading = ref(false);\r\n\tconst showSuggestedQuestion = ref(false);\r\n\tconst suggestedQuestion = ref(\"\");\r\n\tconst currentFieldKey = ref(\"\");\r\n\tconst leftData = ref(null);\r\n\tconst rightData = ref(null);\r\n\tconst div1InfoboxData = ref(null);\r\n\tconst div3InfoboxData = ref(null);\r\n\r\n\t// 聊天记录本地存储\r\n\tconst loadChatHistory = () => {\r\n\t\tconst saved = localStorage.getItem(\"chatHistory\");\r\n\t\tif (saved) {\r\n\t\t\ttry {\r\n\t\t\t\tchatHistory.value = JSON.parse(saved);\r\n\t\t\t} catch {}\r\n\t\t}\r\n\t};\r\n\twatch(\r\n\t\tchatHistory,\r\n\t\tnewVal => {\r\n\t\t\tlocalStorage.setItem(\"chatHistory\", JSON.stringify(newVal));\r\n\t\t},\r\n\t\t{ deep: true }\r\n\t);\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tnextTick(() => {\r\n\t\t\tconst container = document.querySelector(\".chat-history\");\r\n\t\t\tif (container) container.scrollTop = container.scrollHeight;\r\n\t\t});\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tloadChatHistory();\r\n\t\tbus.on(\"div1_Event\", data => handleSelection(data, \"div1\"));\r\n\t\tbus.on(\"div3_Event\", data => handleSelection(data, \"div3\"));\r\n\t\tbus.on(\"div1_InfoboxData\", data => (div1InfoboxData.value = data));\r\n\t\tbus.on(\"div3_InfoboxData\", data => (div3InfoboxData.value = data));\r\n\t});\r\n\tonUnmounted(() => {\r\n\t\tbus.off(\"div1_Event\");\r\n\t\tbus.off(\"div3_Event\");\r\n\t\tbus.off(\"div1_InfoboxData\");\r\n\t\tbus.off(\"div3_InfoboxData\");\r\n\t});\r\n\r\n\tfunction handleSelection(data, source) {\r\n\t\tconst plain = getPlainTextFromSelection(data.content);\r\n\t\tif (source === \"div1\") div1RawData.value = data.content;\r\n\t\telse div3RawData.value = data.content;\r\n\t}\r\n\tfunction getPlainTextFromSelection(html) {\r\n\t\tconst c = document.createElement(\"div\");\r\n\t\tc.innerHTML = html;\r\n\t\treturn c.innerText || c.textContent || \"\";\r\n\t}\r\n\r\n\tfunction formatAnalysisResult(text) {\r\n\t\tif (!text) return \"\";\r\n\t\treturn `<div class=\\\"markdown-content\\\">${text\r\n\t\t\t.replace(/^# (.*$)/gm, \"<h1>$1</h1>\")\r\n\t\t\t.replace(/^## (.*$)/gm, \"<h2>$1</h2>\")\r\n\t\t\t.replace(/^### (.*$)/gm, \"<h3>$1</h3>\")\r\n\t\t\t.replace(/\\*\\*(.*?)\\*\\*/g, \"<strong>$1</strong>\")\r\n\t\t\t.replace(/\\*(.*?)\\*/g, \"<em>$1</em>\")\r\n\t\t\t.replace(/`(.*?)`/g, \"<code>$1</code>\")\r\n\t\t\t.replace(/(?:^|\\n)\\d+\\.\\s+(.*)/g, \"<li>$1</li>\")\r\n\t\t\t.replace(/(?:^|\\n)-\\s+(.*)/g, \"<li>$1</li>\")\r\n\t\t\t.replace(/(?:^|\\n)\\>\\s+(.*)/g, \"<blockquote>$1</blockquote>\")\r\n\t\t\t.replace(/(<li>.*<\\/li>)/gs, \"<ul>$1</ul>\")\r\n\t\t\t.replace(/\\n\\n/g, \"<br><br>\")\r\n\t\t\t.replace(/\\n/g, \"<br>\")}</div>`;\r\n\t}\r\n\r\n\tfunction extractEssentialData(item) {\r\n\t\tconst e = { value: item.value, type: item.type };\r\n\t\tif (item.unit) e.unit = item.unit;\r\n\t\tif (item.currency) e.currency = item.currency;\r\n\t\tif (item.raw) e.raw = item.raw;\r\n\t\treturn e;\r\n\t}\r\n\tfunction simplifyInfobox(infobox) {\r\n\t\tif (!infobox) return {};\r\n\t\tconst r = { title: infobox.title, type: infobox.type, sections: {} };\r\n\t\tObject.entries(infobox.sections || {}).forEach(([sec, data]) => {\r\n\t\t\tif (PRESERVED_FIELDS_BY_SECTION[sec]) {\r\n\t\t\t\tr.sections[sec] = {};\r\n\t\t\t\tPRESERVED_FIELDS_BY_SECTION[sec].forEach(f => {\r\n\t\t\t\t\tif (data[f]) {\r\n\t\t\t\t\t\tr.sections[sec][f] = Array.isArray(data[f])\r\n\t\t\t\t\t\t\t? data[f].map(extractEssentialData)\r\n\t\t\t\t\t\t\t: extractEssentialData(data[f]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn r;\r\n\t}\r\n\r\n\t// 处理对比分析\r\n\tasync function handleAttributeComparison({\r\n\t\tfieldKey,\r\n\t\tleftData: ld,\r\n\t\trightData: rd,\r\n\t\tleftTitle,\r\n\t\trightTitle,\r\n\t\tfieldType\r\n\t}) {\r\n\t\tif (!ld || !rd) {\r\n\t\t\tchatHistory.value.push({\r\n\t\t\t\trole: \"assistant\",\r\n\t\t\t\tcontent: \"请先选择要对比的数据\",\r\n\t\t\t\ttimestamp: new Date().toLocaleString(),\r\n\t\t\t\terror: true\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tleftData.value = ld;\r\n\t\trightData.value = rd;\r\n\t\tcurrentFieldKey.value = fieldKey;\r\n\t\tisLoading.value = true;\r\n\t\tchatHistory.value.push({\r\n\t\t\trole: \"assistant\",\r\n\t\t\tcontent: `正在对比分析<strong>${fieldKey}</strong>属性...`,\r\n\t\t\ttimestamp: new Date().toLocaleString()\r\n\t\t});\r\n\t\ttry {\r\n\t\t\tconst resp = await api.post(\"compare_attributes\", {\r\n\t\t\t\tchartData: {\r\n\t\t\t\t\tleftData: ld,\r\n\t\t\t\t\trightData: rd,\r\n\t\t\t\t\tleftTitle,\r\n\t\t\t\t\trightTitle,\r\n\t\t\t\t\tfieldKey,\r\n\t\t\t\t\tfieldType,\r\n\t\t\t\t\tleftInfobox: simplifyInfobox(div1InfoboxData.value),\r\n\t\t\t\t\trightInfobox: simplifyInfobox(div3InfoboxData.value)\r\n\t\t\t\t},\r\n\t\t\t\tchartType: \"comparison\",\r\n\t\t\t\tfollowUp: false\r\n\t\t\t});\r\n\t\t\t// 使用后端返回的结构化 chains\r\n\t\t\tchatHistory.value.push({\r\n\t\t\t\trole: \"assistant\",\r\n\t\t\t\tcontent: \"以下是因果链分析：\",\r\n\t\t\t\tisCausalFlow: Array.isArray(resp.chains) && resp.chains.length > 0,\r\n\t\t\t\tcausalChains: resp.chains,\r\n\t\t\t\ttimestamp: new Date().toLocaleString()\r\n\t\t\t});\r\n\t\t\tsuggestedQuestion.value = `请结合其他属性深入分析得出上述结论的原因`;\r\n\t\t\tshowSuggestedQuestion.value = true;\r\n\t\t\tscrollToBottom();\r\n\t\t} catch (e) {\r\n\t\t\tchatHistory.value.push({\r\n\t\t\t\trole: \"assistant\",\r\n\t\t\t\tcontent: `对比分析失败: ${e.message}`,\r\n\t\t\t\ttimestamp: new Date().toLocaleString(),\r\n\t\t\t\terror: true\r\n\t\t\t});\r\n\t\t} finally {\r\n\t\t\tisLoading.value = false;\r\n\t\t\tscrollToBottom();\r\n\t\t}\r\n\t}\r\n\r\n\t// 提问\r\n\tasync function askQuestion() {\r\n\t\tif (!userQuestion.value.trim()) {\r\n\t\t\tchatHistory.value.push({\r\n\t\t\t\trole: \"assistant\",\r\n\t\t\t\tcontent: \"问题不能为空\",\r\n\t\t\t\ttimestamp: new Date().toLocaleString(),\r\n\t\t\t\terror: true\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tchatHistory.value.push({\r\n\t\t\trole: \"user\",\r\n\t\t\tcontent: userQuestion.value,\r\n\t\t\ttimestamp: new Date().toLocaleString()\r\n\t\t});\r\n\t\tuserQuestion.value = \"\";\r\n\t\tisLoading.value = true;\r\n\t\tshowSuggestedQuestion.value = false;\r\n\t\ttry {\r\n\t\t\tconst resp = await api.post(\"ask_infobox\", {\r\n\t\t\t\tquestion: userQuestion.value,\r\n\t\t\t\tleftInfobox: simplifyInfobox(div1InfoboxData.value),\r\n\t\t\t\trightInfobox: simplifyInfobox(div3InfoboxData.value)\r\n\t\t\t});\r\n\t\t\tchatHistory.value.push({\r\n\t\t\t\trole: \"assistant\",\r\n\t\t\t\tcontent: formatAnalysisResult(resp.answer),\r\n\t\t\t\ttimestamp: new Date().toLocaleString()\r\n\t\t\t});\r\n\t\t\tscrollToBottom();\r\n\t\t} catch (e) {\r\n\t\t\tchatHistory.value.push({\r\n\t\t\t\trole: \"assistant\",\r\n\t\t\t\tcontent: `请求失败: ${e.message}`,\r\n\t\t\t\ttimestamp: new Date().toLocaleString(),\r\n\t\t\t\terror: true\r\n\t\t\t});\r\n\t\t\tscrollToBottom();\r\n\t\t} finally {\r\n\t\t\tisLoading.value = false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction useSuggestedQuestion() {\r\n\t\tuserQuestion.value = suggestedQuestion.value;\r\n\t\tshowSuggestedQuestion.value = false;\r\n\t\tnextTick(() => document.querySelector(\".input-container textarea\").focus());\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.main-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\theight: 100vh;\r\n\t\tbackground: #f5f7fa;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.chat-container {\r\n\t\theight: 50vh;\r\n\t\tmin-height: 50vh;\r\n\t\toverflow: hidden;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tmargin: 10px;\r\n\t}\r\n\r\n\t.chat-history {\r\n\t\tflex: 1;\r\n\t\toverflow-y: auto;\r\n\t\tpadding: 20px;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 12px;\r\n\t\tbox-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\r\n\t\tscroll-behavior: smooth;\r\n\t\tborder: 1px solid #e0e0e0;\r\n\t}\r\n\r\n\t.vis-container {\r\n\t\theight: 30vh;\r\n\t\tmin-height: 30vh;\r\n\t\tpadding: 10px;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 12px;\r\n\t\tmargin: 0 10px;\r\n\t\tbox-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\r\n\t\toverflow: auto;\r\n\t\tborder: 1px solid #e0e0e0;\r\n\t}\r\n\r\n\t.compare-table {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.input-area {\r\n\t\theight: 15vh;\r\n\t\tmin-height: 15vh;\r\n\t\tpadding: 15px;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-top: 1px solid #e0e0e0;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.message {\r\n\t\tmargin-bottom: 20px;\r\n\t\tpadding: 15px 20px;\r\n\t\tborder-radius: 12px;\r\n\t\tline-height: 1.6;\r\n\t\tposition: relative;\r\n\t\tmax-width: 85%;\r\n\t\tbox-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\r\n\t}\r\n\r\n\t.message.user {\r\n\t\tbackground: #e3f2fd;\r\n\t\tmargin-left: auto;\r\n\t\tborder-bottom-right-radius: 4px;\r\n\t\tborder: 1px solid #bbdefb;\r\n\t}\r\n\r\n\t.message.assistant {\r\n\t\tbackground: #f8f9fa;\r\n\t\tmargin-right: auto;\r\n\t\tborder-bottom-left-radius: 4px;\r\n\t\tborder: 1px solid #e0e0e0;\r\n\t}\r\n\r\n\t.message.error {\r\n\t\tbackground: #ffebee;\r\n\t\tborder-left: 4px solid #f44336;\r\n\t}\r\n\r\n\t.message-content {\r\n\t\tword-wrap: break-word;\r\n\t}\r\n\r\n\t.input-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 12px;\r\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n\t\theight: 100%;\r\n\t\tborder: 1px solid #e0e0e0;\r\n\t}\r\n\r\n\t.input-container textarea {\r\n\t\twidth: 100%;\r\n\t\tpadding: 12px 16px;\r\n\t\tborder: none;\r\n\t\tborder-radius: 12px;\r\n\t\tresize: none;\r\n\t\tfont-size: 14px;\r\n\t\toutline: none;\r\n\t\tbackground: #f9f9f9;\r\n\t}\r\n\r\n\t.input-container textarea:focus {\r\n\t\tbackground: #ffffff;\r\n\t}\r\n\r\n\t.button-container {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: flex-end;\r\n\t\tpadding: 8px;\r\n\t}\r\n\r\n\t.button-container button {\r\n\t\tbackground: #4285f4;\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tpadding: 8px 20px;\r\n\t\tborder-radius: 8px;\r\n\t\tcursor: pointer;\r\n\t\tfont-size: 14px;\r\n\t\tfont-weight: 500;\r\n\t\ttransition: all 0.2s;\r\n\t}\r\n\r\n\t.button-container button:hover {\r\n\t\tbackground: #3367d6;\r\n\t\ttransform: translateY(-1px);\r\n\t}\r\n\r\n\t.button-container button:disabled {\r\n\t\tbackground: #b3c6e0;\r\n\t\tcursor: not-allowed;\r\n\t\ttransform: none;\r\n\t}\r\n\r\n\t.loading-indicator {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 15px;\r\n\t\tcolor: #666;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\t.loading-spinner {\r\n\t\tborder: 3px solid rgba(66, 133, 244, 0.2);\r\n\t\tborder-radius: 50%;\r\n\t\tborder-top: 3px solid #4285f4;\r\n\t\twidth: 20px;\r\n\t\theight: 20px;\r\n\t\tanimation: spin 1s linear infinite;\r\n\t\tmargin-right: 10px;\r\n\t}\r\n\r\n\t@keyframes spin {\r\n\t\t0% {\r\n\t\t\ttransform: rotate(0deg);\r\n\t\t}\r\n\t\t100% {\r\n\t\t\ttransform: rotate(360deg);\r\n\t\t}\r\n\t}\r\n\r\n\t.markdown-content {\r\n\t\tline-height: 1.7;\r\n\t\tfont-size: 15px;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.markdown-content h1 {\r\n\t\tfont-size: 1.5em;\r\n\t\tmargin: 20px 0 15px;\r\n\t\tpadding-bottom: 5px;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t\tcolor: #2c3e50;\r\n\t}\r\n\r\n\t.markdown-content h2 {\r\n\t\tfont-size: 1.3em;\r\n\t\tmargin: 18px 0 12px;\r\n\t\tcolor: #34495e;\r\n\t}\r\n\r\n\t.markdown-content h3 {\r\n\t\tfont-size: 1.1em;\r\n\t\tmargin: 15px 0 10px;\r\n\t\tcolor: #4285f4;\r\n\t}\r\n\r\n\t.markdown-content ul,\r\n\t.markdown-content ol {\r\n\t\tpadding-left: 25px;\r\n\t\tmargin: 12px 0;\r\n\t}\r\n\r\n\t.markdown-content li {\r\n\t\tmargin-bottom: 8px;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.markdown-content ul li::before {\r\n\t\tcontent: \"•\";\r\n\t\tcolor: #4285f4;\r\n\t\tposition: absolute;\r\n\t\tleft: -15px;\r\n\t}\r\n\r\n\t.markdown-content strong {\r\n\t\tcolor: #2c3e50;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.markdown-content em {\r\n\t\tcolor: #666;\r\n\t\tfont-style: italic;\r\n\t}\r\n\r\n\t.markdown-content code {\r\n\t\tbackground: rgba(66, 133, 244, 0.1);\r\n\t\tpadding: 2px 6px;\r\n\t\tborder-radius: 4px;\r\n\t\tfont-family: \"SFMono-Regular\", Consolas, \"Liberation Mono\", Menlo, monospace;\r\n\t\tfont-size: 0.9em;\r\n\t\tcolor: #d63384;\r\n\t}\r\n\r\n\t.markdown-content blockquote {\r\n\t\tborder-left: 3px solid #4285f4;\r\n\t\tpadding: 10px 15px;\r\n\t\tmargin: 15px 0;\r\n\t\tbackground: rgba(66, 133, 244, 0.05);\r\n\t\tcolor: #555;\r\n\t}\r\n\r\n\t.markdown-content a {\r\n\t\tcolor: #4285f4;\r\n\t\ttext-decoration: none;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t.markdown-content a:hover {\r\n\t\ttext-decoration: underline;\r\n\t}\r\n\r\n\t.suggested-question {\r\n\t\tmargin: 15px 0;\r\n\t\tpadding: 12px;\r\n\t\tbackground-color: #f5f7fa;\r\n\t\tborder-radius: 8px;\r\n\t\tborder: 1px dashed #4285f4;\r\n\t\tcursor: pointer;\r\n\t\ttransition: all 0.2s;\r\n\t}\r\n\r\n\t.suggested-question:hover {\r\n\t\tbackground-color: #e8f0fe;\r\n\t}\r\n\r\n\t.suggestion-text {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #666;\r\n\t\tmargin-bottom: 5px;\r\n\t}\r\n\r\n\t.suggestion-content {\r\n\t\tcolor: #4285f4;\r\n\t\tfont-weight: 500;\r\n\t\tpadding: 5px;\r\n\t\tborder-radius: 4px;\r\n\t}\r\n\r\n\t.causal-flow-container {\r\n\t\twidth: 100%;\r\n\t\tmax-width: 100%;\r\n\t\toverflow: hidden;\r\n\t\tpadding: 0 5px;\r\n\t\tmargin-top: 15px;\r\n\t\tmargin-bottom: 5px;\r\n\t}\r\n\r\n\t@media (max-width: 768px) {\r\n\t\t.chat-container {\r\n\t\t\theight: 45vh;\r\n\t\t\tmin-height: 45vh;\r\n\t\t}\r\n\r\n\t\t.vis-container {\r\n\t\t\theight: 35vh;\r\n\t\t\tmin-height: 35vh;\r\n\t\t}\r\n\r\n\t\t.input-area {\r\n\t\t\theight: 20vh;\r\n\t\t\tmin-height: 20vh;\r\n\t\t}\r\n\r\n\t\t.message {\r\n\t\t\tmax-width: 90%;\r\n\t\t\tpadding: 12px 15px;\r\n\t\t}\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}