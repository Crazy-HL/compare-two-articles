{"ast":null,"code":"import \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { ref, onMounted, watch, computed, nextTick, onBeforeUnmount } from \"vue\";\nimport * as d3 from \"d3\";\nexport default {\n  __name: 'SparklineChart',\n  props: {\n    data: {\n      type: Array,\n      default: () => [],\n      validator: value => Array.isArray(value)\n    },\n    compareData: {\n      type: Array,\n      default: null\n    },\n    chartType: {\n      type: String,\n      default: \"auto\",\n      // auto, line, bar, pie\n      validator: value => [\"auto\", \"line\", \"bar\", \"pie\"].includes(value)\n    },\n    maxWidth: {\n      type: Number,\n      default: 250\n    },\n    maxHeight: {\n      type: Number,\n      default: 80\n    },\n    margin: {\n      type: Object,\n      default: () => ({\n        top: 5,\n        right: 5,\n        bottom: 5,\n        left: 5\n      })\n    },\n    lineColor: {\n      type: String,\n      default: \"#4a90e2\"\n    },\n    areaColor: {\n      type: String,\n      default: \"#4a90e2\"\n    },\n    dotColor: {\n      type: String,\n      default: \"#4a90e2\"\n    },\n    highlightColor: {\n      type: String,\n      default: \"#FFD700\"\n    },\n    showTooltip: {\n      type: Boolean,\n      default: true\n    },\n    showDots: {\n      type: Boolean,\n      default: true\n    },\n    showArea: {\n      type: Boolean,\n      default: true\n    },\n    showYearMarkers: {\n      type: Boolean,\n      default: true\n    },\n    curveType: {\n      type: String,\n      default: \"curveMonotoneX\"\n    },\n    maxBarWidth: {\n      type: Number,\n      default: 60\n    },\n    fullscreenMode: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: [\"chart-mounted\"],\n  setup(__props, _ref) {\n    let {\n      expose: __expose,\n      emit: __emit\n    } = _ref;\n    const props = __props;\n    const emit = __emit;\n    const chartContainer = ref(null);\n    const svg = ref(null);\n    const tooltip = ref(null);\n    const resizeObserver = ref(null);\n    const containerSize = ref({\n      width: props.maxWidth,\n      height: props.maxHeight\n    });\n    const updateContainerSize = () => {\n      if (chartContainer.value) {\n        containerSize.value = {\n          width: Math.min(chartContainer.value.clientWidth, props.maxWidth),\n          height: Math.min(chartContainer.value.clientHeight || props.maxHeight, props.maxHeight)\n        };\n      }\n    };\n    const innerWidth = computed(() => {\n      return Math.max(10, containerSize.value.width - props.margin.left - props.margin.right);\n    });\n    const innerHeight = computed(() => {\n      return Math.max(10, containerSize.value.height - props.margin.top - props.margin.bottom);\n    });\n    const processedData = computed(() => {\n      if (!Array.isArray(props.data)) return [];\n\n      // 处理饼图数据\n      if (determinedChartType.value === \"pie\") {\n        return props.data.filter(item => item.type === \"percentage\").map(item => ({\n          name: item.name,\n          value: item.value,\n          color: getPercentageColor(item.value)\n        }));\n      }\n\n      // 处理柱状图/折线图数据\n      return props.data.filter(item => item.value !== undefined && !isNaN(item.value)).sort((a, b) => (a.year || 0) - (b.year || 0));\n    });\n\n    // 自动判断图表类型\n    const determinedChartType = computed(() => {\n      if (props.chartType !== \"auto\") return props.chartType;\n\n      // 如果有百分比数据且是主要类型\n      const percentageItems = props.data.filter(item => item.type === \"percentage\");\n      if (percentageItems.length > 0 && percentageItems.length / props.data.length > 0.3) {\n        return \"pie\";\n      }\n\n      // 少量数据用柱状图\n      if (props.data.length <= 3) return \"bar\";\n\n      // 默认折线图\n      return \"line\";\n    });\n\n    // 饼图颜色生成\n    function getPercentageColor(value) {\n      const hue = (1 - value / 100) * 120; // 从绿色(0)到红色(120)\n      return `hsl(${hue}, 70%, 60%)`;\n    }\n    const hasData = computed(() => processedData.value.length > 0);\n    const noDataMessage = computed(() => \"无数据\");\n    const initChart = () => {\n      if (!chartContainer.value) return;\n      updateContainerSize();\n      d3.select(chartContainer.value).selectAll(\"*\").remove();\n      if (!hasData.value) return;\n      svg.value = d3.select(chartContainer.value).append(\"svg\").attr(\"width\", containerSize.value.width).attr(\"height\", containerSize.value.height).attr(\"viewBox\", `0 0 ${containerSize.value.width} ${containerSize.value.height}`).attr(\"preserveAspectRatio\", \"xMidYMid meet\");\n      const chart = svg.value.append(\"g\").attr(\"transform\", `translate(${props.margin.left},${props.margin.top})`);\n      switch (determinedChartType.value) {\n        case \"pie\":\n          drawPieChart(chart);\n          break;\n        case \"bar\":\n          drawBarChart(chart);\n          break;\n        case \"line\":\n        default:\n          drawLineChart(chart);\n      }\n      emit(\"chart-mounted\", {\n        chartType: determinedChartType.value\n      });\n    };\n    const drawPieChart = chart => {\n      const radius = Math.min(innerWidth.value, innerHeight.value) / 2;\n      const pie = d3.pie().value(d => d.value).sort(null);\n      const arc = d3.arc().innerRadius(0).outerRadius(radius);\n      const arcs = pie(processedData.value);\n\n      // 中心位置\n      const centerX = innerWidth.value / 2;\n      const centerY = innerHeight.value / 2;\n\n      // 绘制扇形\n      chart.selectAll(\".arc\").data(arcs).enter().append(\"path\").attr(\"class\", \"arc\").attr(\"d\", arc).attr(\"fill\", (d, i) => d.data.color || d3.schemeCategory10[i % 10]).attr(\"transform\", `translate(${centerX},${centerY})`);\n\n      // 添加标签\n      if (props.showTooltip && !props.fullscreenMode) {\n        const labelArc = d3.arc().outerRadius(radius - 10).innerRadius(radius - 10);\n        chart.selectAll(\".pie-label\").data(arcs).enter().append(\"text\").attr(\"class\", \"pie-label\").attr(\"transform\", d => `translate(${labelArc.centroid(d)})`).attr(\"dy\", \"0.35em\").attr(\"text-anchor\", \"middle\").text(d => {\n          const percent = (d.endAngle - d.startAngle) / (2 * Math.PI) * 100;\n          return percent > 10 ? `${d.data.name}: ${percent.toFixed(1)}%` : \"\";\n        }).attr(\"font-size\", \"10px\").attr(\"fill\", \"#fff\").attr(\"transform\", d => `translate(${arc.centroid(d)[0] + centerX},${arc.centroid(d)[1] + centerY})`);\n      }\n\n      // 添加tooltip\n      if (props.showTooltip) {\n        const tooltip = chart.append(\"g\").attr(\"class\", \"tooltip\").style(\"opacity\", 0);\n        tooltip.append(\"rect\").attr(\"class\", \"tooltip-box\").attr(\"rx\", 4).attr(\"ry\", 4);\n        tooltip.append(\"text\").attr(\"class\", \"tooltip-name\").attr(\"x\", 6).attr(\"y\", 18);\n        tooltip.append(\"text\").attr(\"class\", \"tooltip-value\").attr(\"x\", 6).attr(\"y\", 36);\n        chart.selectAll(\".arc\").on(\"mouseover\", function (event, d) {\n          tooltip.style(\"opacity\", 1);\n          tooltip.select(\".tooltip-name\").text(`项目: ${d.data.name}`);\n          tooltip.select(\".tooltip-value\").text(`值: ${d.data.value} (${((d.endAngle - d.startAngle) / (2 * Math.PI) * 100).toFixed(1)}%)`);\n          const tooltipText = tooltip.node().querySelectorAll(\"text\");\n          const bbox = tooltipText[0].getBBox();\n          const bbox2 = tooltipText[1].getBBox();\n          const tooltipWidth = Math.max(bbox.width, bbox2.width) + 12;\n          const tooltipHeight = bbox.height + bbox2.height + 16;\n          const [x, y] = d3.pointer(event);\n          tooltip.select(\".tooltip-box\").attr(\"x\", x).attr(\"y\", y - tooltipHeight).attr(\"width\", tooltipWidth).attr(\"height\", tooltipHeight);\n          tooltip.select(\".tooltip-name\").attr(\"x\", x + 6).attr(\"y\", y - tooltipHeight + 18);\n          tooltip.select(\".tooltip-value\").attr(\"x\", x + 6).attr(\"y\", y - tooltipHeight + 36);\n        }).on(\"mouseout\", () => {\n          tooltip.style(\"opacity\", 0);\n        });\n      }\n    };\n    const drawBarChart = chart => {\n      const xScale = d3.scaleBand().domain(processedData.value.map(d => d.year.toString())).range([0, innerWidth.value]).paddingInner(0.4).paddingOuter(0.2);\n      const calculatedWidth = xScale.bandwidth();\n      const barWidth = Math.min(calculatedWidth, props.maxBarWidth);\n      const adjustedPadding = (innerWidth.value - barWidth * processedData.value.length) / (processedData.value.length + 1);\n      const adjustedXScale = d3.scaleBand().domain(processedData.value.map(d => d.year.toString())).range([0, innerWidth.value]).paddingInner(adjustedPadding / barWidth).paddingOuter(adjustedPadding / barWidth);\n      const maxValue = d3.max(processedData.value, d => d.value);\n      const yScale = d3.scaleLinear().domain([0, maxValue * 1.1]).range([innerHeight.value, 0]);\n      chart.selectAll(\".bar\").data(processedData.value).enter().append(\"rect\").attr(\"class\", \"bar\").attr(\"x\", d => adjustedXScale(d.year.toString()) + (adjustedXScale.bandwidth() - barWidth) / 2).attr(\"width\", barWidth).attr(\"y\", d => yScale(d.value)).attr(\"height\", d => innerHeight.value - yScale(d.value)).attr(\"fill\", props.lineColor).attr(\"rx\", 2).attr(\"ry\", 2);\n      if (props.showTooltip) {\n        chart.selectAll(\".bar-label\").data(processedData.value).enter().append(\"text\").attr(\"class\", \"bar-label\").attr(\"x\", d => adjustedXScale(d.year.toString()) + adjustedXScale.bandwidth() / 2).attr(\"y\", d => yScale(d.value) - 5).attr(\"text-anchor\", \"middle\").text(d => formatValue(d.value)).attr(\"font-size\", \"10px\").attr(\"fill\", \"#64748b\").style(\"visibility\", d => innerHeight.value - yScale(d.value) > 20 ? \"visible\" : \"hidden\");\n      }\n    };\n    const drawLineChart = chart => {\n      const years = processedData.value.map(d => d.year);\n      const xScale = d3.scaleLinear().domain(d3.extent(years)).range([0, innerWidth.value]);\n      const values = processedData.value.map(d => d.value);\n      const minValue = d3.min(values);\n      const maxValue = d3.max(values);\n      const padding = (maxValue - minValue) * 0.1;\n      const yScale = d3.scaleLinear().domain([minValue - padding, maxValue + padding]).range([innerHeight.value, 0]);\n      const lineGenerator = d3.line().x(d => xScale(d.year)).y(d => yScale(d.value)).curve(d3[props.curveType]);\n      chart.append(\"path\").attr(\"class\", \"sparkline-line\").attr(\"d\", lineGenerator(processedData.value)).attr(\"stroke\", props.lineColor).attr(\"stroke-width\", 2).attr(\"fill\", \"none\");\n      if (props.showDots) {\n        chart.selectAll(\".sparkline-dot\").data(processedData.value).enter().append(\"circle\").attr(\"class\", \"sparkline-dot\").attr(\"cx\", d => xScale(d.year)).attr(\"cy\", d => yScale(d.value)).attr(\"r\", 3).attr(\"fill\", props.dotColor);\n      }\n      if (props.compareData && props.showYearMarkers) {\n        const commonYears = getCommonYears(processedData.value, props.compareData);\n        commonYears.forEach(year => {\n          const points = processedData.value.filter(d => d.year === year);\n          points.forEach(point => {\n            chart.append(\"circle\").attr(\"cx\", xScale(point.year)).attr(\"cy\", yScale(point.value)).attr(\"r\", 5).attr(\"fill\", props.highlightColor).attr(\"stroke\", \"#FF8C00\").attr(\"stroke-width\", 1.5).attr(\"class\", \"highlight-point\");\n          });\n        });\n      }\n      if (props.showTooltip) {\n        addTooltip(chart, xScale, yScale);\n      }\n    };\n    const getCommonYears = (data1, data2) => {\n      const years1 = new Set(data1.map(d => d.year));\n      const years2 = new Set(data2.filter(d => d).map(d => d.year));\n      return [...years1].filter(year => years2.has(year));\n    };\n    const formatValue = value => {\n      if (value >= 1000000) return `$${(value / 1000000).toFixed(1)}M`;\n      if (value >= 1000) return `$${(value / 1000).toFixed(1)}K`;\n      return value.toLocaleString();\n    };\n    const addTooltip = (chart, xScale, yScale) => {\n      tooltip.value = chart.append(\"g\").attr(\"class\", \"tooltip\").style(\"opacity\", 0).attr(\"pointer-events\", \"none\");\n      tooltip.value.append(\"rect\").attr(\"class\", \"tooltip-box\").attr(\"rx\", 4).attr(\"ry\", 4);\n      tooltip.value.append(\"text\").attr(\"class\", \"tooltip-year\").attr(\"x\", 6).attr(\"y\", 18);\n      tooltip.value.append(\"text\").attr(\"class\", \"tooltip-value\").attr(\"x\", 6).attr(\"y\", 36);\n      const referenceLine = chart.append(\"line\").attr(\"class\", \"reference-line\").attr(\"stroke\", \"#64748b\").attr(\"stroke-width\", 1).attr(\"stroke-dasharray\", \"2,2\").attr(\"y1\", 0).attr(\"y2\", innerHeight.value).style(\"opacity\", 0);\n      chart.append(\"rect\").attr(\"class\", \"overlay\").attr(\"width\", innerWidth.value).attr(\"height\", innerHeight.value).attr(\"fill\", \"none\").attr(\"pointer-events\", \"all\").on(\"mouseover\", () => tooltip.value.style(\"opacity\", 1)).on(\"mouseout\", () => {\n        tooltip.value.style(\"opacity\", 0);\n        referenceLine.style(\"opacity\", 0);\n      }).on(\"mousemove\", event => {\n        const [mouseX] = d3.pointer(event);\n        const year = xScale.invert(mouseX);\n        const closest = d3.least(processedData.value, d => Math.abs(xScale(d.year) - mouseX));\n        if (!closest) return;\n        referenceLine.attr(\"x1\", xScale(closest.year)).attr(\"x2\", xScale(closest.year)).style(\"opacity\", 1);\n        tooltip.value.select(\".tooltip-year\").text(`Year: ${closest.year}`);\n        tooltip.value.select(\".tooltip-value\").text(`Value: ${formatValue(closest.value)}`);\n        const tooltipText = tooltip.value.node().querySelectorAll(\"text\");\n        const bbox = tooltipText[0].getBBox();\n        const bbox2 = tooltipText[1].getBBox();\n        const tooltipWidth = Math.max(bbox.width, bbox2.width) + 12;\n        const tooltipHeight = bbox.height + bbox2.height + 16;\n        let x = xScale(closest.year) + 10;\n        let y = yScale(closest.value) - tooltipHeight / 2;\n        if (x + tooltipWidth > innerWidth.value) {\n          x = xScale(closest.year) - tooltipWidth - 10;\n        }\n        y = Math.max(0, Math.min(y, innerHeight.value - tooltipHeight));\n        tooltip.value.select(\".tooltip-box\").attr(\"x\", x).attr(\"y\", y).attr(\"width\", tooltipWidth).attr(\"height\", tooltipHeight);\n        tooltip.value.select(\".tooltip-year\").attr(\"x\", x + 6).attr(\"y\", y + 18);\n        tooltip.value.select(\".tooltip-value\").attr(\"x\", x + 6).attr(\"y\", y + 36);\n      });\n    };\n    const setupResizeObserver = () => {\n      if (resizeObserver.value) {\n        resizeObserver.value.disconnect();\n      }\n      if (chartContainer.value) {\n        resizeObserver.value = new ResizeObserver(() => {\n          nextTick(() => {\n            updateContainerSize();\n            initChart();\n          });\n        });\n        resizeObserver.value.observe(chartContainer.value);\n      }\n    };\n    onMounted(() => {\n      setupResizeObserver();\n      initChart();\n    });\n    onBeforeUnmount(() => {\n      if (resizeObserver.value) {\n        resizeObserver.value.disconnect();\n      }\n    });\n    watch(() => [props.data, props.compareData, props.chartType, props.maxWidth, props.maxHeight, props.margin, props.lineColor, props.highlightColor, props.showTooltip, props.showDots, props.showYearMarkers, props.curveType, props.maxBarWidth, props.fullscreenMode], initChart, {\n      deep: true\n    });\n    __expose({\n      chartType: determinedChartType\n    });\n    const __returned__ = {\n      props,\n      emit,\n      chartContainer,\n      svg,\n      tooltip,\n      resizeObserver,\n      containerSize,\n      updateContainerSize,\n      innerWidth,\n      innerHeight,\n      processedData,\n      determinedChartType,\n      getPercentageColor,\n      hasData,\n      noDataMessage,\n      initChart,\n      drawPieChart,\n      drawBarChart,\n      drawLineChart,\n      getCommonYears,\n      formatValue,\n      addTooltip,\n      setupResizeObserver,\n      ref,\n      onMounted,\n      watch,\n      computed,\n      nextTick,\n      onBeforeUnmount,\n      get d3() {\n        return d3;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","watch","computed","nextTick","onBeforeUnmount","d3","props","__props","emit","__emit","chartContainer","svg","tooltip","resizeObserver","containerSize","width","maxWidth","height","maxHeight","updateContainerSize","value","Math","min","clientWidth","clientHeight","innerWidth","max","margin","left","right","innerHeight","top","bottom","processedData","Array","isArray","data","determinedChartType","filter","item","type","map","name","color","getPercentageColor","undefined","isNaN","sort","a","b","year","chartType","percentageItems","length","hue","hasData","noDataMessage","initChart","select","selectAll","remove","append","attr","chart","drawPieChart","drawBarChart","drawLineChart","radius","pie","d","arc","innerRadius","outerRadius","arcs","centerX","centerY","enter","i","schemeCategory10","showTooltip","fullscreenMode","labelArc","centroid","text","percent","endAngle","startAngle","PI","toFixed","style","on","event","tooltipText","node","querySelectorAll","bbox","getBBox","bbox2","tooltipWidth","tooltipHeight","x","y","pointer","xScale","scaleBand","domain","toString","range","paddingInner","paddingOuter","calculatedWidth","bandwidth","barWidth","maxBarWidth","adjustedPadding","adjustedXScale","maxValue","yScale","scaleLinear","lineColor","formatValue","years","extent","values","minValue","padding","lineGenerator","line","curve","curveType","showDots","dotColor","compareData","showYearMarkers","commonYears","getCommonYears","forEach","points","point","highlightColor","addTooltip","data1","data2","years1","Set","years2","has","toLocaleString","referenceLine","mouseX","invert","closest","least","abs","setupResizeObserver","disconnect","ResizeObserver","observe","deep","__expose"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/compoents_base/SparklineChart.vue"],"sourcesContent":["<template>\r\n\t<div ref=\"chartContainer\" class=\"sparkline-container\">\r\n\t\t<div v-if=\"!hasData\" class=\"no-data-message\">\r\n\t\t\t{{ noDataMessage }}\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tonMounted,\r\n\t\twatch,\r\n\t\tcomputed,\r\n\t\tnextTick,\r\n\t\tonBeforeUnmount\r\n\t} from \"vue\";\r\n\timport * as d3 from \"d3\";\r\n\r\n\tconst props = defineProps({\r\n\t\tdata: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => [],\r\n\t\t\tvalidator: value => Array.isArray(value)\r\n\t\t},\r\n\t\tcompareData: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\tchartType: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"auto\", // auto, line, bar, pie\r\n\t\t\tvalidator: value => [\"auto\", \"line\", \"bar\", \"pie\"].includes(value)\r\n\t\t},\r\n\t\tmaxWidth: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 250\r\n\t\t},\r\n\t\tmaxHeight: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 80\r\n\t\t},\r\n\t\tmargin: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: () => ({ top: 5, right: 5, bottom: 5, left: 5 })\r\n\t\t},\r\n\t\tlineColor: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"#4a90e2\"\r\n\t\t},\r\n\t\tareaColor: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"#4a90e2\"\r\n\t\t},\r\n\t\tdotColor: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"#4a90e2\"\r\n\t\t},\r\n\t\thighlightColor: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"#FFD700\"\r\n\t\t},\r\n\t\tshowTooltip: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tshowDots: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tshowArea: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tshowYearMarkers: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tcurveType: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"curveMonotoneX\"\r\n\t\t},\r\n\t\tmaxBarWidth: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 60\r\n\t\t},\r\n\t\tfullscreenMode: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t});\r\n\r\n\tconst emit = defineEmits([\"chart-mounted\"]);\r\n\r\n\tconst chartContainer = ref(null);\r\n\tconst svg = ref(null);\r\n\tconst tooltip = ref(null);\r\n\tconst resizeObserver = ref(null);\r\n\tconst containerSize = ref({\r\n\t\twidth: props.maxWidth,\r\n\t\theight: props.maxHeight\r\n\t});\r\n\r\n\tconst updateContainerSize = () => {\r\n\t\tif (chartContainer.value) {\r\n\t\t\tcontainerSize.value = {\r\n\t\t\t\twidth: Math.min(chartContainer.value.clientWidth, props.maxWidth),\r\n\t\t\t\theight: Math.min(\r\n\t\t\t\t\tchartContainer.value.clientHeight || props.maxHeight,\r\n\t\t\t\t\tprops.maxHeight\r\n\t\t\t\t)\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n\r\n\tconst innerWidth = computed(() => {\r\n\t\treturn Math.max(\r\n\t\t\t10,\r\n\t\t\tcontainerSize.value.width - props.margin.left - props.margin.right\r\n\t\t);\r\n\t});\r\n\r\n\tconst innerHeight = computed(() => {\r\n\t\treturn Math.max(\r\n\t\t\t10,\r\n\t\t\tcontainerSize.value.height - props.margin.top - props.margin.bottom\r\n\t\t);\r\n\t});\r\n\r\n\tconst processedData = computed(() => {\r\n\t\tif (!Array.isArray(props.data)) return [];\r\n\r\n\t\t// 处理饼图数据\r\n\t\tif (determinedChartType.value === \"pie\") {\r\n\t\t\treturn props.data\r\n\t\t\t\t.filter(item => item.type === \"percentage\")\r\n\t\t\t\t.map(item => ({\r\n\t\t\t\t\tname: item.name,\r\n\t\t\t\t\tvalue: item.value,\r\n\t\t\t\t\tcolor: getPercentageColor(item.value)\r\n\t\t\t\t}));\r\n\t\t}\r\n\r\n\t\t// 处理柱状图/折线图数据\r\n\t\treturn props.data\r\n\t\t\t.filter(item => item.value !== undefined && !isNaN(item.value))\r\n\t\t\t.sort((a, b) => (a.year || 0) - (b.year || 0));\r\n\t});\r\n\r\n\t// 自动判断图表类型\r\n\tconst determinedChartType = computed(() => {\r\n\t\tif (props.chartType !== \"auto\") return props.chartType;\r\n\r\n\t\t// 如果有百分比数据且是主要类型\r\n\t\tconst percentageItems = props.data.filter(\r\n\t\t\titem => item.type === \"percentage\"\r\n\t\t);\r\n\t\tif (\r\n\t\t\tpercentageItems.length > 0 &&\r\n\t\t\tpercentageItems.length / props.data.length > 0.3\r\n\t\t) {\r\n\t\t\treturn \"pie\";\r\n\t\t}\r\n\r\n\t\t// 少量数据用柱状图\r\n\t\tif (props.data.length <= 3) return \"bar\";\r\n\r\n\t\t// 默认折线图\r\n\t\treturn \"line\";\r\n\t});\r\n\r\n\t// 饼图颜色生成\r\n\tfunction getPercentageColor(value) {\r\n\t\tconst hue = (1 - value / 100) * 120; // 从绿色(0)到红色(120)\r\n\t\treturn `hsl(${hue}, 70%, 60%)`;\r\n\t}\r\n\r\n\tconst hasData = computed(() => processedData.value.length > 0);\r\n\tconst noDataMessage = computed(() => \"无数据\");\r\n\r\n\tconst initChart = () => {\r\n\t\tif (!chartContainer.value) return;\r\n\r\n\t\tupdateContainerSize();\r\n\r\n\t\td3.select(chartContainer.value).selectAll(\"*\").remove();\r\n\t\tif (!hasData.value) return;\r\n\r\n\t\tsvg.value = d3\r\n\t\t\t.select(chartContainer.value)\r\n\t\t\t.append(\"svg\")\r\n\t\t\t.attr(\"width\", containerSize.value.width)\r\n\t\t\t.attr(\"height\", containerSize.value.height)\r\n\t\t\t.attr(\r\n\t\t\t\t\"viewBox\",\r\n\t\t\t\t`0 0 ${containerSize.value.width} ${containerSize.value.height}`\r\n\t\t\t)\r\n\t\t\t.attr(\"preserveAspectRatio\", \"xMidYMid meet\");\r\n\r\n\t\tconst chart = svg.value\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\"transform\", `translate(${props.margin.left},${props.margin.top})`);\r\n\r\n\t\tswitch (determinedChartType.value) {\r\n\t\t\tcase \"pie\":\r\n\t\t\t\tdrawPieChart(chart);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"bar\":\r\n\t\t\t\tdrawBarChart(chart);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"line\":\r\n\t\t\tdefault:\r\n\t\t\t\tdrawLineChart(chart);\r\n\t\t}\r\n\r\n\t\temit(\"chart-mounted\", {\r\n\t\t\tchartType: determinedChartType.value\r\n\t\t});\r\n\t};\r\n\r\n\tconst drawPieChart = chart => {\r\n\t\tconst radius = Math.min(innerWidth.value, innerHeight.value) / 2;\r\n\t\tconst pie = d3\r\n\t\t\t.pie()\r\n\t\t\t.value(d => d.value)\r\n\t\t\t.sort(null);\r\n\r\n\t\tconst arc = d3.arc().innerRadius(0).outerRadius(radius);\r\n\r\n\t\tconst arcs = pie(processedData.value);\r\n\r\n\t\t// 中心位置\r\n\t\tconst centerX = innerWidth.value / 2;\r\n\t\tconst centerY = innerHeight.value / 2;\r\n\r\n\t\t// 绘制扇形\r\n\t\tchart\r\n\t\t\t.selectAll(\".arc\")\r\n\t\t\t.data(arcs)\r\n\t\t\t.enter()\r\n\t\t\t.append(\"path\")\r\n\t\t\t.attr(\"class\", \"arc\")\r\n\t\t\t.attr(\"d\", arc)\r\n\t\t\t.attr(\"fill\", (d, i) => d.data.color || d3.schemeCategory10[i % 10])\r\n\t\t\t.attr(\"transform\", `translate(${centerX},${centerY})`);\r\n\r\n\t\t// 添加标签\r\n\t\tif (props.showTooltip && !props.fullscreenMode) {\r\n\t\t\tconst labelArc = d3\r\n\t\t\t\t.arc()\r\n\t\t\t\t.outerRadius(radius - 10)\r\n\t\t\t\t.innerRadius(radius - 10);\r\n\r\n\t\t\tchart\r\n\t\t\t\t.selectAll(\".pie-label\")\r\n\t\t\t\t.data(arcs)\r\n\t\t\t\t.enter()\r\n\t\t\t\t.append(\"text\")\r\n\t\t\t\t.attr(\"class\", \"pie-label\")\r\n\t\t\t\t.attr(\"transform\", d => `translate(${labelArc.centroid(d)})`)\r\n\t\t\t\t.attr(\"dy\", \"0.35em\")\r\n\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t.text(d => {\r\n\t\t\t\t\tconst percent = ((d.endAngle - d.startAngle) / (2 * Math.PI)) * 100;\r\n\t\t\t\t\treturn percent > 10 ? `${d.data.name}: ${percent.toFixed(1)}%` : \"\";\r\n\t\t\t\t})\r\n\t\t\t\t.attr(\"font-size\", \"10px\")\r\n\t\t\t\t.attr(\"fill\", \"#fff\")\r\n\t\t\t\t.attr(\r\n\t\t\t\t\t\"transform\",\r\n\t\t\t\t\td =>\r\n\t\t\t\t\t\t`translate(${arc.centroid(d)[0] + centerX},${\r\n\t\t\t\t\t\t\tarc.centroid(d)[1] + centerY\r\n\t\t\t\t\t\t})`\r\n\t\t\t\t);\r\n\t\t}\r\n\r\n\t\t// 添加tooltip\r\n\t\tif (props.showTooltip) {\r\n\t\t\tconst tooltip = chart\r\n\t\t\t\t.append(\"g\")\r\n\t\t\t\t.attr(\"class\", \"tooltip\")\r\n\t\t\t\t.style(\"opacity\", 0);\r\n\r\n\t\t\ttooltip\r\n\t\t\t\t.append(\"rect\")\r\n\t\t\t\t.attr(\"class\", \"tooltip-box\")\r\n\t\t\t\t.attr(\"rx\", 4)\r\n\t\t\t\t.attr(\"ry\", 4);\r\n\r\n\t\t\ttooltip\r\n\t\t\t\t.append(\"text\")\r\n\t\t\t\t.attr(\"class\", \"tooltip-name\")\r\n\t\t\t\t.attr(\"x\", 6)\r\n\t\t\t\t.attr(\"y\", 18);\r\n\r\n\t\t\ttooltip\r\n\t\t\t\t.append(\"text\")\r\n\t\t\t\t.attr(\"class\", \"tooltip-value\")\r\n\t\t\t\t.attr(\"x\", 6)\r\n\t\t\t\t.attr(\"y\", 36);\r\n\r\n\t\t\tchart\r\n\t\t\t\t.selectAll(\".arc\")\r\n\t\t\t\t.on(\"mouseover\", function (event, d) {\r\n\t\t\t\t\ttooltip.style(\"opacity\", 1);\r\n\r\n\t\t\t\t\ttooltip.select(\".tooltip-name\").text(`项目: ${d.data.name}`);\r\n\t\t\t\t\ttooltip\r\n\t\t\t\t\t\t.select(\".tooltip-value\")\r\n\t\t\t\t\t\t.text(\r\n\t\t\t\t\t\t\t`值: ${d.data.value} (${(\r\n\t\t\t\t\t\t\t\t((d.endAngle - d.startAngle) / (2 * Math.PI)) *\r\n\t\t\t\t\t\t\t\t100\r\n\t\t\t\t\t\t\t).toFixed(1)}%)`\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\tconst tooltipText = tooltip.node().querySelectorAll(\"text\");\r\n\t\t\t\t\tconst bbox = tooltipText[0].getBBox();\r\n\t\t\t\t\tconst bbox2 = tooltipText[1].getBBox();\r\n\t\t\t\t\tconst tooltipWidth = Math.max(bbox.width, bbox2.width) + 12;\r\n\t\t\t\t\tconst tooltipHeight = bbox.height + bbox2.height + 16;\r\n\r\n\t\t\t\t\tconst [x, y] = d3.pointer(event);\r\n\r\n\t\t\t\t\ttooltip\r\n\t\t\t\t\t\t.select(\".tooltip-box\")\r\n\t\t\t\t\t\t.attr(\"x\", x)\r\n\t\t\t\t\t\t.attr(\"y\", y - tooltipHeight)\r\n\t\t\t\t\t\t.attr(\"width\", tooltipWidth)\r\n\t\t\t\t\t\t.attr(\"height\", tooltipHeight);\r\n\r\n\t\t\t\t\ttooltip\r\n\t\t\t\t\t\t.select(\".tooltip-name\")\r\n\t\t\t\t\t\t.attr(\"x\", x + 6)\r\n\t\t\t\t\t\t.attr(\"y\", y - tooltipHeight + 18);\r\n\r\n\t\t\t\t\ttooltip\r\n\t\t\t\t\t\t.select(\".tooltip-value\")\r\n\t\t\t\t\t\t.attr(\"x\", x + 6)\r\n\t\t\t\t\t\t.attr(\"y\", y - tooltipHeight + 36);\r\n\t\t\t\t})\r\n\t\t\t\t.on(\"mouseout\", () => {\r\n\t\t\t\t\ttooltip.style(\"opacity\", 0);\r\n\t\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst drawBarChart = chart => {\r\n\t\tconst xScale = d3\r\n\t\t\t.scaleBand()\r\n\t\t\t.domain(processedData.value.map(d => d.year.toString()))\r\n\t\t\t.range([0, innerWidth.value])\r\n\t\t\t.paddingInner(0.4)\r\n\t\t\t.paddingOuter(0.2);\r\n\r\n\t\tconst calculatedWidth = xScale.bandwidth();\r\n\t\tconst barWidth = Math.min(calculatedWidth, props.maxBarWidth);\r\n\t\tconst adjustedPadding =\r\n\t\t\t(innerWidth.value - barWidth * processedData.value.length) /\r\n\t\t\t(processedData.value.length + 1);\r\n\r\n\t\tconst adjustedXScale = d3\r\n\t\t\t.scaleBand()\r\n\t\t\t.domain(processedData.value.map(d => d.year.toString()))\r\n\t\t\t.range([0, innerWidth.value])\r\n\t\t\t.paddingInner(adjustedPadding / barWidth)\r\n\t\t\t.paddingOuter(adjustedPadding / barWidth);\r\n\r\n\t\tconst maxValue = d3.max(processedData.value, d => d.value);\r\n\t\tconst yScale = d3\r\n\t\t\t.scaleLinear()\r\n\t\t\t.domain([0, maxValue * 1.1])\r\n\t\t\t.range([innerHeight.value, 0]);\r\n\r\n\t\tchart\r\n\t\t\t.selectAll(\".bar\")\r\n\t\t\t.data(processedData.value)\r\n\t\t\t.enter()\r\n\t\t\t.append(\"rect\")\r\n\t\t\t.attr(\"class\", \"bar\")\r\n\t\t\t.attr(\r\n\t\t\t\t\"x\",\r\n\t\t\t\td =>\r\n\t\t\t\t\tadjustedXScale(d.year.toString()) +\r\n\t\t\t\t\t(adjustedXScale.bandwidth() - barWidth) / 2\r\n\t\t\t)\r\n\t\t\t.attr(\"width\", barWidth)\r\n\t\t\t.attr(\"y\", d => yScale(d.value))\r\n\t\t\t.attr(\"height\", d => innerHeight.value - yScale(d.value))\r\n\t\t\t.attr(\"fill\", props.lineColor)\r\n\t\t\t.attr(\"rx\", 2)\r\n\t\t\t.attr(\"ry\", 2);\r\n\r\n\t\tif (props.showTooltip) {\r\n\t\t\tchart\r\n\t\t\t\t.selectAll(\".bar-label\")\r\n\t\t\t\t.data(processedData.value)\r\n\t\t\t\t.enter()\r\n\t\t\t\t.append(\"text\")\r\n\t\t\t\t.attr(\"class\", \"bar-label\")\r\n\t\t\t\t.attr(\r\n\t\t\t\t\t\"x\",\r\n\t\t\t\t\td =>\r\n\t\t\t\t\t\tadjustedXScale(d.year.toString()) + adjustedXScale.bandwidth() / 2\r\n\t\t\t\t)\r\n\t\t\t\t.attr(\"y\", d => yScale(d.value) - 5)\r\n\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t.text(d => formatValue(d.value))\r\n\t\t\t\t.attr(\"font-size\", \"10px\")\r\n\t\t\t\t.attr(\"fill\", \"#64748b\")\r\n\t\t\t\t.style(\"visibility\", d =>\r\n\t\t\t\t\tinnerHeight.value - yScale(d.value) > 20 ? \"visible\" : \"hidden\"\r\n\t\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tconst drawLineChart = chart => {\r\n\t\tconst years = processedData.value.map(d => d.year);\r\n\t\tconst xScale = d3\r\n\t\t\t.scaleLinear()\r\n\t\t\t.domain(d3.extent(years))\r\n\t\t\t.range([0, innerWidth.value]);\r\n\r\n\t\tconst values = processedData.value.map(d => d.value);\r\n\t\tconst minValue = d3.min(values);\r\n\t\tconst maxValue = d3.max(values);\r\n\t\tconst padding = (maxValue - minValue) * 0.1;\r\n\r\n\t\tconst yScale = d3\r\n\t\t\t.scaleLinear()\r\n\t\t\t.domain([minValue - padding, maxValue + padding])\r\n\t\t\t.range([innerHeight.value, 0]);\r\n\r\n\t\tconst lineGenerator = d3\r\n\t\t\t.line()\r\n\t\t\t.x(d => xScale(d.year))\r\n\t\t\t.y(d => yScale(d.value))\r\n\t\t\t.curve(d3[props.curveType]);\r\n\r\n\t\tchart\r\n\t\t\t.append(\"path\")\r\n\t\t\t.attr(\"class\", \"sparkline-line\")\r\n\t\t\t.attr(\"d\", lineGenerator(processedData.value))\r\n\t\t\t.attr(\"stroke\", props.lineColor)\r\n\t\t\t.attr(\"stroke-width\", 2)\r\n\t\t\t.attr(\"fill\", \"none\");\r\n\r\n\t\tif (props.showDots) {\r\n\t\t\tchart\r\n\t\t\t\t.selectAll(\".sparkline-dot\")\r\n\t\t\t\t.data(processedData.value)\r\n\t\t\t\t.enter()\r\n\t\t\t\t.append(\"circle\")\r\n\t\t\t\t.attr(\"class\", \"sparkline-dot\")\r\n\t\t\t\t.attr(\"cx\", d => xScale(d.year))\r\n\t\t\t\t.attr(\"cy\", d => yScale(d.value))\r\n\t\t\t\t.attr(\"r\", 3)\r\n\t\t\t\t.attr(\"fill\", props.dotColor);\r\n\t\t}\r\n\r\n\t\tif (props.compareData && props.showYearMarkers) {\r\n\t\t\tconst commonYears = getCommonYears(\r\n\t\t\t\tprocessedData.value,\r\n\t\t\t\tprops.compareData\r\n\t\t\t);\r\n\t\t\tcommonYears.forEach(year => {\r\n\t\t\t\tconst points = processedData.value.filter(d => d.year === year);\r\n\t\t\t\tpoints.forEach(point => {\r\n\t\t\t\t\tchart\r\n\t\t\t\t\t\t.append(\"circle\")\r\n\t\t\t\t\t\t.attr(\"cx\", xScale(point.year))\r\n\t\t\t\t\t\t.attr(\"cy\", yScale(point.value))\r\n\t\t\t\t\t\t.attr(\"r\", 5)\r\n\t\t\t\t\t\t.attr(\"fill\", props.highlightColor)\r\n\t\t\t\t\t\t.attr(\"stroke\", \"#FF8C00\")\r\n\t\t\t\t\t\t.attr(\"stroke-width\", 1.5)\r\n\t\t\t\t\t\t.attr(\"class\", \"highlight-point\");\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (props.showTooltip) {\r\n\t\t\taddTooltip(chart, xScale, yScale);\r\n\t\t}\r\n\t};\r\n\r\n\tconst getCommonYears = (data1, data2) => {\r\n\t\tconst years1 = new Set(data1.map(d => d.year));\r\n\t\tconst years2 = new Set(data2.filter(d => d).map(d => d.year));\r\n\t\treturn [...years1].filter(year => years2.has(year));\r\n\t};\r\n\r\n\tconst formatValue = value => {\r\n\t\tif (value >= 1000000) return `$${(value / 1000000).toFixed(1)}M`;\r\n\t\tif (value >= 1000) return `$${(value / 1000).toFixed(1)}K`;\r\n\t\treturn value.toLocaleString();\r\n\t};\r\n\r\n\tconst addTooltip = (chart, xScale, yScale) => {\r\n\t\ttooltip.value = chart\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\"class\", \"tooltip\")\r\n\t\t\t.style(\"opacity\", 0)\r\n\t\t\t.attr(\"pointer-events\", \"none\");\r\n\r\n\t\ttooltip.value\r\n\t\t\t.append(\"rect\")\r\n\t\t\t.attr(\"class\", \"tooltip-box\")\r\n\t\t\t.attr(\"rx\", 4)\r\n\t\t\t.attr(\"ry\", 4);\r\n\r\n\t\ttooltip.value\r\n\t\t\t.append(\"text\")\r\n\t\t\t.attr(\"class\", \"tooltip-year\")\r\n\t\t\t.attr(\"x\", 6)\r\n\t\t\t.attr(\"y\", 18);\r\n\r\n\t\ttooltip.value\r\n\t\t\t.append(\"text\")\r\n\t\t\t.attr(\"class\", \"tooltip-value\")\r\n\t\t\t.attr(\"x\", 6)\r\n\t\t\t.attr(\"y\", 36);\r\n\r\n\t\tconst referenceLine = chart\r\n\t\t\t.append(\"line\")\r\n\t\t\t.attr(\"class\", \"reference-line\")\r\n\t\t\t.attr(\"stroke\", \"#64748b\")\r\n\t\t\t.attr(\"stroke-width\", 1)\r\n\t\t\t.attr(\"stroke-dasharray\", \"2,2\")\r\n\t\t\t.attr(\"y1\", 0)\r\n\t\t\t.attr(\"y2\", innerHeight.value)\r\n\t\t\t.style(\"opacity\", 0);\r\n\r\n\t\tchart\r\n\t\t\t.append(\"rect\")\r\n\t\t\t.attr(\"class\", \"overlay\")\r\n\t\t\t.attr(\"width\", innerWidth.value)\r\n\t\t\t.attr(\"height\", innerHeight.value)\r\n\t\t\t.attr(\"fill\", \"none\")\r\n\t\t\t.attr(\"pointer-events\", \"all\")\r\n\t\t\t.on(\"mouseover\", () => tooltip.value.style(\"opacity\", 1))\r\n\t\t\t.on(\"mouseout\", () => {\r\n\t\t\t\ttooltip.value.style(\"opacity\", 0);\r\n\t\t\t\treferenceLine.style(\"opacity\", 0);\r\n\t\t\t})\r\n\t\t\t.on(\"mousemove\", event => {\r\n\t\t\t\tconst [mouseX] = d3.pointer(event);\r\n\t\t\t\tconst year = xScale.invert(mouseX);\r\n\t\t\t\tconst closest = d3.least(processedData.value, d =>\r\n\t\t\t\t\tMath.abs(xScale(d.year) - mouseX)\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (!closest) return;\r\n\r\n\t\t\t\treferenceLine\r\n\t\t\t\t\t.attr(\"x1\", xScale(closest.year))\r\n\t\t\t\t\t.attr(\"x2\", xScale(closest.year))\r\n\t\t\t\t\t.style(\"opacity\", 1);\r\n\r\n\t\t\t\ttooltip.value.select(\".tooltip-year\").text(`Year: ${closest.year}`);\r\n\t\t\t\ttooltip.value\r\n\t\t\t\t\t.select(\".tooltip-value\")\r\n\t\t\t\t\t.text(`Value: ${formatValue(closest.value)}`);\r\n\r\n\t\t\t\tconst tooltipText = tooltip.value.node().querySelectorAll(\"text\");\r\n\t\t\t\tconst bbox = tooltipText[0].getBBox();\r\n\t\t\t\tconst bbox2 = tooltipText[1].getBBox();\r\n\t\t\t\tconst tooltipWidth = Math.max(bbox.width, bbox2.width) + 12;\r\n\t\t\t\tconst tooltipHeight = bbox.height + bbox2.height + 16;\r\n\r\n\t\t\t\tlet x = xScale(closest.year) + 10;\r\n\t\t\t\tlet y = yScale(closest.value) - tooltipHeight / 2;\r\n\r\n\t\t\t\tif (x + tooltipWidth > innerWidth.value) {\r\n\t\t\t\t\tx = xScale(closest.year) - tooltipWidth - 10;\r\n\t\t\t\t}\r\n\t\t\t\ty = Math.max(0, Math.min(y, innerHeight.value - tooltipHeight));\r\n\r\n\t\t\t\ttooltip.value\r\n\t\t\t\t\t.select(\".tooltip-box\")\r\n\t\t\t\t\t.attr(\"x\", x)\r\n\t\t\t\t\t.attr(\"y\", y)\r\n\t\t\t\t\t.attr(\"width\", tooltipWidth)\r\n\t\t\t\t\t.attr(\"height\", tooltipHeight);\r\n\r\n\t\t\t\ttooltip.value\r\n\t\t\t\t\t.select(\".tooltip-year\")\r\n\t\t\t\t\t.attr(\"x\", x + 6)\r\n\t\t\t\t\t.attr(\"y\", y + 18);\r\n\r\n\t\t\t\ttooltip.value\r\n\t\t\t\t\t.select(\".tooltip-value\")\r\n\t\t\t\t\t.attr(\"x\", x + 6)\r\n\t\t\t\t\t.attr(\"y\", y + 36);\r\n\t\t\t});\r\n\t};\r\n\r\n\tconst setupResizeObserver = () => {\r\n\t\tif (resizeObserver.value) {\r\n\t\t\tresizeObserver.value.disconnect();\r\n\t\t}\r\n\r\n\t\tif (chartContainer.value) {\r\n\t\t\tresizeObserver.value = new ResizeObserver(() => {\r\n\t\t\t\tnextTick(() => {\r\n\t\t\t\t\tupdateContainerSize();\r\n\t\t\t\t\tinitChart();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tresizeObserver.value.observe(chartContainer.value);\r\n\t\t}\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tsetupResizeObserver();\r\n\t\tinitChart();\r\n\t});\r\n\r\n\tonBeforeUnmount(() => {\r\n\t\tif (resizeObserver.value) {\r\n\t\t\tresizeObserver.value.disconnect();\r\n\t\t}\r\n\t});\r\n\r\n\twatch(\r\n\t\t() => [\r\n\t\t\tprops.data,\r\n\t\t\tprops.compareData,\r\n\t\t\tprops.chartType,\r\n\t\t\tprops.maxWidth,\r\n\t\t\tprops.maxHeight,\r\n\t\t\tprops.margin,\r\n\t\t\tprops.lineColor,\r\n\t\t\tprops.highlightColor,\r\n\t\t\tprops.showTooltip,\r\n\t\t\tprops.showDots,\r\n\t\t\tprops.showYearMarkers,\r\n\t\t\tprops.curveType,\r\n\t\t\tprops.maxBarWidth,\r\n\t\t\tprops.fullscreenMode\r\n\t\t],\r\n\t\tinitChart,\r\n\t\t{ deep: true }\r\n\t);\r\n\r\n\tdefineExpose({\r\n\t\tchartType: determinedChartType\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.sparkline-container {\r\n\t\tposition: relative;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-width: 100px;\r\n\t\tmin-height: 60px;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.no-data-message {\r\n\t\tposition: absolute;\r\n\t\ttop: 50%;\r\n\t\tleft: 50%;\r\n\t\ttransform: translate(-50%, -50%);\r\n\t\tcolor: #94a3b8;\r\n\t\tfont-size: 12px;\r\n\t\ttext-align: center;\r\n\t\twidth: 100%;\r\n\t\tpointer-events: none;\r\n\t}\r\n\r\n\t.sparkline-container :deep(svg) {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tdisplay: block;\r\n\t}\r\n\r\n\t.sparkline-container :deep(.tooltip-box) {\r\n\t\tfill: white;\r\n\t\tstroke: #e2e8f0;\r\n\t\tstroke-width: 1;\r\n\t\tfilter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));\r\n\t}\r\n\r\n\t.sparkline-container :deep(.tooltip-year),\r\n\t.sparkline-container :deep(.tooltip-name) {\r\n\t\tfont-size: 12px;\r\n\t\tfont-weight: bold;\r\n\t\tfill: #334155;\r\n\t}\r\n\r\n\t.sparkline-container :deep(.tooltip-value) {\r\n\t\tfont-size: 12px;\r\n\t\tfill: #1e40af;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.sparkline-container :deep(.reference-line) {\r\n\t\tpointer-events: none;\r\n\t}\r\n\r\n\t.sparkline-container :deep(.bar) {\r\n\t\ttransition: height 0.3s ease, y 0.3s ease;\r\n\t}\r\n\r\n\t.sparkline-container :deep(.bar-label) {\r\n\t\tpointer-events: none;\r\n\t\tfont-family: system-ui, -apple-system, sans-serif;\r\n\t}\r\n\r\n\t.sparkline-container :deep(.highlight-point) {\r\n\t\tanimation: pulse 1.5s infinite;\r\n\t}\r\n\r\n\t.sparkline-container :deep(.pie-label) {\r\n\t\tpointer-events: none;\r\n\t\ttext-shadow: 0 1px 1px rgba(0, 0, 0, 0.8);\r\n\t}\r\n\r\n\t@keyframes pulse {\r\n\t\t0% {\r\n\t\t\tr: 4;\r\n\t\t\topacity: 1;\r\n\t\t}\r\n\t\t50% {\r\n\t\t\tr: 6;\r\n\t\t\topacity: 0.8;\r\n\t\t}\r\n\t\t100% {\r\n\t\t\tr: 4;\r\n\t\t\topacity: 1;\r\n\t\t}\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}