{"ast":null,"code":"import { ref, onMounted, watch } from \"vue\";\nimport * as echarts from \"echarts\";\nexport default {\n  __name: 'BarChart',\n  props: {\n    current: {\n      type: Number,\n      required: true\n    },\n    // 当前值\n    total: {\n      type: Number,\n      default: 100\n    },\n    // 总量（参考基准）\n    title: {\n      type: String,\n      default: \"\"\n    },\n    // 主标题\n    subtext: {\n      type: String,\n      default: \"\"\n    },\n    // 副标题\n    unit: {\n      type: String,\n      default: \"\"\n    },\n    // 单位\n    color: {\n      type: String,\n      default: \"#36a2eb\"\n    } // 主色\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n    const chartEl = ref(null);\n    let chartInstance = null;\n    const initChart = () => {\n      if (!chartEl.value) return;\n\n      // 计算实际比例（防止超过100%）\n      const percentage = Math.min(props.current / props.total * 100, 100);\n      const remaining = 100 - percentage;\n      chartInstance = echarts.init(chartEl.value);\n      const option = {\n        title: {\n          text: `{name|${props.title}}\\n{value|${props.current.toFixed(1)}} {unit|${props.unit}}`,\n          subtext: props.subtext,\n          left: \"center\",\n          top: \"45%\",\n          textStyle: {\n            rich: {\n              name: {\n                fontSize: 14,\n                color: \"#666\",\n                padding: [5, 0]\n              },\n              value: {\n                fontSize: 24,\n                fontWeight: \"bold\",\n                color: \"#333\"\n              },\n              unit: {\n                fontSize: 14,\n                color: \"#999\"\n              }\n            }\n          }\n        },\n        tooltip: {\n          formatter: params => {\n            return `${params.seriesName}<br/>\n                ${params.name}: ${params.value.toFixed(1)}%<br/>\n                数值: ${props.current}${props.unit}`;\n          }\n        },\n        series: [{\n          name: \"完成比例\",\n          type: \"pie\",\n          radius: [\"65%\", \"85%\"],\n          silent: true,\n          // 禁用交互\n          clockwise: true,\n          startAngle: 90,\n          data: [{\n            value: percentage,\n            name: \"已完成\",\n            itemStyle: {\n              color: props.color,\n              shadowBlur: 10,\n              shadowColor: props.color\n            }\n          }, {\n            value: remaining,\n            name: \"剩余\",\n            itemStyle: {\n              color: \"#f0f0f0\",\n              borderWidth: 0\n            }\n          }],\n          label: {\n            show: false\n          },\n          emphasis: {\n            scale: false\n          }\n        }]\n      };\n      chartInstance.setOption(option);\n    };\n\n    // 响应式处理\n    onMounted(initChart);\n    watch(() => [props.current, props.total], initChart);\n    window.addEventListener(\"resize\", () => chartInstance?.resize());\n    const __returned__ = {\n      props,\n      chartEl,\n      get chartInstance() {\n        return chartInstance;\n      },\n      set chartInstance(v) {\n        chartInstance = v;\n      },\n      initChart,\n      ref,\n      onMounted,\n      watch,\n      get echarts() {\n        return echarts;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","watch","echarts","props","__props","chartEl","chartInstance","initChart","value","percentage","Math","min","current","total","remaining","init","option","title","text","toFixed","unit","subtext","left","top","textStyle","rich","name","fontSize","color","padding","fontWeight","tooltip","formatter","params","seriesName","series","type","radius","silent","clockwise","startAngle","data","itemStyle","shadowBlur","shadowColor","borderWidth","label","show","emphasis","scale","setOption","window","addEventListener","resize"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/compoents_base/charts/BarChart.vue"],"sourcesContent":["<template>\r\n\t<div ref=\"chartEl\" class=\"single-value-pie\"></div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted, watch } from \"vue\";\r\n\timport * as echarts from \"echarts\";\r\n\r\n\tconst props = defineProps({\r\n\t\tcurrent: { type: Number, required: true }, // 当前值\r\n\t\ttotal: { type: Number, default: 100 }, // 总量（参考基准）\r\n\t\ttitle: { type: String, default: \"\" }, // 主标题\r\n\t\tsubtext: { type: String, default: \"\" }, // 副标题\r\n\t\tunit: { type: String, default: \"\" }, // 单位\r\n\t\tcolor: { type: String, default: \"#36a2eb\" } // 主色\r\n\t});\r\n\r\n\tconst chartEl = ref(null);\r\n\tlet chartInstance = null;\r\n\r\n\tconst initChart = () => {\r\n\t\tif (!chartEl.value) return;\r\n\r\n\t\t// 计算实际比例（防止超过100%）\r\n\t\tconst percentage = Math.min((props.current / props.total) * 100, 100);\r\n\t\tconst remaining = 100 - percentage;\r\n\r\n\t\tchartInstance = echarts.init(chartEl.value);\r\n\r\n\t\tconst option = {\r\n\t\t\ttitle: {\r\n\t\t\t\ttext: `{name|${props.title}}\\n{value|${props.current.toFixed(\r\n\t\t\t\t\t1\r\n\t\t\t\t)}} {unit|${props.unit}}`,\r\n\t\t\t\tsubtext: props.subtext,\r\n\t\t\t\tleft: \"center\",\r\n\t\t\t\ttop: \"45%\",\r\n\t\t\t\ttextStyle: {\r\n\t\t\t\t\trich: {\r\n\t\t\t\t\t\tname: { fontSize: 14, color: \"#666\", padding: [5, 0] },\r\n\t\t\t\t\t\tvalue: { fontSize: 24, fontWeight: \"bold\", color: \"#333\" },\r\n\t\t\t\t\t\tunit: { fontSize: 14, color: \"#999\" }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttooltip: {\r\n\t\t\t\tformatter: params => {\r\n\t\t\t\t\treturn `${params.seriesName}<br/>\r\n                ${params.name}: ${params.value.toFixed(1)}%<br/>\r\n                数值: ${props.current}${props.unit}`;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tseries: [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: \"完成比例\",\r\n\t\t\t\t\ttype: \"pie\",\r\n\t\t\t\t\tradius: [\"65%\", \"85%\"],\r\n\t\t\t\t\tsilent: true, // 禁用交互\r\n\t\t\t\t\tclockwise: true,\r\n\t\t\t\t\tstartAngle: 90,\r\n\t\t\t\t\tdata: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvalue: percentage,\r\n\t\t\t\t\t\t\tname: \"已完成\",\r\n\t\t\t\t\t\t\titemStyle: {\r\n\t\t\t\t\t\t\t\tcolor: props.color,\r\n\t\t\t\t\t\t\t\tshadowBlur: 10,\r\n\t\t\t\t\t\t\t\tshadowColor: props.color\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvalue: remaining,\r\n\t\t\t\t\t\t\tname: \"剩余\",\r\n\t\t\t\t\t\t\titemStyle: {\r\n\t\t\t\t\t\t\t\tcolor: \"#f0f0f0\",\r\n\t\t\t\t\t\t\t\tborderWidth: 0\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tlabel: { show: false },\r\n\t\t\t\t\temphasis: { scale: false }\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tchartInstance.setOption(option);\r\n\t};\r\n\r\n\t// 响应式处理\r\n\tonMounted(initChart);\r\n\twatch(() => [props.current, props.total], initChart);\r\n\twindow.addEventListener(\"resize\", () => chartInstance?.resize());\r\n</script>\r\n\r\n<style scoped>\r\n\t.single-value-pie {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-height: 300px;\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}