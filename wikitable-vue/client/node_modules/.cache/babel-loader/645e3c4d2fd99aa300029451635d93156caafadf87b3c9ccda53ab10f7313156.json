{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-201e19b8\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"full-chart\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"combined-chart-container\"\n};\nconst _hoisted_3 = {\n  ref: \"combinedChartCanvas\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"single-chart-container\"\n};\nconst _hoisted_5 = {\n  ref: \"chartCanvas\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [$props.isCombined ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"canvas\", _hoisted_3, null, 512 /* NEED_PATCH */)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"canvas\", _hoisted_5, null, 512 /* NEED_PATCH */)]))]);\n}","map":{"version":3,"names":["class","key","ref","_createElementBlock","_hoisted_1","$props","isCombined","_hoisted_2","_createElementVNode","_hoisted_3","_hoisted_4","_hoisted_5"],"sources":["D:\\vue_frame\\vue_frame\\wikitable-vue\\client\\src\\components\\compoents_base\\FullChart.vue"],"sourcesContent":["<template>\r\n\t<div class=\"full-chart\">\r\n\t\t<div v-if=\"isCombined\" class=\"combined-chart-container\">\r\n\t\t\t<canvas ref=\"combinedChartCanvas\"></canvas>\r\n\t\t</div>\r\n\t\t<div v-else class=\"single-chart-container\">\r\n\t\t\t<canvas ref=\"chartCanvas\"></canvas>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted, watch, nextTick } from \"vue\";\r\n\timport Chart from \"chart.js/auto\";\r\n\r\n\tconst props = defineProps({\r\n\t\tfield: Object,\r\n\t\ttype: String,\r\n\t\tvisualization: String,\r\n\t\tisCombined: Boolean,\r\n\t\tleftTitle: String,\r\n\t\trightTitle: String\r\n\t});\r\n\r\n\tconst combinedChartCanvas = ref(null);\r\n\tconst chartCanvas = ref(null);\r\n\tlet chartInstance = null;\r\n\tlet combinedChartInstance = null;\r\n\r\n\tconst renderCombinedChart = () => {\r\n\t\tif (!combinedChartCanvas.value || !props.field) return;\r\n\r\n\t\tif (combinedChartInstance) {\r\n\t\t\tcombinedChartInstance.destroy();\r\n\t\t}\r\n\r\n\t\tconst ctx = combinedChartCanvas.value.getContext(\"2d\");\r\n\r\n\t\t// 准备合并图表数据\r\n\t\tconst chartData = {\r\n\t\t\tlabels: [\"对比数据\"],\r\n\t\t\tdatasets: [\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: props.leftTitle,\r\n\t\t\t\t\tdata: props.field.left.data,\r\n\t\t\t\t\tbackgroundColor: \"rgba(54, 162, 235, 0.5)\",\r\n\t\t\t\t\tborderColor: \"rgba(54, 162, 235, 1)\",\r\n\t\t\t\t\tborderWidth: 1\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: props.rightTitle,\r\n\t\t\t\t\tdata: props.field.right.data,\r\n\t\t\t\t\tbackgroundColor: \"rgba(255, 99, 132, 0.5)\",\r\n\t\t\t\t\tborderColor: \"rgba(255, 99, 132, 1)\",\r\n\t\t\t\t\tborderWidth: 1\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tcombinedChartInstance = new Chart(ctx, {\r\n\t\t\ttype: \"bar\",\r\n\t\t\tdata: chartData,\r\n\t\t\toptions: {\r\n\t\t\t\tresponsive: true,\r\n\t\t\t\tplugins: {\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\ttext: \"数据对比\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlegend: {\r\n\t\t\t\t\t\tposition: \"top\"\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tscales: {\r\n\t\t\t\t\ty: {\r\n\t\t\t\t\t\tbeginAtZero: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tconst renderSingleChart = () => {\r\n\t\tif (!chartCanvas.value || !props.field) return;\r\n\r\n\t\tif (chartInstance) {\r\n\t\t\tchartInstance.destroy();\r\n\t\t}\r\n\r\n\t\tconst ctx = chartCanvas.value.getContext(\"2d\");\r\n\r\n\t\t// 根据可视化类型渲染单图表\r\n\t\tlet chartType = \"bar\";\r\n\t\tif (props.visualization === \"pie-chart\") chartType = \"pie\";\r\n\t\telse if (props.visualization === \"line-chart\") chartType = \"line\";\r\n\r\n\t\tchartInstance = new Chart(ctx, {\r\n\t\t\ttype: chartType,\r\n\t\t\tdata: {\r\n\t\t\t\tlabels: Array.isArray(props.field)\r\n\t\t\t\t\t? props.field.map((_, i) => `数据${i + 1}`)\r\n\t\t\t\t\t: [\"数据\"],\r\n\t\t\t\tdatasets: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: props.typeLabel || \"数据\",\r\n\t\t\t\t\t\tdata: Array.isArray(props.field) ? props.field : [props.field],\r\n\t\t\t\t\t\tbackgroundColor: [\r\n\t\t\t\t\t\t\t\"rgba(255, 99, 132, 0.5)\",\r\n\t\t\t\t\t\t\t\"rgba(54, 162, 235, 0.5)\",\r\n\t\t\t\t\t\t\t\"rgba(255, 206, 86, 0.5)\",\r\n\t\t\t\t\t\t\t\"rgba(75, 192, 192, 0.5)\",\r\n\t\t\t\t\t\t\t\"rgba(153, 102, 255, 0.5)\",\r\n\t\t\t\t\t\t\t\"rgba(255, 159, 64, 0.5)\"\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tborderColor: [\r\n\t\t\t\t\t\t\t\"rgba(255, 99, 132, 1)\",\r\n\t\t\t\t\t\t\t\"rgba(54, 162, 235, 1)\",\r\n\t\t\t\t\t\t\t\"rgba(255, 206, 86, 1)\",\r\n\t\t\t\t\t\t\t\"rgba(75, 192, 192, 1)\",\r\n\t\t\t\t\t\t\t\"rgba(153, 102, 255, 1)\",\r\n\t\t\t\t\t\t\t\"rgba(255, 159, 64, 1)\"\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tborderWidth: 1\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\toptions: {\r\n\t\t\t\tresponsive: true,\r\n\t\t\t\tplugins: {\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\ttext: props.typeLabel || \"数据图表\"\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tscales: {\r\n\t\t\t\t\ty: {\r\n\t\t\t\t\t\tbeginAtZero: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tnextTick(() => {\r\n\t\t\tif (props.isCombined) {\r\n\t\t\t\trenderCombinedChart();\r\n\t\t\t} else {\r\n\t\t\t\trenderSingleChart();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\twatch(\r\n\t\t() => props.field,\r\n\t\t() => {\r\n\t\t\tnextTick(() => {\r\n\t\t\t\tif (props.isCombined) {\r\n\t\t\t\t\trenderCombinedChart();\r\n\t\t\t\t} else {\r\n\t\t\t\t\trenderSingleChart();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t{ deep: true }\r\n\t);\r\n\r\n\twatch(\r\n\t\t() => props.isCombined,\r\n\t\t() => {\r\n\t\t\tnextTick(() => {\r\n\t\t\t\tif (props.isCombined) {\r\n\t\t\t\t\trenderCombinedChart();\r\n\t\t\t\t} else {\r\n\t\t\t\t\trenderSingleChart();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t);\r\n</script>\r\n\r\n<style scoped>\r\n\t.full-chart {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.combined-chart-container,\r\n\t.single-chart-container {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-height: 400px;\r\n\t}\r\n\r\n\tcanvas {\r\n\t\twidth: 100% !important;\r\n\t\theight: 100% !important;\r\n\t}\r\n</style>\r\n"],"mappings":";;;EACMA,KAAK,EAAC;AAAY;;EADxBC,GAAA;EAEyBD,KAAK,EAAC;;;EACpBE,GAAG,EAAC;AAAqB;;EAHpCD,GAAA;EAKcD,KAAK,EAAC;;;EACTE,GAAG,EAAC;AAAa;;uBAL3BC,mBAAA,CAOM,OAPNC,UAOM,GANMC,MAAA,CAAAC,UAAU,I,cAArBH,mBAAA,CAEM,OAFNI,UAEM,GADLC,mBAAA,CAA2C,UAA3CC,UAA2C,8B,oBAE5CN,mBAAA,CAEM,OAFNO,UAEM,GADLF,mBAAA,CAAmC,UAAnCG,UAAmC,8B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}