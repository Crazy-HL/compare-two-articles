{"ast":null,"code":"import { ref, onMounted, onUnmounted, nextTick } from \"vue\";\nimport LoadingSpinner from \"./LoadingSpinner.vue\";\nimport ErrorDisplay from \"./ErrorDisplay.vue\";\nimport WikipediaContent from \"./WikipediaContent.vue\";\nimport { fetchWikipediaContent, injectWikipediaStyles } from \"@/js/apiUtils\";\nimport bus from \"@/js/eventBus.js\";\nimport * as d3 from \"d3\";\nimport { renderLineChart, renderBarChart, renderPieChart, renderNonVisualChart, renderRadarChart, renderStackedBarChart } from \"@/js/chartUtils\";\nexport default {\n  __name: 'MainComponent',\n  props: {\n    pageTitle: String,\n    divId: String,\n    selectContentClass: String\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n    const pageHtml = ref(\"\");\n    const loading = ref(true);\n    const error = ref(\"\");\n    const selectedText = ref({});\n    const showPopup = ref({});\n    const divRef = ref(null);\n    const currentView = ref(\"text\");\n    const visualizationLoading = ref(false);\n    const handleSelection = () => {\n      const selection = window.getSelection();\n      if (!selection.rangeCount) return;\n      const range = selection.getRangeAt(0);\n      const selectedHtml = range.cloneContents();\n      const tempDiv = document.createElement(\"div\");\n      tempDiv.appendChild(selectedHtml);\n      const table = tempDiv.querySelector(\"table\");\n      if (table) {\n        table.classList.add(\"custom-table\");\n        selectedText.value[props.divId] = tempDiv.innerHTML;\n      } else {\n        const text = selection.toString().trim();\n        if (!text) return;\n        selectedText.value[props.divId] = text;\n      }\n      showPopup.value[props.divId] = true;\n      currentView.value = \"text\";\n      // 传递选中内容\n      bus.emit(`${props.divId}Event`, {\n        content: selection.toString()\n      });\n      // 确保弹窗位置更新\n      nextTick(() => {\n        updatePopupPosition();\n      });\n    };\n    const closePopup = () => {\n      showPopup.value[props.divId] = false;\n      selectedText.value[props.divId] = \"\";\n      const container = props.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\n      d3.select(container).html(\"\");\n    };\n\n    // **切换视图**\n    const switchView = async view => {\n      currentView.value = view;\n      if (view === \"visual\") {\n        visualizationLoading.value = true; // 显示加载动画\n        await processText(); // 调用后端处理文本并渲染图表\n        visualizationLoading.value = false; // 隐藏加载动画\n      }\n    };\n\n    // 获取可视化 JSON 数据\n    async function processText() {\n      try {\n        api.post(\"process_text\", {\n          text: selectedText.value[props.divId].toString().trim()\n        },\n        // 使用对应 divId 的选中内容\n        data => {\n          if (data.error) {\n            console.error(\"后端返回的错误:\", data.error);\n            alert(`处理文章内容时出错: ${data.message}`);\n            return;\n          }\n          const jsonData = data.json_data;\n          console.log(\"后端返回的数据:\", jsonData);\n\n          // 根据 divId 选择容器\n          const container = props.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\n          if (data.data_type === \"Non-Visual\") {\n            renderNonVisualChart(container, data, {\n              message: \"当前数据无法可视化\"\n            });\n          } else {\n            renderChart(jsonData, data.chart_classification);\n          }\n        });\n      } catch (error) {\n        console.error(\"处理文章内容时出错:\", error);\n        alert(\"处理文章内容时出错，请稍后重试\");\n      }\n    }\n\n    // 渲染图表\n    function renderChart(rawJsonData, chartType) {\n      if (!rawJsonData || typeof rawJsonData !== \"object\" || !rawJsonData.data) {\n        const container = props.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\n        renderNonVisualChart(container, rawJsonData, {\n          message: \"JSON 数据无效\"\n        });\n        console.error(\"JSON 数据无效:\", rawJsonData);\n        return;\n      }\n\n      // 根据 divId 选择容器\n      const container = props.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\n\n      // 清空之前的图表\n      d3.select(container).html(\"\");\n      const data = rawJsonData.data;\n      const options = rawJsonData.options || {};\n\n      // 根据图表类型渲染\n      if (chartType === \"Line Chart\") {\n        renderLineChart(container, data, options);\n      } else if (chartType === \"Bar Chart\") {\n        renderBarChart(container, data, options);\n      } else if (chartType === \"Pie Chart\") {\n        renderPieChart(container, data, options);\n      } else if (chartType === \"Stacked Bar Chart\") {\n        renderStackedBarChart(container, data, options);\n      } else {\n        console.error(\"未知的图表类型:\", chartType);\n      }\n    }\n\n    // **更新遮罩层和弹出框的位置**\n    const updatePopupPosition = () => {\n      if (showPopup.value[props.divId] && divRef.value) {\n        const popup = divRef.value.querySelector(\".text-popup\");\n        const overlay = divRef.value.querySelector(\".overlay\");\n        if (popup && overlay) {\n          const rect = divRef.value.getBoundingClientRect();\n          const scrollTop = divRef.value.scrollTop;\n          const scrollLeft = divRef.value.scrollLeft;\n\n          // 动态调整遮罩层和弹出框的位置\n          overlay.style.top = `${scrollTop}px`;\n          overlay.style.left = `${scrollLeft}px`;\n          overlay.style.width = `${divRef.value.clientWidth}px`;\n          overlay.style.height = `${divRef.value.clientHeight}px`;\n          popup.style.top = `${rect.height / 2 + scrollTop}px`;\n          popup.style.left = `${rect.width / 2 + scrollLeft}px`;\n        }\n      }\n    };\n    onMounted(() => {\n      fetchWikipediaContent(props.pageTitle).then(html => {\n        pageHtml.value = html;\n        injectWikipediaStyles();\n      }).catch(err => {\n        error.value = err.message;\n      }).finally(() => {\n        loading.value = false;\n      });\n      if (divRef.value) {\n        divRef.value.addEventListener(\"mouseup\", handleSelection);\n      }\n      // 监听父容器滚动事件\n      if (divRef.value) {\n        divRef.value.addEventListener(\"scroll\", updatePopupPosition);\n      }\n    });\n    onUnmounted(() => {\n      if (divRef.value) {\n        divRef.value.removeEventListener(\"mouseup\", handleSelection);\n      }\n    });\n    const __returned__ = {\n      props,\n      pageHtml,\n      loading,\n      error,\n      selectedText,\n      showPopup,\n      divRef,\n      currentView,\n      visualizationLoading,\n      handleSelection,\n      closePopup,\n      switchView,\n      processText,\n      renderChart,\n      updatePopupPosition,\n      ref,\n      onMounted,\n      onUnmounted,\n      nextTick,\n      LoadingSpinner,\n      ErrorDisplay,\n      WikipediaContent,\n      get fetchWikipediaContent() {\n        return fetchWikipediaContent;\n      },\n      get injectWikipediaStyles() {\n        return injectWikipediaStyles;\n      },\n      get bus() {\n        return bus;\n      },\n      get d3() {\n        return d3;\n      },\n      get renderLineChart() {\n        return renderLineChart;\n      },\n      get renderBarChart() {\n        return renderBarChart;\n      },\n      get renderPieChart() {\n        return renderPieChart;\n      },\n      get renderNonVisualChart() {\n        return renderNonVisualChart;\n      },\n      get renderRadarChart() {\n        return renderRadarChart;\n      },\n      get renderStackedBarChart() {\n        return renderStackedBarChart;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","nextTick","LoadingSpinner","ErrorDisplay","WikipediaContent","fetchWikipediaContent","injectWikipediaStyles","bus","d3","renderLineChart","renderBarChart","renderPieChart","renderNonVisualChart","renderRadarChart","renderStackedBarChart","props","__props","pageHtml","loading","error","selectedText","showPopup","divRef","currentView","visualizationLoading","handleSelection","selection","window","getSelection","rangeCount","range","getRangeAt","selectedHtml","cloneContents","tempDiv","document","createElement","appendChild","table","querySelector","classList","add","value","divId","innerHTML","text","toString","trim","emit","content","updatePopupPosition","closePopup","container","select","html","switchView","view","processText","api","post","data","console","alert","message","jsonData","json_data","log","data_type","renderChart","chart_classification","rawJsonData","chartType","options","popup","overlay","rect","getBoundingClientRect","scrollTop","scrollLeft","style","top","left","width","clientWidth","height","clientHeight","pageTitle","then","catch","err","finally","addEventListener","removeEventListener"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/base/MainComponent.vue"],"sourcesContent":["<template>\r\n\t<div :class=\"['div0', selectContentClass]\" :id=\"divId\" ref=\"divRef\">\r\n\t\t<h1>{{ pageTitle }}</h1>\r\n\r\n\t\t<!-- 加载动画 -->\r\n\t\t<LoadingSpinner v-if=\"loading\" />\r\n\r\n\t\t<!-- 错误信息 -->\r\n\t\t<ErrorDisplay\r\n\t\t\tv-else-if=\"error\"\r\n\t\t\t:error=\"error\"\r\n\t\t\t@retry=\"fetchWikipediaContent\" />\r\n\r\n\t\t<!-- 文章内容 -->\r\n\t\t<WikipediaContent\r\n\t\t\tv-else\r\n\t\t\t:pageHtml=\"pageHtml\"\r\n\t\t\t@mouseup=\"handleSelection\"\r\n\t\t\t:divId=\"divId\"\r\n\t\t\t:showPopup=\"showPopup[divId]\"\r\n\t\t\t:selectedText=\"selectedText[divId]\"\r\n\t\t\t:currentView=\"currentView\"\r\n\t\t\t@closePopup=\"closePopup\"\r\n\t\t\t@switchView=\"switchView\"\r\n\t\t\t:visualizationLoading=\"visualizationLoading\"\r\n\t\t\t@update:visualizationLoading=\"visualizationLoading = $event\" />\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, onMounted, onUnmounted, nextTick } from \"vue\";\r\n\timport LoadingSpinner from \"./LoadingSpinner.vue\";\r\n\timport ErrorDisplay from \"./ErrorDisplay.vue\";\r\n\timport WikipediaContent from \"./WikipediaContent.vue\";\r\n\timport { fetchWikipediaContent, injectWikipediaStyles } from \"@/js/apiUtils\";\r\n\timport bus from \"@/js/eventBus.js\";\r\n\timport * as d3 from \"d3\";\r\n\timport {\r\n\t\trenderLineChart,\r\n\t\trenderBarChart,\r\n\t\trenderPieChart,\r\n\t\trenderNonVisualChart,\r\n\t\trenderRadarChart,\r\n\t\trenderStackedBarChart\r\n\t} from \"@/js/chartUtils\";\r\n\r\n\tconst props = defineProps({\r\n\t\tpageTitle: String,\r\n\t\tdivId: String,\r\n\t\tselectContentClass: String\r\n\t});\r\n\r\n\tconst pageHtml = ref(\"\");\r\n\tconst loading = ref(true);\r\n\tconst error = ref(\"\");\r\n\tconst selectedText = ref({});\r\n\tconst showPopup = ref({});\r\n\tconst divRef = ref(null);\r\n\tconst currentView = ref(\"text\");\r\n\tconst visualizationLoading = ref(false);\r\n\r\n\tconst handleSelection = () => {\r\n\t\tconst selection = window.getSelection();\r\n\t\tif (!selection.rangeCount) return;\r\n\r\n\t\tconst range = selection.getRangeAt(0);\r\n\t\tconst selectedHtml = range.cloneContents();\r\n\r\n\t\tconst tempDiv = document.createElement(\"div\");\r\n\t\ttempDiv.appendChild(selectedHtml);\r\n\r\n\t\tconst table = tempDiv.querySelector(\"table\");\r\n\t\tif (table) {\r\n\t\t\ttable.classList.add(\"custom-table\");\r\n\t\t\tselectedText.value[props.divId] = tempDiv.innerHTML;\r\n\t\t} else {\r\n\t\t\tconst text = selection.toString().trim();\r\n\t\t\tif (!text) return;\r\n\t\t\tselectedText.value[props.divId] = text;\r\n\t\t}\r\n\r\n\t\tshowPopup.value[props.divId] = true;\r\n\t\tcurrentView.value = \"text\";\r\n\t\t// 传递选中内容\r\n\t\tbus.emit(`${props.divId}Event`, { content: selection.toString() });\r\n\t\t// 确保弹窗位置更新\r\n\t\tnextTick(() => {\r\n\t\t\tupdatePopupPosition();\r\n\t\t});\r\n\t};\r\n\r\n\tconst closePopup = () => {\r\n\t\tshowPopup.value[props.divId] = false;\r\n\t\tselectedText.value[props.divId] = \"\";\r\n\r\n\t\tconst container =\r\n\t\t\tprops.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\r\n\t\td3.select(container).html(\"\");\r\n\t};\r\n\r\n\t// **切换视图**\r\n\tconst switchView = async view => {\r\n\t\tcurrentView.value = view;\r\n\t\tif (view === \"visual\") {\r\n\t\t\tvisualizationLoading.value = true; // 显示加载动画\r\n\t\t\tawait processText(); // 调用后端处理文本并渲染图表\r\n\t\t\tvisualizationLoading.value = false; // 隐藏加载动画\r\n\t\t}\r\n\t};\r\n\r\n\t// 获取可视化 JSON 数据\r\n\tasync function processText() {\r\n\t\ttry {\r\n\t\t\tapi.post(\r\n\t\t\t\t\"process_text\",\r\n\t\t\t\t{ text: selectedText.value[props.divId].toString().trim() }, // 使用对应 divId 的选中内容\r\n\t\t\t\tdata => {\r\n\t\t\t\t\tif (data.error) {\r\n\t\t\t\t\t\tconsole.error(\"后端返回的错误:\", data.error);\r\n\t\t\t\t\t\talert(`处理文章内容时出错: ${data.message}`);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst jsonData = data.json_data;\r\n\t\t\t\t\tconsole.log(\"后端返回的数据:\", jsonData);\r\n\r\n\t\t\t\t\t// 根据 divId 选择容器\r\n\t\t\t\t\tconst container =\r\n\t\t\t\t\t\tprops.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\r\n\r\n\t\t\t\t\tif (data.data_type === \"Non-Visual\") {\r\n\t\t\t\t\t\trenderNonVisualChart(container, data, {\r\n\t\t\t\t\t\t\tmessage: \"当前数据无法可视化\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trenderChart(jsonData, data.chart_classification);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"处理文章内容时出错:\", error);\r\n\t\t\talert(\"处理文章内容时出错，请稍后重试\");\r\n\t\t}\r\n\t}\r\n\r\n\t// 渲染图表\r\n\tfunction renderChart(rawJsonData, chartType) {\r\n\t\tif (!rawJsonData || typeof rawJsonData !== \"object\" || !rawJsonData.data) {\r\n\t\t\tconst container =\r\n\t\t\t\tprops.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\r\n\t\t\trenderNonVisualChart(container, rawJsonData, {\r\n\t\t\t\tmessage: \"JSON 数据无效\"\r\n\t\t\t});\r\n\t\t\tconsole.error(\"JSON 数据无效:\", rawJsonData);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// 根据 divId 选择容器\r\n\t\tconst container =\r\n\t\t\tprops.divId === \"div1\" ? \".chart-container1\" : \".chart-container2\";\r\n\r\n\t\t// 清空之前的图表\r\n\t\td3.select(container).html(\"\");\r\n\r\n\t\tconst data = rawJsonData.data;\r\n\t\tconst options = rawJsonData.options || {};\r\n\r\n\t\t// 根据图表类型渲染\r\n\t\tif (chartType === \"Line Chart\") {\r\n\t\t\trenderLineChart(container, data, options);\r\n\t\t} else if (chartType === \"Bar Chart\") {\r\n\t\t\trenderBarChart(container, data, options);\r\n\t\t} else if (chartType === \"Pie Chart\") {\r\n\t\t\trenderPieChart(container, data, options);\r\n\t\t} else if (chartType === \"Stacked Bar Chart\") {\r\n\t\t\trenderStackedBarChart(container, data, options);\r\n\t\t} else {\r\n\t\t\tconsole.error(\"未知的图表类型:\", chartType);\r\n\t\t}\r\n\t}\r\n\r\n\t// **更新遮罩层和弹出框的位置**\r\n\tconst updatePopupPosition = () => {\r\n\t\tif (showPopup.value[props.divId] && divRef.value) {\r\n\t\t\tconst popup = divRef.value.querySelector(\".text-popup\");\r\n\t\t\tconst overlay = divRef.value.querySelector(\".overlay\");\r\n\t\t\tif (popup && overlay) {\r\n\t\t\t\tconst rect = divRef.value.getBoundingClientRect();\r\n\t\t\t\tconst scrollTop = divRef.value.scrollTop;\r\n\t\t\t\tconst scrollLeft = divRef.value.scrollLeft;\r\n\r\n\t\t\t\t// 动态调整遮罩层和弹出框的位置\r\n\t\t\t\toverlay.style.top = `${scrollTop}px`;\r\n\t\t\t\toverlay.style.left = `${scrollLeft}px`;\r\n\t\t\t\toverlay.style.width = `${divRef.value.clientWidth}px`;\r\n\t\t\t\toverlay.style.height = `${divRef.value.clientHeight}px`;\r\n\r\n\t\t\t\tpopup.style.top = `${rect.height / 2 + scrollTop}px`;\r\n\t\t\t\tpopup.style.left = `${rect.width / 2 + scrollLeft}px`;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tfetchWikipediaContent(props.pageTitle)\r\n\t\t\t.then(html => {\r\n\t\t\t\tpageHtml.value = html;\r\n\t\t\t\tinjectWikipediaStyles();\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\terror.value = err.message;\r\n\t\t\t})\r\n\t\t\t.finally(() => {\r\n\t\t\t\tloading.value = false;\r\n\t\t\t});\r\n\r\n\t\tif (divRef.value) {\r\n\t\t\tdivRef.value.addEventListener(\"mouseup\", handleSelection);\r\n\t\t}\r\n\t\t// 监听父容器滚动事件\r\n\t\tif (divRef.value) {\r\n\t\t\tdivRef.value.addEventListener(\"scroll\", updatePopupPosition);\r\n\t\t}\r\n\t});\r\n\r\n\tonUnmounted(() => {\r\n\t\tif (divRef.value) {\r\n\t\t\tdivRef.value.removeEventListener(\"mouseup\", handleSelection);\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.div0 {\r\n\t\tposition: relative;\r\n\t\twidth: 55%;\r\n\t\tmax-width: 100%;\r\n\t\tmax-height: 100%;\r\n\t\toverflow: auto;\r\n\t\tpadding: 20px;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-radius: 12px;\r\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n\t}\r\n\r\n\th1 {\r\n\t\ttext-align: center;\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}