{"ast":null,"code":"import { ref, toRaw, onMounted } from \"vue\";\nimport * as d3 from \"d3\";\nimport Div1 from \"./Div1.vue\";\nimport Div2 from \"./Div2.vue\";\nimport Div3 from \"./Div3.vue\";\nimport { renderLineChart, renderBarChart, renderPieChart } from \"@/js/chartUtils\";\nexport default {\n  __name: 'general',\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const text = ref(\"\"); // 用户输入的文章内容\n    const jsonData = ref(null);\n    async function processText() {\n      try {\n        const response = await fetch(\"http://localhost:8888/process_text\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            text: text.value\n          })\n        });\n        const result = await response.json();\n        if (result.error) {\n          alert(`处理文章内容时出错: ${result.message}`);\n          return;\n        }\n        jsonData.value = result.json_data;\n        renderChart();\n      } catch (error) {\n        alert(\"处理文章内容时出错，请稍后重试\");\n      }\n    }\n    function renderChart() {\n      const rawJsonData = toRaw(jsonData.value);\n      if (!rawJsonData || typeof rawJsonData !== \"object\" || !rawJsonData.data) return;\n      d3.select(chart.value).html(\"\");\n      const chartType = rawJsonData.type;\n      const data = rawJsonData.data;\n      const options = rawJsonData.options || {};\n      if (chartType === \"line\") {\n        renderLineChart(chart.value, data, options);\n      } else if (chartType === \"bar\") {\n        renderBarChart(chart.value, data, options);\n      } else if (chartType === \"pie\") {\n        renderPieChart(chart.value, data, options);\n      }\n    }\n    const __returned__ = {\n      text,\n      jsonData,\n      processText,\n      renderChart,\n      ref,\n      toRaw,\n      onMounted,\n      get d3() {\n        return d3;\n      },\n      Div1,\n      Div2,\n      Div3,\n      get renderLineChart() {\n        return renderLineChart;\n      },\n      get renderBarChart() {\n        return renderBarChart;\n      },\n      get renderPieChart() {\n        return renderPieChart;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","toRaw","onMounted","d3","Div1","Div2","Div3","renderLineChart","renderBarChart","renderPieChart","text","jsonData","processText","response","fetch","method","headers","body","JSON","stringify","value","result","json","error","alert","message","json_data","renderChart","rawJsonData","data","select","chart","html","chartType","type","options"],"sources":["D:/vue_frame/vue_frame/wikitable-vue/client/src/components/general.vue"],"sourcesContent":["<template>\r\n\t<div id=\"root\">\r\n\t\t<Div1 class=\"div\" />\r\n\t\t<div class=\"middle-section\">\r\n\t\t\t<Div2 class=\"div\" />\r\n\t\t\t<div class=\"visualization-container\">\r\n\t\t\t\t<h2>文章可视化</h2>\r\n\t\t\t\t<textarea v-model=\"text\" placeholder=\"请输入文章内容\"></textarea>\r\n\t\t\t\t<button @click=\"processText\">提交并可视化</button>\r\n\t\t\t\t<div ref=\"chart\" class=\"chart-container\"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<Div3 class=\"div\" />\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, toRaw, onMounted } from \"vue\";\r\n\timport * as d3 from \"d3\";\r\n\timport Div1 from \"./Div1.vue\";\r\n\timport Div2 from \"./Div2.vue\";\r\n\timport Div3 from \"./Div3.vue\";\r\n\timport {\r\n\t\trenderLineChart,\r\n\t\trenderBarChart,\r\n\t\trenderPieChart\r\n\t} from \"@/js/chartUtils\";\r\n\r\n\tconst text = ref(\"\"); // 用户输入的文章内容\r\n\tconst jsonData = ref(null);\r\n\r\n\tasync function processText() {\r\n\t\ttry {\r\n\t\t\tconst response = await fetch(\"http://localhost:8888/process_text\", {\r\n\t\t\t\tmethod: \"POST\",\r\n\t\t\t\theaders: { \"Content-Type\": \"application/json\" },\r\n\t\t\t\tbody: JSON.stringify({ text: text.value })\r\n\t\t\t});\r\n\t\t\tconst result = await response.json();\r\n\t\t\tif (result.error) {\r\n\t\t\t\talert(`处理文章内容时出错: ${result.message}`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tjsonData.value = result.json_data;\r\n\t\t\trenderChart();\r\n\t\t} catch (error) {\r\n\t\t\talert(\"处理文章内容时出错，请稍后重试\");\r\n\t\t}\r\n\t}\r\n\r\n\tfunction renderChart() {\r\n\t\tconst rawJsonData = toRaw(jsonData.value);\r\n\t\tif (!rawJsonData || typeof rawJsonData !== \"object\" || !rawJsonData.data)\r\n\t\t\treturn;\r\n\t\td3.select(chart.value).html(\"\");\r\n\r\n\t\tconst chartType = rawJsonData.type;\r\n\t\tconst data = rawJsonData.data;\r\n\t\tconst options = rawJsonData.options || {};\r\n\r\n\t\tif (chartType === \"line\") {\r\n\t\t\trenderLineChart(chart.value, data, options);\r\n\t\t} else if (chartType === \"bar\") {\r\n\t\t\trenderBarChart(chart.value, data, options);\r\n\t\t} else if (chartType === \"pie\") {\r\n\t\t\trenderPieChart(chart.value, data, options);\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t#root {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: flex-start;\r\n\t\theight: 100vh;\r\n\t\twidth: 100%;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.div {\r\n\t\tborder: 1px solid red;\r\n\t}\r\n\r\n\t.middle-section {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\twidth: 30%;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.visualization-container {\r\n\t\twidth: 100%;\r\n\t\tpadding: 10px;\r\n\t\tbackground-color: #f9f9f9;\r\n\t\tborder-radius: 8px;\r\n\t\tbox-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n\t}\r\n\r\n\ttextarea {\r\n\t\twidth: 90%;\r\n\t\theight: 100px;\r\n\t\tmargin-bottom: 10px;\r\n\t\tpadding: 8px;\r\n\t\tfont-size: 14px;\r\n\t\tborder: 1px solid #ccc;\r\n\t\tborder-radius: 4px;\r\n\t}\r\n\r\n\tbutton {\r\n\t\twidth: 100%;\r\n\t\tpadding: 10px;\r\n\t\tbackground-color: #4caf50;\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tborder-radius: 4px;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\tbutton:hover {\r\n\t\tbackground-color: #45a049;\r\n\t}\r\n\r\n\t.chart-container {\r\n\t\twidth: 100%;\r\n\t\theight: 300px;\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 8px;\r\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n\t}\r\n</style>\r\n"],"mappings":"AAiBC,SAASA,GAAG,EAAEC,KAAK,EAAEC,SAAS,QAAQ,KAAK;AAC3C,OAAO,KAAKC,EAAE,MAAM,IAAI;AACxB,OAAOC,IAAI,MAAM,YAAY;AAC7B,OAAOC,IAAI,MAAM,YAAY;AAC7B,OAAOC,IAAI,MAAM,YAAY;AAC7B,SACCC,eAAe,EACfC,cAAc,EACdC,cAAc,QACR,iBAAiB;;;;;;;;IAExB,MAAMC,IAAI,GAAGV,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IACtB,MAAMW,QAAQ,GAAGX,GAAG,CAAC,IAAI,CAAC;IAE1B,eAAeY,WAAWA,CAAA,EAAG;MAC5B,IAAI;QACH,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,oCAAoC,EAAE;UAClEC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YAAE,cAAc,EAAE;UAAmB,CAAC;UAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YAAET,IAAI,EAAEA,IAAI,CAACU;UAAM,CAAC;QAC1C,CAAC,CAAC;QACF,MAAMC,MAAM,GAAG,MAAMR,QAAQ,CAACS,IAAI,CAAC,CAAC;QACpC,IAAID,MAAM,CAACE,KAAK,EAAE;UACjBC,KAAK,CAAC,cAAcH,MAAM,CAACI,OAAO,EAAE,CAAC;UACrC;QACD;QACAd,QAAQ,CAACS,KAAK,GAAGC,MAAM,CAACK,SAAS;QACjCC,WAAW,CAAC,CAAC;MACd,CAAC,CAAC,OAAOJ,KAAK,EAAE;QACfC,KAAK,CAAC,iBAAiB,CAAC;MACzB;IACD;IAEA,SAASG,WAAWA,CAAA,EAAG;MACtB,MAAMC,WAAW,GAAG3B,KAAK,CAACU,QAAQ,CAACS,KAAK,CAAC;MACzC,IAAI,CAACQ,WAAW,IAAI,OAAOA,WAAW,KAAK,QAAQ,IAAI,CAACA,WAAW,CAACC,IAAI,EACvE;MACD1B,EAAE,CAAC2B,MAAM,CAACC,KAAK,CAACX,KAAK,CAAC,CAACY,IAAI,CAAC,EAAE,CAAC;MAE/B,MAAMC,SAAS,GAAGL,WAAW,CAACM,IAAI;MAClC,MAAML,IAAI,GAAGD,WAAW,CAACC,IAAI;MAC7B,MAAMM,OAAO,GAAGP,WAAW,CAACO,OAAO,IAAI,CAAC,CAAC;MAEzC,IAAIF,SAAS,KAAK,MAAM,EAAE;QACzB1B,eAAe,CAACwB,KAAK,CAACX,KAAK,EAAES,IAAI,EAAEM,OAAO,CAAC;MAC5C,CAAC,MAAM,IAAIF,SAAS,KAAK,KAAK,EAAE;QAC/BzB,cAAc,CAACuB,KAAK,CAACX,KAAK,EAAES,IAAI,EAAEM,OAAO,CAAC;MAC3C,CAAC,MAAM,IAAIF,SAAS,KAAK,KAAK,EAAE;QAC/BxB,cAAc,CAACsB,KAAK,CAACX,KAAK,EAAES,IAAI,EAAEM,OAAO,CAAC;MAC3C;IACD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}