{"ast":null,"code":"import { toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-ea6f3360\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"comparison-table\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"table-title\"\n};\nconst _hoisted_3 = {\n  class: \"table-grid\"\n};\nconst _hoisted_4 = {\n  class: \"header left-column\"\n};\nconst _hoisted_5 = {\n  class: \"header middle-column\"\n};\nconst _hoisted_6 = {\n  class: \"header right-column\"\n};\nconst _hoisted_7 = {\n  class: \"cell left-column\"\n};\nconst _hoisted_8 = [\"data-attr\"];\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  class: \"cell right-column\"\n};\nconst _hoisted_11 = [\"data-attr\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [$props.title ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString($props.title), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_3, [_createCommentVNode(\" 表头 \"), _createElementVNode(\"div\", _hoisted_4, _toDisplayString($props.leftHeader), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_5, _toDisplayString($props.middleHeader), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, _toDisplayString($props.rightHeader), 1 /* TEXT */), _createCommentVNode(\" 数据行 \"), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.commonAttributes, (attr, index) => {\n    return _openBlock(), _createElementBlock(_Fragment, {\n      key: attr\n    }, [_createCommentVNode(\" 左侧图表 \"), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", {\n      class: \"chart-container\",\n      ref_for: true,\n      ref: \"leftCharts\",\n      \"data-attr\": attr\n    }, null, 8 /* PROPS */, _hoisted_8)]), _createCommentVNode(\" 属性名称 \"), _createElementVNode(\"div\", {\n      class: \"cell middle-column\",\n      onClick: $event => $setup.selectRow(index)\n    }, _toDisplayString(attr), 9 /* TEXT, PROPS */, _hoisted_9), _createCommentVNode(\" 右侧图表 \"), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", {\n      class: \"chart-container\",\n      ref_for: true,\n      ref: \"rightCharts\",\n      \"data-attr\": attr\n    }, null, 8 /* PROPS */, _hoisted_11)])], 64 /* STABLE_FRAGMENT */);\n  }), 128 /* KEYED_FRAGMENT */))])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","$props","title","_hoisted_2","_toDisplayString","_createCommentVNode","_createElementVNode","_hoisted_3","_hoisted_4","leftHeader","_hoisted_5","middleHeader","_hoisted_6","rightHeader","_Fragment","_renderList","$setup","commonAttributes","attr","index","_hoisted_7","ref_for","ref","_hoisted_8","onClick","$event","selectRow","_hoisted_9","_hoisted_10","_hoisted_11"],"sources":["D:\\vue_frame\\vue_frame\\wikitable-vue\\client\\src\\components\\compoents_base\\CompareTable.vue"],"sourcesContent":["<template>\r\n\t<div class=\"comparison-table\">\r\n\t\t<div class=\"table-title\" v-if=\"title\">{{ title }}</div>\r\n\r\n\t\t<div class=\"table-grid\">\r\n\t\t\t<!-- 表头 -->\r\n\t\t\t<div class=\"header left-column\">{{ leftHeader }}</div>\r\n\t\t\t<div class=\"header middle-column\">{{ middleHeader }}</div>\r\n\t\t\t<div class=\"header right-column\">{{ rightHeader }}</div>\r\n\r\n\t\t\t<!-- 数据行 -->\r\n\t\t\t<template v-for=\"(attr, index) in commonAttributes\" :key=\"attr\">\r\n\t\t\t\t<!-- 左侧图表 -->\r\n\t\t\t\t<div class=\"cell left-column\">\r\n\t\t\t\t\t<div class=\"chart-container\" ref=\"leftCharts\" :data-attr=\"attr\"></div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<!-- 属性名称 -->\r\n\t\t\t\t<div class=\"cell middle-column\" @click=\"selectRow(index)\">\r\n\t\t\t\t\t{{ attr }}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<!-- 右侧图表 -->\r\n\t\t\t\t<div class=\"cell right-column\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"chart-container\"\r\n\t\t\t\t\t\tref=\"rightCharts\"\r\n\t\t\t\t\t\t:data-attr=\"attr\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport { ref, watch, nextTick, onMounted } from \"vue\";\r\n\timport * as d3 from \"d3\";\r\n\timport {\r\n\t\trenderLineChart,\r\n\t\trenderBarChart,\r\n\t\trenderPieChart\r\n\t} from \"@/js/chartUtils\";\r\n\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\ttitle: String,\r\n\t\t\tleftHeader: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"表格1\"\r\n\t\t\t},\r\n\t\t\tmiddleHeader: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"公共属性\"\r\n\t\t\t},\r\n\t\t\trightHeader: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"表格2\"\r\n\t\t\t},\r\n\t\t\ttableData1: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: () => ({})\r\n\t\t\t},\r\n\t\t\ttableData2: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: () => ({})\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\temits: [\"row-selected\"],\r\n\r\n\t\tsetup(props, { emit }) {\r\n\t\t\tconst commonAttributes = ref([]);\r\n\t\t\tconst leftCharts = ref([]);\r\n\t\t\tconst rightCharts = ref([]);\r\n\t\t\tconst selectedRow = ref(-1);\r\n\r\n\t\t\t// 提取公共属性\r\n\t\t\tconst getCommonAttributes = () => {\r\n\t\t\t\tif (!props.tableData1 || !props.tableData2) return [];\r\n\r\n\t\t\t\tconst attrs1 = Object.keys(props.tableData1);\r\n\t\t\t\tconst attrs2 = Object.keys(props.tableData2);\r\n\r\n\t\t\t\treturn attrs1.filter(\r\n\t\t\t\t\tattr =>\r\n\t\t\t\t\t\tattrs2.includes(attr) &&\r\n\t\t\t\t\t\tprops.tableData1[attr] &&\r\n\t\t\t\t\t\tprops.tableData2[attr]\r\n\t\t\t\t);\r\n\t\t\t};\r\n\r\n\t\t\t// 渲染图表\r\n\t\t\tconst renderCharts = () => {\r\n\t\t\t\tnextTick(() => {\r\n\t\t\t\t\tcommonAttributes.value.forEach((attr, index) => {\r\n\t\t\t\t\t\t// 渲染左侧图表 (tableData1)\r\n\t\t\t\t\t\tif (leftCharts.value[index]) {\r\n\t\t\t\t\t\t\trenderChart(\r\n\t\t\t\t\t\t\t\tleftCharts.value[index],\r\n\t\t\t\t\t\t\t\tprops.tableData1[attr],\r\n\t\t\t\t\t\t\t\t`${attr} (${props.leftHeader})`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 渲染右侧图表 (tableData2)\r\n\t\t\t\t\t\tif (rightCharts.value[index]) {\r\n\t\t\t\t\t\t\trenderChart(\r\n\t\t\t\t\t\t\t\trightCharts.value[index],\r\n\t\t\t\t\t\t\t\tprops.tableData2[attr],\r\n\t\t\t\t\t\t\t\t`${attr} (${props.rightHeader})`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 图表渲染方法\r\n\t\t\tconst renderChart = (container, data, title) => {\r\n\t\t\t\t// 清空容器\r\n\t\t\t\tcontainer.innerHTML = \"\";\r\n\r\n\t\t\t\t// 根据数据类型选择图表类型\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\t// 如果是数组数据，使用柱状图\r\n\t\t\t\t\trenderBarChart(container, {\r\n\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\tdata: data.map((item, i) => ({\r\n\t\t\t\t\t\t\tname: item.name || `项目${i + 1}`,\r\n\t\t\t\t\t\t\tvalue: item.value || item\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (typeof data === \"object\") {\r\n\t\t\t\t\t// 如果是对象，使用饼图\r\n\t\t\t\t\trenderPieChart(container, {\r\n\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\tdata: Object.entries(data).map(([name, value]) => ({ name, value }))\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 其他类型使用简单文本显示\r\n\t\t\t\t\tconst div = document.createElement(\"div\");\r\n\t\t\t\t\tdiv.className = \"simple-value\";\r\n\t\t\t\t\tdiv.textContent = data;\r\n\t\t\t\t\tcontainer.appendChild(div);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 行选择\r\n\t\t\tconst selectRow = index => {\r\n\t\t\t\tselectedRow.value = index;\r\n\t\t\t\temit(\"row-selected\", {\r\n\t\t\t\t\tindex,\r\n\t\t\t\t\tattribute: commonAttributes.value[index]\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 监听数据变化\r\n\t\t\twatch(\r\n\t\t\t\t() => [props.tableData1, props.tableData2],\r\n\t\t\t\t() => {\r\n\t\t\t\t\tcommonAttributes.value = getCommonAttributes();\r\n\t\t\t\t\trenderCharts();\r\n\t\t\t\t},\r\n\t\t\t\t{ immediate: true, deep: true }\r\n\t\t\t);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tcommonAttributes,\r\n\t\t\t\tleftCharts,\r\n\t\t\t\trightCharts,\r\n\t\t\t\tselectedRow,\r\n\t\t\t\tselectRow\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.comparison-table {\r\n\t\twidth: 100%;\r\n\t\tbackground: white;\r\n\t\tborder-radius: 8px;\r\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.table-title {\r\n\t\tpadding: 16px;\r\n\t\tfont-size: 18px;\r\n\t\tfont-weight: 600;\r\n\t\tbackground: #f5f5f5;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t}\r\n\r\n\t.table-grid {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: 1fr 1fr 1fr;\r\n\t\tgrid-auto-rows: minmax(100px, auto);\r\n\t\tgap: 1px;\r\n\t\tbackground: #eee;\r\n\t}\r\n\r\n\t.header {\r\n\t\tpadding: 12px;\r\n\t\tbackground: #f9f9f9;\r\n\t\tfont-weight: 500;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.cell {\r\n\t\tpadding: 12px;\r\n\t\tbackground: white;\r\n\t\tmin-height: 120px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.left-column {\r\n\t\tborder-right: 1px solid #eee;\r\n\t}\r\n\r\n\t.right-column {\r\n\t\tborder-left: 1px solid #eee;\r\n\t}\r\n\r\n\t.middle-column {\r\n\t\tcursor: pointer;\r\n\t\ttransition: background 0.2s;\r\n\t}\r\n\r\n\t.middle-column:hover {\r\n\t\tbackground: #f0f7ff;\r\n\t}\r\n\r\n\t.chart-container {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tmin-height: 100px;\r\n\t}\r\n\r\n\t.simple-value {\r\n\t\tpadding: 8px;\r\n\t\tbackground: #f5f5f5;\r\n\t\tborder-radius: 4px;\r\n\t}\r\n</style>\r\n"],"mappings":";;;EACMA,KAAK,EAAC;AAAkB;;EAD9BC,GAAA;EAEOD,KAAK,EAAC;;;EAENA,KAAK,EAAC;AAAY;;EAEjBA,KAAK,EAAC;AAAoB;;EAC1BA,KAAK,EAAC;AAAsB;;EAC5BA,KAAK,EAAC;AAAqB;;EAK1BA,KAAK,EAAC;AAAkB;mBAbjC;mBAAA;;EAuBSA,KAAK,EAAC;AAAmB;oBAvBlC;;uBACCE,mBAAA,CA8BM,OA9BNC,UA8BM,GA7B0BC,MAAA,CAAAC,KAAK,I,cAApCH,mBAAA,CAAuD,OAAvDI,UAAuD,EAAAC,gBAAA,CAAdH,MAAA,CAAAC,KAAK,oBAFhDG,mBAAA,gBAIEC,mBAAA,CA0BM,OA1BNC,UA0BM,GAzBLF,mBAAA,QAAW,EACXC,mBAAA,CAAsD,OAAtDE,UAAsD,EAAAJ,gBAAA,CAAnBH,MAAA,CAAAQ,UAAU,kBAC7CH,mBAAA,CAA0D,OAA1DI,UAA0D,EAAAN,gBAAA,CAArBH,MAAA,CAAAU,YAAY,kBACjDL,mBAAA,CAAwD,OAAxDM,UAAwD,EAAAR,gBAAA,CAApBH,MAAA,CAAAY,WAAW,kBAE/CR,mBAAA,SAAY,G,kBACZN,mBAAA,CAkBWe,SAAA,QA7BdC,WAAA,CAWqCC,MAAA,CAAAC,gBAAgB,EAXrD,CAWqBC,IAAI,EAAEC,KAAK;yBAXhCpB,mBAAA,CAAAe,SAAA;MAAAhB,GAAA,EAW6DoB;IAAI,IAC7Db,mBAAA,UAAa,EACbC,mBAAA,CAEM,OAFNc,UAEM,GADLd,mBAAA,CAAsE;MAAjET,KAAK,EAAC,iBAAiB;MAdjCwB,OAAA;MAckCC,GAAG,EAAC,YAAY;MAAE,WAAS,EAAEJ;4BAd/DK,UAAA,E,GAiBIlB,mBAAA,UAAa,EACbC,mBAAA,CAEM;MAFDT,KAAK,EAAC,oBAAoB;MAAE2B,OAAK,EAAAC,MAAA,IAAET,MAAA,CAAAU,SAAS,CAACP,KAAK;wBACnDD,IAAI,wBAnBZS,UAAA,GAsBItB,mBAAA,UAAa,EACbC,mBAAA,CAKM,OALNsB,WAKM,GAJLtB,mBAAA,CAGyB;MAFxBT,KAAK,EAAC,iBAAiB;MAzB7BwB,OAAA;MA0BMC,GAAG,EAAC,aAAa;MAChB,WAAS,EAAEJ;4BA3BlBW,WAAA,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}